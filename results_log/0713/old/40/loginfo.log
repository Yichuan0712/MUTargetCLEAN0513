use k-fold index: 4

Done Loading data

number of steps for training data: 221

number of steps for valid data: 66

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39960718 || all params: 652959779 || trainable%: 6.119935604793201

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 4 Epoch 1 train...
-------------------------------

0 loss: 0.209975  [   16/ 3548]

0 class loss: 0.039772 position_loss:0.040404

30 loss: 0.562911  [  496/ 3548]

30 class loss: 0.111744 position_loss:0.108113

60 loss: 0.354906  [  976/ 3548]

60 class loss: 0.066147 position_loss:0.068335

90 loss: 0.258690  [ 1456/ 3548]

90 class loss: 0.046839 position_loss:0.049864

120 loss: 0.519624  [ 1936/ 3548]

120 class loss: 0.096655 position_loss:0.100059

150 loss: 0.829165  [ 2416/ 3548]

150 class loss: 0.153910 position_loss:0.159677

180 loss: 0.445070  [ 2896/ 3548]

180 class loss: 0.073212 position_loss:0.086086

210 loss: 0.595025  [ 3376/ 3548]

210 class loss: 0.112065 position_loss:0.114522

Epoch 1: train loss: 0.473790

Fold 4 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 1: valid loss:0.251237

Epoch 1: valid_class_loss:0.046463	valid_position_loss:0.048389

Epoch 1: valid loss 0.251236656748104 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.04838882843924116 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 2 train...
-------------------------------

221 loss: 0.270790  [   16/ 3548]

221 class loss: 0.050259 position_loss:0.052148

251 loss: 0.624956  [  496/ 3548]

251 class loss: 0.111729 position_loss:0.120522

281 loss: 0.483484  [  976/ 3548]

281 class loss: 0.097236 position_loss:0.092807

311 loss: 0.664994  [ 1456/ 3548]

311 class loss: 0.133250 position_loss:0.127669

341 loss: 0.386142  [ 1936/ 3548]

341 class loss: 0.079069 position_loss:0.074066

371 loss: 0.131299  [ 2416/ 3548]

371 class loss: 0.030067 position_loss:0.025057

401 loss: 0.462767  [ 2896/ 3548]

401 class loss: 0.093514 position_loss:0.088813

431 loss: 0.231862  [ 3376/ 3548]

431 class loss: 0.052686 position_loss:0.044265

Epoch 2: train loss: 0.413126

Fold 4 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 2: valid loss:0.193667

Epoch 2: valid_class_loss:0.043062	valid_position_loss:0.037011

Epoch 2: valid loss 0.19366734241759398 smaller than best loss 0.251236656748104
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.037010984154488655 smaller than best position loss 0.04838882843924116
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 3 train...
-------------------------------

442 loss: 0.116126  [   16/ 3548]

442 class loss: 0.026825 position_loss:0.022152

472 loss: 0.192631  [  496/ 3548]

472 class loss: 0.055055 position_loss:0.036324

502 loss: 0.211097  [  976/ 3548]

502 class loss: 0.053635 position_loss:0.040074

532 loss: 0.268655  [ 1456/ 3548]

532 class loss: 0.071509 position_loss:0.050871

562 loss: 0.424835  [ 1936/ 3548]

562 class loss: 0.125494 position_loss:0.079947

592 loss: 0.132032  [ 2416/ 3548]

592 class loss: 0.041850 position_loss:0.024732

622 loss: 0.131999  [ 2896/ 3548]

622 class loss: 0.042319 position_loss:0.024707

652 loss: 0.140728  [ 3376/ 3548]

652 class loss: 0.055063 position_loss:0.025943

Epoch 3: train loss: 0.257251

Fold 4 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 3: valid loss:0.096245

Epoch 3: valid_class_loss:0.036356	valid_position_loss:0.017795

Epoch 3: valid loss 0.09624525495379274 smaller than best loss 0.19366734241759398
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.017794801245595505 smaller than best position loss 0.037010984154488655
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 4 train...
-------------------------------

663 loss: 0.220848  [   16/ 3548]

663 class loss: 0.085610 position_loss:0.040745

693 loss: 0.194841  [  496/ 3548]

693 class loss: 0.078005 position_loss:0.035848

723 loss: 0.198707  [  976/ 3548]

723 class loss: 0.069027 position_loss:0.036980

753 loss: 0.193636  [ 1456/ 3548]

753 class loss: 0.114259 position_loss:0.034157

783 loss: 0.114488  [ 1936/ 3548]

783 class loss: 0.069253 position_loss:0.020127

813 loss: 0.114407  [ 2416/ 3548]

813 class loss: 0.067590 position_loss:0.020178

843 loss: 0.125157  [ 2896/ 3548]

843 class loss: 0.079072 position_loss:0.021868

873 loss: 0.056634  [ 3376/ 3548]

873 class loss: 0.037739 position_loss:0.009817

Epoch 4: train loss: 0.128049

Fold 4 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 4: valid loss:0.063208

Epoch 4: valid_class_loss:0.032149	valid_position_loss:0.011356

Epoch 4: valid loss 0.06320838516004872 smaller than best loss 0.09624525495379274
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.011355697857428265 smaller than best position loss 0.017794801245595505
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 5 train...
-------------------------------

884 loss: 0.070554  [   16/ 3548]

884 class loss: 0.042367 position_loss:0.012416

914 loss: 0.027295  [  496/ 3548]

914 class loss: 0.019372 position_loss:0.004684

944 loss: 0.068915  [  976/ 3548]

944 class loss: 0.040104 position_loss:0.012179

974 loss: 0.145038  [ 1456/ 3548]

974 class loss: 0.093792 position_loss:0.025256

1004 loss: 0.149072  [ 1936/ 3548]

1004 class loss: 0.075534 position_loss:0.026793

1034 loss: 0.111146  [ 2416/ 3548]

1034 class loss: 0.083698 position_loss:0.018881

1064 loss: 0.087321  [ 2896/ 3548]

1064 class loss: 0.053833 position_loss:0.015311

1094 loss: 0.081074  [ 3376/ 3548]

1094 class loss: 0.074565 position_loss:0.013232

Epoch 5: train loss: 0.088064

Fold 4 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 5: valid loss:0.051298

Epoch 5: valid_class_loss:0.030093	valid_position_loss:0.009056

Epoch 5: valid loss 0.051297733790940186 smaller than best loss 0.06320838516004872
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.009055807091875244 smaller than best position loss 0.011355697857428265
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 6 train...
-------------------------------

1105 loss: 0.066842  [   16/ 3548]

1105 class loss: 0.039009 position_loss:0.011808

1135 loss: 0.030581  [  496/ 3548]

1135 class loss: 0.014930 position_loss:0.005519

1165 loss: 0.104300  [  976/ 3548]

1165 class loss: 0.070186 position_loss:0.018053

1195 loss: 0.044736  [ 1456/ 3548]

1195 class loss: 0.024375 position_loss:0.007972

1225 loss: 0.038240  [ 1936/ 3548]

1225 class loss: 0.033677 position_loss:0.006301

1255 loss: 0.054196  [ 2416/ 3548]

1255 class loss: 0.045572 position_loss:0.009016

1285 loss: 0.015398  [ 2896/ 3548]

1285 class loss: 0.016933 position_loss:0.002402

1315 loss: 0.064993  [ 3376/ 3548]

1315 class loss: 0.062828 position_loss:0.010486

Epoch 6: train loss: 0.073654

Fold 4 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 6: valid loss:0.041315

Epoch 6: valid_class_loss:0.029248	valid_position_loss:0.007093

Epoch 6: valid loss 0.04131516857752756 smaller than best loss 0.051297733790940186
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.007093112422032164 smaller than best position loss 0.009055807091875244
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 7 train...
-------------------------------

1326 loss: 0.064650  [   16/ 3548]

1326 class loss: 0.039430 position_loss:0.011353

1356 loss: 0.040450  [  496/ 3548]

1356 class loss: 0.036258 position_loss:0.006640

1386 loss: 0.016198  [  976/ 3548]

1386 class loss: 0.014484 position_loss:0.002660

1416 loss: 0.053302  [ 1456/ 3548]

1416 class loss: 0.045899 position_loss:0.008824

1446 loss: 0.029518  [ 1936/ 3548]

1446 class loss: 0.032886 position_loss:0.004588

1476 loss: 0.029885  [ 2416/ 3548]

1476 class loss: 0.030513 position_loss:0.004756

1506 loss: 0.063211  [ 2896/ 3548]

1506 class loss: 0.057789 position_loss:0.010331

1536 loss: 0.119336  [ 3376/ 3548]

1536 class loss: 0.080862 position_loss:0.020633

Epoch 7: train loss: 0.059400

Fold 4 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 7: valid loss:0.036670

Epoch 7: valid_class_loss:0.028984	valid_position_loss:0.006175

Epoch 7: valid loss 0.03666959524904515 smaller than best loss 0.04131516857752756
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.006174562543955948 smaller than best position loss 0.007093112422032164
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 8 train...
-------------------------------

1547 loss: 0.054317  [   16/ 3548]

1547 class loss: 0.027468 position_loss:0.009765

1577 loss: 0.064071  [  496/ 3548]

1577 class loss: 0.075766 position_loss:0.009783

1607 loss: 0.062500  [  976/ 3548]

1607 class loss: 0.047255 position_loss:0.010610

1637 loss: 0.066451  [ 1456/ 3548]

1637 class loss: 0.082649 position_loss:0.009984

1667 loss: 0.035371  [ 1936/ 3548]

1667 class loss: 0.044924 position_loss:0.005277

1697 loss: 0.046641  [ 2416/ 3548]

1697 class loss: 0.056184 position_loss:0.007081

1727 loss: 0.050918  [ 2896/ 3548]

1727 class loss: 0.056531 position_loss:0.007922

1757 loss: 0.054029  [ 3376/ 3548]

1757 class loss: 0.094716 position_loss:0.007017

Epoch 8: train loss: 0.046883

Fold 4 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 8: valid loss:0.035027

Epoch 8: valid_class_loss:0.028568	valid_position_loss:0.005863

Epoch 8: valid loss 0.035027428898444755 smaller than best loss 0.03666959524904515
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.0058627667787076 smaller than best position loss 0.006174562543955948
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 9 train...
-------------------------------

1768 loss: 0.037362  [   16/ 3548]

1768 class loss: 0.052587 position_loss:0.005369

1798 loss: 0.059698  [  496/ 3548]

1798 class loss: 0.072737 position_loss:0.009030

1828 loss: 0.046757  [  976/ 3548]

1828 class loss: 0.049527 position_loss:0.007370

1858 loss: 0.080703  [ 1456/ 3548]

1858 class loss: 0.098120 position_loss:0.012216

1888 loss: 0.031314  [ 1936/ 3548]

1888 class loss: 0.039214 position_loss:0.004694

1918 loss: 0.070678  [ 2416/ 3548]

1918 class loss: 0.094349 position_loss:0.010362

1948 loss: 0.011326  [ 2896/ 3548]

1948 class loss: 0.019395 position_loss:0.001489

1978 loss: 0.061740  [ 3376/ 3548]

1978 class loss: 0.087679 position_loss:0.008841

Epoch 9: train loss: 0.039765

Fold 4 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 9: valid loss:0.029884

Epoch 9: valid_class_loss:0.028207	valid_position_loss:0.004849

Epoch 9: valid loss 0.029883855622380343 smaller than best loss 0.035027428898444755
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004848510558130211 smaller than best position loss 0.0058627667787076
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 10 train...
-------------------------------

1989 loss: 0.037492  [   16/ 3548]

1989 class loss: 0.056069 position_loss:0.005256

2019 loss: 0.035437  [  496/ 3548]

2019 class loss: 0.051819 position_loss:0.005015

2049 loss: 0.011794  [  976/ 3548]

2049 class loss: 0.021988 position_loss:0.001479

2079 loss: 0.017848  [ 1456/ 3548]

2079 class loss: 0.028067 position_loss:0.002447

2109 loss: 0.038834  [ 1936/ 3548]

2109 class loss: 0.067899 position_loss:0.005051

2139 loss: 0.060539  [ 2416/ 3548]

2139 class loss: 0.072806 position_loss:0.009196

2169 loss: 0.028767  [ 2896/ 3548]

2169 class loss: 0.036965 position_loss:0.004275

2199 loss: 0.040844  [ 3376/ 3548]

2199 class loss: 0.049104 position_loss:0.006205

Epoch 10: train loss: 0.034752

Fold 4 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 10: valid loss:0.026984

Epoch 10: valid_class_loss:0.028026	valid_position_loss:0.004276

Epoch 10: valid loss 0.026984351686773694 smaller than best loss 0.029883855622380343
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004275847068198811 smaller than best position loss 0.004848510558130211
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 11 train...
-------------------------------

2210 loss: 0.040281  [   16/ 3548]

2210 class loss: 0.061810 position_loss:0.005584

2240 loss: 0.038517  [  496/ 3548]

2240 class loss: 0.062994 position_loss:0.005184

2270 loss: 0.007002  [  976/ 3548]

2270 class loss: 0.009243 position_loss:0.001031

2300 loss: 0.031155  [ 1456/ 3548]

2300 class loss: 0.056980 position_loss:0.003952

2330 loss: 0.049960  [ 1936/ 3548]

2330 class loss: 0.054148 position_loss:0.007826

2360 loss: 0.012597  [ 2416/ 3548]

2360 class loss: 0.028778 position_loss:0.001368

2390 loss: 0.042571  [ 2896/ 3548]

2390 class loss: 0.065856 position_loss:0.005880

2420 loss: 0.043169  [ 3376/ 3548]

2420 class loss: 0.042623 position_loss:0.006929

Epoch 11: train loss: 0.031312

Fold 4 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 11: valid loss:0.025730

Epoch 11: valid_class_loss:0.027911	valid_position_loss:0.004030

Epoch 11: valid loss 0.02572992971668081 smaller than best loss 0.026984351686773694
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0040295350832814155 smaller than best position loss 0.004275847068198811
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 12 train...
-------------------------------

2431 loss: 0.015833  [   16/ 3548]

2431 class loss: 0.033231 position_loss:0.001837

2461 loss: 0.014284  [  496/ 3548]

2461 class loss: 0.025608 position_loss:0.001832

2491 loss: 0.029062  [  976/ 3548]

2491 class loss: 0.041780 position_loss:0.004141

2521 loss: 0.030496  [ 1456/ 3548]

2521 class loss: 0.041409 position_loss:0.004443

2551 loss: 0.049410  [ 1936/ 3548]

2551 class loss: 0.079563 position_loss:0.006700

2581 loss: 0.015675  [ 2416/ 3548]

2581 class loss: 0.032650 position_loss:0.001829

2611 loss: 0.019242  [ 2896/ 3548]

2611 class loss: 0.032575 position_loss:0.002545

2641 loss: 0.037779  [ 3376/ 3548]

2641 class loss: 0.041142 position_loss:0.005910

Epoch 12: train loss: 0.028645

Fold 4 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 12: valid loss:0.025249

Epoch 12: valid_class_loss:0.027776	valid_position_loss:0.003939

Epoch 12: valid loss 0.025248863013850726 smaller than best loss 0.02572992971668081
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0039387463035454205 smaller than best position loss 0.0040295350832814155
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 13 train...
-------------------------------

2652 loss: 0.021885  [   16/ 3548]

2652 class loss: 0.048691 position_loss:0.002429

2682 loss: 0.047984  [  496/ 3548]

2682 class loss: 0.107643 position_loss:0.005291

2712 loss: 0.055311  [  976/ 3548]

2712 class loss: 0.080572 position_loss:0.007839

2742 loss: 0.032671  [ 1456/ 3548]

2742 class loss: 0.062962 position_loss:0.004016

2772 loss: 0.046326  [ 1936/ 3548]

2772 class loss: 0.088593 position_loss:0.005721

2802 loss: 0.008161  [ 2416/ 3548]

2802 class loss: 0.014419 position_loss:0.001055

2832 loss: 0.019763  [ 2896/ 3548]

2832 class loss: 0.045437 position_loss:0.002135

2862 loss: 0.017925  [ 3376/ 3548]

2862 class loss: 0.046187 position_loss:0.001737

Epoch 13: train loss: 0.026475

Fold 4 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 13: valid loss:0.025314

Epoch 13: valid_class_loss:0.027622	valid_position_loss:0.003958

Fold 4 Epoch 14 train...
-------------------------------

2873 loss: 0.011575  [   16/ 3548]

2873 class loss: 0.026448 position_loss:0.001257

2903 loss: 0.021276  [  496/ 3548]

2903 class loss: 0.038578 position_loss:0.002712

2933 loss: 0.024779  [  976/ 3548]

2933 class loss: 0.050566 position_loss:0.002933

2963 loss: 0.017948  [ 1456/ 3548]

2963 class loss: 0.045603 position_loss:0.001765

2993 loss: 0.008721  [ 1936/ 3548]

2993 class loss: 0.017889 position_loss:0.001029

3023 loss: 0.015937  [ 2416/ 3548]

3023 class loss: 0.038365 position_loss:0.001653

3053 loss: 0.017292  [ 2896/ 3548]

3053 class loss: 0.034778 position_loss:0.002067

3083 loss: 0.008173  [ 3376/ 3548]

3083 class loss: 0.019402 position_loss:0.000858

Epoch 14: train loss: 0.024865

Fold 4 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 14: valid loss:0.025096

Epoch 14: valid_class_loss:0.027518	valid_position_loss:0.003918

Epoch 14: valid loss 0.025095655528158876 smaller than best loss 0.025248863013850726
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.003918412121134386 smaller than best position loss 0.0039387463035454205
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 15 train...
-------------------------------

3094 loss: 0.013704  [   16/ 3548]

3094 class loss: 0.037267 position_loss:0.001250

3124 loss: 0.028276  [  496/ 3548]

3124 class loss: 0.031783 position_loss:0.004384

3154 loss: 0.024067  [  976/ 3548]

3154 class loss: 0.048832 position_loss:0.002860

3184 loss: 0.035414  [ 1456/ 3548]

3184 class loss: 0.086074 position_loss:0.003640

3214 loss: 0.023351  [ 1936/ 3548]

3214 class loss: 0.067290 position_loss:0.001979

3244 loss: 0.016203  [ 2416/ 3548]

3244 class loss: 0.031231 position_loss:0.001991

3274 loss: 0.033348  [ 2896/ 3548]

3274 class loss: 0.067998 position_loss:0.003950

3304 loss: 0.010956  [ 3376/ 3548]

3304 class loss: 0.028361 position_loss:0.001057

Epoch 15: train loss: 0.022934

Fold 4 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 15: valid loss:0.024075

Epoch 15: valid_class_loss:0.027286	valid_position_loss:0.003724

Epoch 15: valid loss 0.024074762660824603 smaller than best loss 0.025095655528158876
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.003723501771166636 smaller than best position loss 0.003918412121134386
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0713/2024-07-14__10-06-04/checkpoints/best_model.pth

Fold 4 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.2  0.1         0.1            0.1             0.2     0.1   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.1        0.4  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.617451
Nucleus_export  0.462383
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.738179  0.195319  0.261821
Nucleus_export  0.553095  0.219920  0.446905
===========================================

 cs acc: 

                      0
ER             0.896552
Peroxisome     0.583333
Mitochondrion  0.335443
SIGNAL         0.834877
chloroplast    0.273973
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.897083                 0.508648           0.448105   
ER                   0.397862                 0.021616           0.000000   
Peroxisome           0.583333                 0.014817           0.000000   
Mitochondrion        0.425935                 0.121698          -0.078673   
Nucleus_export       0.887107                 0.099040           0.228401   
SIGNAL               0.610345                 0.729653           0.153833   
chloroplast          0.490654                 0.062341           0.000000   
Thylakoid            0.879754                 0.144802           0.047442   

                recall_score  precision_score  f1_score  
Nucleus             0.577236         0.467105  0.516364  
ER                  1.000000         0.027488  0.053506  
Peroxisome          1.000000         0.011374  0.022493  
Mitochondrion       0.075949         0.080537  0.078176  
Nucleus_export      0.600000         0.117188  0.196078  
SIGNAL              0.333333         0.734694  0.458599  
chloroplast         1.000000         0.069194  0.129433  
Thylakoid           0.111111         0.034483  0.052632  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.2  0.1         0.1            0.1             0.2     0.1   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.1        0.4  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.751103
Nucleus_export  0.594465
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.912633  0.225721  0.087367
Nucleus_export  0.818571  0.372202  0.181429
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.230769
Mitochondrion  0.468750
SIGNAL         0.866359
chloroplast    0.355263
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.934209                 0.611582           0.648218   
ER                   0.498028                 0.026883           0.000000   
Peroxisome           0.663168                 0.020363           0.000000   
Mitochondrion        0.499736                 0.146564          -0.052672   
Nucleus_export       0.930656                 0.219052           0.377988   
SIGNAL               0.544843                 0.634458          -0.033719   
chloroplast          0.531031                 0.071385           0.000000   
Thylakoid            0.949667                 0.089795          -0.009515   

                recall_score  precision_score  f1_score  
Nucleus              0.71875         0.666667  0.691729  
ER                   1.00000         0.028275  0.054995  
Peroxisome           1.00000         0.012253  0.024209  
Mitochondrion        0.05000         0.088889  0.064000  
Nucleus_export       0.88000         0.184874  0.305556  
SIGNAL               0.22427         0.584000  0.324084  
chloroplast          1.00000         0.071631  0.133685  
Thylakoid            0.00000         0.000000  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.2  0.1         0.1            0.1             0.2     0.1   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.1        0.4  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.515117
Nucleus_export  0.541803
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.652669  0.197293  0.066081
Nucleus_export  0.763571  0.367821  0.116429
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.230769
Mitochondrion  0.375000
SIGNAL         0.863014
chloroplast    0.355263
Thylakoid           NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.934209                 0.611582           0.648218   
ER                   0.498028                 0.026883           0.000000   
Peroxisome           0.663168                 0.020363           0.000000   
Mitochondrion        0.499736                 0.146564          -0.052672   
Nucleus_export       0.930656                 0.219052           0.377988   
SIGNAL               0.544843                 0.634458          -0.033719   
chloroplast          0.531031                 0.071385           0.000000   
Thylakoid            0.949667                 0.089795          -0.009515   

                recall_score  precision_score  f1_score  
Nucleus              0.71875         0.666667  0.691729  
ER                   1.00000         0.028275  0.054995  
Peroxisome           1.00000         0.012253  0.024209  
Mitochondrion        0.05000         0.088889  0.064000  
Nucleus_export       0.88000         0.184874  0.305556  
SIGNAL               0.22427         0.584000  0.324084  
chloroplast          1.00000         0.071631  0.133685  
Thylakoid            0.00000         0.000000  0.000000  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.2  0.1         0.1            0.1             0.2     0.1   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.1        0.4  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.627644
Nucleus_export  0.562589
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.750000  0.195086  0.250000
Nucleus_export  0.760417  0.359597  0.239583
===========================================

 cs acc: 

                 0
ER             NaN
Peroxisome     NaN
Mitochondrion  0.0
SIGNAL         NaN
chloroplast    NaN
Thylakoid      NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                0.6875                 0.645833           0.377964   
ER                        NaN                -0.000000           0.000000   
Peroxisome                NaN                -0.000000           0.000000   
Mitochondrion          0.0000                 0.125000          -0.292770   
Nucleus_export            NaN                 1.000000           0.000000   
SIGNAL                    NaN                -0.000000           0.000000   
chloroplast               NaN                -0.000000           0.000000   
Thylakoid                 NaN                -0.000000           0.000000   

                recall_score  precision_score  f1_score  
Nucleus                1.000         0.571429  0.727273  
ER                     0.000         0.000000  0.000000  
Peroxisome             0.000         0.000000  0.000000  
Mitochondrion          0.000         0.000000  0.000000  
Nucleus_export         0.875         1.000000  0.933333  
SIGNAL                 0.000         0.000000  0.000000  
chloroplast            0.000         0.000000  0.000000  
Thylakoid              0.000         0.000000  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.2  0.1         0.1            0.1             0.2     0.1   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.1        0.4  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.627644
Nucleus_export  0.503851
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.750000  0.195086  0.250000
Nucleus_export  0.697917  0.351589  0.177083
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                0.6875                 0.645833           0.377964   
ER                        NaN                -0.000000           0.000000   
Peroxisome                NaN                -0.000000           0.000000   
Mitochondrion          0.0000                 0.125000          -0.292770   
Nucleus_export            NaN                 1.000000           0.000000   
SIGNAL                    NaN                -0.000000           0.000000   
chloroplast               NaN                -0.000000           0.000000   
Thylakoid                 NaN                -0.000000           0.000000   

                recall_score  precision_score  f1_score  
Nucleus                1.000         0.571429  0.727273  
ER                     0.000         0.000000  0.000000  
Peroxisome             0.000         0.000000  0.000000  
Mitochondrion          0.000         0.000000  0.000000  
Nucleus_export         0.875         1.000000  0.933333  
SIGNAL                 0.000         0.000000  0.000000  
chloroplast            0.000         0.000000  0.000000  
Thylakoid              0.000         0.000000  0.000000  
