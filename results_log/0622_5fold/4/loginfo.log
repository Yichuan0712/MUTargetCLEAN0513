use k-fold index: 4

Done Loading data

number of steps for training data: 221

number of steps for valid data: 66

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 4 Epoch 1 train...
-------------------------------

0 loss: 0.953049  [   16/ 3548]

0 class loss: 0.196349 position_loss:0.182756

30 loss: 1.021970  [  496/ 3548]

30 class loss: 0.224757 position_loss:0.195404

60 loss: 0.122190  [  976/ 3548]

60 class loss: 0.029029 position_loss:0.023277

90 loss: 0.133910  [ 1456/ 3548]

90 class loss: 0.028791 position_loss:0.025630

120 loss: 0.132918  [ 1936/ 3548]

120 class loss: 0.028527 position_loss:0.025442

150 loss: 0.300928  [ 2416/ 3548]

150 class loss: 0.063615 position_loss:0.057641

180 loss: 0.417933  [ 2896/ 3548]

180 class loss: 0.091747 position_loss:0.079917

210 loss: 0.505760  [ 3376/ 3548]

210 class loss: 0.103443 position_loss:0.097014

Epoch 1: train loss: 0.479809

Fold 4 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 1: valid loss:0.249451

Epoch 1: valid_class_loss:0.054366	valid_position_loss:0.047716

Epoch 1: valid loss 0.2494514038579799 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.04771562327233958 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 2 train...
-------------------------------

221 loss: 0.144525  [   16/ 3548]

221 class loss: 0.029647 position_loss:0.027719

251 loss: 0.118745  [  496/ 3548]

251 class loss: 0.018960 position_loss:0.022991

281 loss: 0.415980  [  976/ 3548]

281 class loss: 0.110603 position_loss:0.078772

311 loss: 0.171270  [ 1456/ 3548]

311 class loss: 0.036474 position_loss:0.032795

341 loss: 0.139095  [ 1936/ 3548]

341 class loss: 0.031735 position_loss:0.026550

371 loss: 0.615705  [ 2416/ 3548]

371 class loss: 0.141330 position_loss:0.117488

401 loss: 0.627760  [ 2896/ 3548]

401 class loss: 0.178860 position_loss:0.118398

431 loss: 0.353296  [ 3376/ 3548]

431 class loss: 0.086198 position_loss:0.067211

Epoch 2: train loss: 0.415569

Fold 4 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 2: valid loss:0.193566

Epoch 2: valid_class_loss:0.045531	valid_position_loss:0.036892

Epoch 2: valid loss 0.1935659215538439 smaller than best loss 0.2494514038579799
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.03689195097552301 smaller than best position loss 0.04771562327233958
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 3 train...
-------------------------------

442 loss: 0.107684  [   16/ 3548]

442 class loss: 0.018801 position_loss:0.020785

472 loss: 0.421639  [  496/ 3548]

472 class loss: 0.106592 position_loss:0.080064

502 loss: 0.135932  [  976/ 3548]

502 class loss: 0.030024 position_loss:0.025985

532 loss: 0.378765  [ 1456/ 3548]

532 class loss: 0.105800 position_loss:0.071521

562 loss: 0.199339  [ 1936/ 3548]

562 class loss: 0.043499 position_loss:0.038128

592 loss: 0.509976  [ 2416/ 3548]

592 class loss: 0.168881 position_loss:0.095240

622 loss: 0.051573  [ 2896/ 3548]

622 class loss: 0.018491 position_loss:0.009575

652 loss: 0.187461  [ 3376/ 3548]

652 class loss: 0.058973 position_loss:0.035133

Epoch 3: train loss: 0.261187

Fold 4 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 3: valid loss:0.095838

Epoch 3: valid_class_loss:0.034242	valid_position_loss:0.017798

Epoch 3: valid loss 0.09583755327621042 smaller than best loss 0.1935659215538439
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.01779784760003982 smaller than best position loss 0.03689195097552301
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 4 train...
-------------------------------

663 loss: 0.064334  [   16/ 3548]

663 class loss: 0.028531 position_loss:0.011726

693 loss: 0.226062  [  496/ 3548]

693 class loss: 0.113063 position_loss:0.040690

723 loss: 0.078339  [  976/ 3548]

723 class loss: 0.034614 position_loss:0.014283

753 loss: 0.137293  [ 1456/ 3548]

753 class loss: 0.074471 position_loss:0.024480

783 loss: 0.308534  [ 1936/ 3548]

783 class loss: 0.202156 position_loss:0.053621

813 loss: 0.041215  [ 2416/ 3548]

813 class loss: 0.022798 position_loss:0.007331

843 loss: 0.054214  [ 2896/ 3548]

843 class loss: 0.018174 position_loss:0.010116

873 loss: 0.147132  [ 3376/ 3548]

873 class loss: 0.070614 position_loss:0.026602

Epoch 4: train loss: 0.130531

Fold 4 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 4: valid loss:0.061898

Epoch 4: valid_class_loss:0.028693	valid_position_loss:0.011232

Epoch 4: valid loss 0.061897950540978394 smaller than best loss 0.09583755327621042
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.011231882152501102 smaller than best position loss 0.01779784760003982
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 5 train...
-------------------------------

884 loss: 0.061605  [   16/ 3548]

884 class loss: 0.040711 position_loss:0.010693

914 loss: 0.049948  [  496/ 3548]

914 class loss: 0.035827 position_loss:0.008557

944 loss: 0.119102  [  976/ 3548]

944 class loss: 0.086635 position_loss:0.020355

974 loss: 0.099603  [ 1456/ 3548]

974 class loss: 0.054518 position_loss:0.017740

1004 loss: 0.054892  [ 1936/ 3548]

1004 class loss: 0.045969 position_loss:0.009140

1034 loss: 0.060284  [ 2416/ 3548]

1034 class loss: 0.050374 position_loss:0.010042

1064 loss: 0.082582  [ 2896/ 3548]

1064 class loss: 0.065094 position_loss:0.013913

1094 loss: 0.116775  [ 3376/ 3548]

1094 class loss: 0.037178 position_loss:0.021868

Epoch 5: train loss: 0.088826

Fold 4 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 5: valid loss:0.051644

Epoch 5: valid_class_loss:0.027527	valid_position_loss:0.009228

Epoch 5: valid loss 0.05164431111068831 smaller than best loss 0.061897950540978394
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.00922776499103903 smaller than best position loss 0.011231882152501102
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 6 train...
-------------------------------

1105 loss: 0.083577  [   16/ 3548]

1105 class loss: 0.059775 position_loss:0.014324

1135 loss: 0.119125  [  496/ 3548]

1135 class loss: 0.064048 position_loss:0.021263

1165 loss: 0.078389  [  976/ 3548]

1165 class loss: 0.059625 position_loss:0.013293

1195 loss: 0.060435  [ 1456/ 3548]

1195 class loss: 0.030942 position_loss:0.010849

1225 loss: 0.105331  [ 1936/ 3548]

1225 class loss: 0.070239 position_loss:0.018257

1255 loss: 0.085566  [ 2416/ 3548]

1255 class loss: 0.062047 position_loss:0.014631

1285 loss: 0.024245  [ 2896/ 3548]

1285 class loss: 0.026993 position_loss:0.003769

1315 loss: 0.043254  [ 3376/ 3548]

1315 class loss: 0.043941 position_loss:0.006893

Epoch 6: train loss: 0.073895

Fold 4 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 6: valid loss:0.041866

Epoch 6: valid_class_loss:0.025838	valid_position_loss:0.007340

Epoch 6: valid loss 0.04186624921544456 smaller than best loss 0.05164431111068831
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.007339721215743101 smaller than best position loss 0.00922776499103903
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 7 train...
-------------------------------

1326 loss: 0.075022  [   16/ 3548]

1326 class loss: 0.058651 position_loss:0.012658

1356 loss: 0.016077  [  496/ 3548]

1356 class loss: 0.012680 position_loss:0.002708

1386 loss: 0.083674  [  976/ 3548]

1386 class loss: 0.090738 position_loss:0.013105

1416 loss: 0.091544  [ 1456/ 3548]

1416 class loss: 0.050092 position_loss:0.016305

1446 loss: 0.086798  [ 1936/ 3548]

1446 class loss: 0.111780 position_loss:0.012888

1476 loss: 0.061336  [ 2416/ 3548]

1476 class loss: 0.042058 position_loss:0.010585

1506 loss: 0.037198  [ 2896/ 3548]

1506 class loss: 0.045336 position_loss:0.005626

1536 loss: 0.046136  [ 3376/ 3548]

1536 class loss: 0.029922 position_loss:0.008030

Epoch 7: train loss: 0.058362

Fold 4 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 7: valid loss:0.033987

Epoch 7: valid_class_loss:0.027064	valid_position_loss:0.005715

Epoch 7: valid loss 0.033987017460825754 smaller than best loss 0.04186624921544456
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.0057148602053801395 smaller than best position loss 0.007339721215743101
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 8 train...
-------------------------------

1547 loss: 0.034100  [   16/ 3548]

1547 class loss: 0.041374 position_loss:0.005165

1577 loss: 0.090496  [  496/ 3548]

1577 class loss: 0.066107 position_loss:0.015455

1607 loss: 0.053773  [  976/ 3548]

1607 class loss: 0.047525 position_loss:0.008854

1637 loss: 0.057496  [ 1456/ 3548]

1637 class loss: 0.052247 position_loss:0.009409

1667 loss: 0.029178  [ 1936/ 3548]

1667 class loss: 0.016100 position_loss:0.005192

1697 loss: 0.063669  [ 2416/ 3548]

1697 class loss: 0.069105 position_loss:0.009970

1727 loss: 0.053359  [ 2896/ 3548]

1727 class loss: 0.047189 position_loss:0.008784

1757 loss: 0.034046  [ 3376/ 3548]

1757 class loss: 0.045598 position_loss:0.004985

Epoch 8: train loss: 0.045517

Fold 4 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 8: valid loss:0.031093

Epoch 8: valid_class_loss:0.027392	valid_position_loss:0.005123

Epoch 8: valid loss 0.031093239174978922 smaller than best loss 0.033987017460825754
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.005122960352427309 smaller than best position loss 0.0057148602053801395
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 9 train...
-------------------------------

1768 loss: 0.083207  [   16/ 3548]

1768 class loss: 0.069731 position_loss:0.013852

1798 loss: 0.033583  [  496/ 3548]

1798 class loss: 0.023226 position_loss:0.005787

1828 loss: 0.038549  [  976/ 3548]

1828 class loss: 0.053677 position_loss:0.005563

1858 loss: 0.027870  [ 1456/ 3548]

1858 class loss: 0.035567 position_loss:0.004151

1888 loss: 0.065234  [ 1936/ 3548]

1888 class loss: 0.029127 position_loss:0.011882

1918 loss: 0.048854  [ 2416/ 3548]

1918 class loss: 0.033801 position_loss:0.008419

1948 loss: 0.049497  [ 2896/ 3548]

1948 class loss: 0.061141 position_loss:0.007454

1978 loss: 0.038378  [ 3376/ 3548]

1978 class loss: 0.047496 position_loss:0.005776

Epoch 9: train loss: 0.037164

Fold 4 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 9: valid loss:0.026809

Epoch 9: valid_class_loss:0.024291	valid_position_loss:0.004390

Epoch 9: valid loss 0.02680898359676089 smaller than best loss 0.031093239174978922
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004390140835409624 smaller than best position loss 0.005122960352427309
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 10 train...
-------------------------------

1989 loss: 0.042100  [   16/ 3548]

1989 class loss: 0.041978 position_loss:0.006741

2019 loss: 0.022095  [  496/ 3548]

2019 class loss: 0.030405 position_loss:0.003203

2049 loss: 0.033215  [  976/ 3548]

2049 class loss: 0.027096 position_loss:0.005559

2079 loss: 0.053994  [ 1456/ 3548]

2079 class loss: 0.053224 position_loss:0.008670

2109 loss: 0.027965  [ 1936/ 3548]

2109 class loss: 0.031900 position_loss:0.004317

2139 loss: 0.056058  [ 2416/ 3548]

2139 class loss: 0.036924 position_loss:0.009735

2169 loss: 0.045330  [ 2896/ 3548]

2169 class loss: 0.062302 position_loss:0.006574

2199 loss: 0.031232  [ 3376/ 3548]

2199 class loss: 0.025567 position_loss:0.005224

Epoch 10: train loss: 0.031845

Fold 4 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 10: valid loss:0.025295

Epoch 10: valid_class_loss:0.023319	valid_position_loss:0.004126

Epoch 10: valid loss 0.025294881955682056 smaller than best loss 0.02680898359676089
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004126198793823283 smaller than best position loss 0.004390140835409624
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 11 train...
-------------------------------

2210 loss: 0.021489  [   16/ 3548]

2210 class loss: 0.029520 position_loss:0.003117

2240 loss: 0.035869  [  496/ 3548]

2240 class loss: 0.030539 position_loss:0.005952

2270 loss: 0.026904  [  976/ 3548]

2270 class loss: 0.038348 position_loss:0.003847

2300 loss: 0.011917  [ 1456/ 3548]

2300 class loss: 0.018437 position_loss:0.001646

2330 loss: 0.043492  [ 1936/ 3548]

2330 class loss: 0.066662 position_loss:0.006032

2360 loss: 0.016529  [ 2416/ 3548]

2360 class loss: 0.016367 position_loss:0.002651

2390 loss: 0.029243  [ 2896/ 3548]

2390 class loss: 0.038139 position_loss:0.004323

2420 loss: 0.046592  [ 3376/ 3548]

2420 class loss: 0.068514 position_loss:0.006578

Epoch 11: train loss: 0.027440

Fold 4 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 11: valid loss:0.023508

Epoch 11: valid_class_loss:0.021498	valid_position_loss:0.003842

Epoch 11: valid loss 0.023508141908202253 smaller than best loss 0.025294881955682056
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.00384170017974037 smaller than best position loss 0.004126198793823283
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 12 train...
-------------------------------

2431 loss: 0.033376  [   16/ 3548]

2431 class loss: 0.046463 position_loss:0.004817

2461 loss: 0.011369  [  496/ 3548]

2461 class loss: 0.022160 position_loss:0.001387

2491 loss: 0.034409  [  976/ 3548]

2491 class loss: 0.060798 position_loss:0.004450

2521 loss: 0.012135  [ 1456/ 3548]

2521 class loss: 0.021402 position_loss:0.001571

2551 loss: 0.029691  [ 1936/ 3548]

2551 class loss: 0.026188 position_loss:0.004891

2581 loss: 0.019896  [ 2416/ 3548]

2581 class loss: 0.021060 position_loss:0.003137

2611 loss: 0.019752  [ 2896/ 3548]

2611 class loss: 0.031033 position_loss:0.002709

2641 loss: 0.037629  [ 3376/ 3548]

2641 class loss: 0.062828 position_loss:0.005013

Epoch 12: train loss: 0.024101

Fold 4 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 12: valid loss:0.023006

Epoch 12: valid_class_loss:0.019976	valid_position_loss:0.003802

Epoch 12: valid loss 0.02300586384376662 smaller than best loss 0.023508141908202253
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0038021501042380525 smaller than best position loss 0.00384170017974037
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_position_model.pth 
-------------------------------

Fold 4 Epoch 13 train...
-------------------------------

2652 loss: 0.018925  [   16/ 3548]

2652 class loss: 0.027099 position_loss:0.002701

2682 loss: 0.017023  [  496/ 3548]

2682 class loss: 0.021041 position_loss:0.002563

2712 loss: 0.018192  [  976/ 3548]

2712 class loss: 0.034701 position_loss:0.002250

2742 loss: 0.048593  [ 1456/ 3548]

2742 class loss: 0.058001 position_loss:0.007398

2772 loss: 0.010463  [ 1936/ 3548]

2772 class loss: 0.011204 position_loss:0.001644

2802 loss: 0.016542  [ 2416/ 3548]

2802 class loss: 0.030476 position_loss:0.002089

2832 loss: 0.046662  [ 2896/ 3548]

2832 class loss: 0.051598 position_loss:0.007268

2862 loss: 0.015520  [ 3376/ 3548]

2862 class loss: 0.024912 position_loss:0.002108

Epoch 13: train loss: 0.021115

Fold 4 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 13: valid loss:0.023147

Epoch 13: valid_class_loss:0.019249	valid_position_loss:0.003859

Fold 4 Epoch 14 train...
-------------------------------

2873 loss: 0.011538  [   16/ 3548]

2873 class loss: 0.021414 position_loss:0.001451

2903 loss: 0.013722  [  496/ 3548]

2903 class loss: 0.021381 position_loss:0.001889

2933 loss: 0.033776  [  976/ 3548]

2933 class loss: 0.013257 position_loss:0.006225

2963 loss: 0.018305  [ 1456/ 3548]

2963 class loss: 0.014687 position_loss:0.003074

2993 loss: 0.009979  [ 1936/ 3548]

2993 class loss: 0.020989 position_loss:0.001156

3023 loss: 0.020134  [ 2416/ 3548]

3023 class loss: 0.026658 position_loss:0.002961

3053 loss: 0.014350  [ 2896/ 3548]

3053 class loss: 0.022702 position_loss:0.001962

3083 loss: 0.010689  [ 3376/ 3548]

3083 class loss: 0.018651 position_loss:0.001392

Epoch 14: train loss: 0.019162

Fold 4 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 14: valid loss:0.023998

Epoch 14: valid_class_loss:0.017592	valid_position_loss:0.004096

Fold 4 Epoch 15 train...
-------------------------------

3094 loss: 0.019539  [   16/ 3548]

3094 class loss: 0.023344 position_loss:0.002974

3124 loss: 0.006155  [  496/ 3548]

3124 class loss: 0.014132 position_loss:0.000666

3154 loss: 0.017916  [  976/ 3548]

3154 class loss: 0.028040 position_loss:0.002462

3184 loss: 0.014184  [ 1456/ 3548]

3184 class loss: 0.020091 position_loss:0.002033

3214 loss: 0.013807  [ 1936/ 3548]

3214 class loss: 0.021877 position_loss:0.001886

3244 loss: 0.020887  [ 2416/ 3548]

3244 class loss: 0.031817 position_loss:0.002905

3274 loss: 0.007844  [ 2896/ 3548]

3274 class loss: 0.013818 position_loss:0.001016

3304 loss: 0.026407  [ 3376/ 3548]

3304 class loss: 0.033898 position_loss:0.003926

Epoch 15: train loss: 0.017029

Fold 4 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 66

Epoch 15: valid loss:0.023693

Epoch 15: valid_class_loss:0.017320	valid_position_loss:0.004046

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0622/2024-06-22__21-31-21/checkpoints/best_model.pth

Fold 4 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.3         0.4            0.2             0.7     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.592602
Nucleus_export  0.498995
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.757147  0.274752  0.242853
Nucleus_export  0.666967  0.344849  0.333033
===========================================

 cs acc: 

                      0
ER             0.931034
Peroxisome     0.583333
Mitochondrion  0.272152
SIGNAL         0.834877
chloroplast    0.301370
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.949449                 0.799411           0.754621   
ER                   0.959535                 0.752999           0.849167   
Peroxisome           0.806727                 0.604245           0.761938   
Mitochondrion        0.835380                 0.755550           0.698270   
Nucleus_export       0.950602                 0.241433           0.420836   
SIGNAL               0.923469                 0.946708           0.694729   
chloroplast          0.903273                 0.703867           0.652552   
Thylakoid            0.941576                 0.730655           0.743935   

                recall_score  precision_score  f1_score  
Nucleus             0.902439         0.685185  0.778947  
ER                  0.896552         0.812500  0.852459  
Peroxisome          0.583333         1.000000  0.736842  
Mitochondrion       0.664557         0.820312  0.734266  
Nucleus_export      0.760000         0.256757  0.383838  
SIGNAL              0.890432         0.876900  0.883614  
chloroplast         0.616438         0.737705  0.671642  
Thylakoid           0.555556         1.000000  0.714286  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.3         0.4            0.2             0.7     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.713851
Nucleus_export  0.505693
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.925971  0.318901  0.074029
Nucleus_export  0.737500  0.428003  0.262500
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.375000
SIGNAL         0.863287
chloroplast    0.381579
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988034                 0.898395           0.770401   
ER                   0.938118                 0.612076           0.742405   
Peroxisome           0.614724                 0.327316           0.492723   
Mitochondrion        0.866731                 0.800453           0.742884   
Nucleus_export       0.957297                 0.492614           0.414716   
SIGNAL               0.918459                 0.951674           0.648303   
chloroplast          0.839514                 0.589514           0.557427   
Thylakoid            0.986870                 0.506871           0.353515   

                recall_score  precision_score  f1_score  
Nucleus             0.976562         0.657895  0.786164  
ER                  0.866667         0.650000  0.742857  
Peroxisome          0.307692         0.800000  0.444444  
Mitochondrion       0.706250         0.856061  0.773973  
Nucleus_export      0.800000         0.238095  0.366972  
SIGNAL              0.854071         0.870110  0.862016  
chloroplast         0.605263         0.575000  0.589744  
Thylakoid           0.300000         0.428571  0.352941  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.3         0.4            0.2             0.7     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.700028
Nucleus_export  0.449693
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.910346  0.315326  0.066217
Nucleus_export  0.677500  0.397058  0.122500
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     0.750000
Mitochondrion  0.398230
SIGNAL         0.892086
chloroplast    0.456522
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988034                 0.898395           0.770401   
ER                   0.938118                 0.612076           0.742405   
Peroxisome           0.614724                 0.327316           0.492723   
Mitochondrion        0.866731                 0.800453           0.742884   
Nucleus_export       0.957297                 0.492614           0.414716   
SIGNAL               0.918459                 0.951674           0.648303   
chloroplast          0.839514                 0.589514           0.557427   
Thylakoid            0.986870                 0.506871           0.353515   

                recall_score  precision_score  f1_score  
Nucleus             0.976562         0.657895  0.786164  
ER                  0.866667         0.650000  0.742857  
Peroxisome          0.307692         0.800000  0.444444  
Mitochondrion       0.706250         0.856061  0.773973  
Nucleus_export      0.800000         0.238095  0.366972  
SIGNAL              0.854071         0.870110  0.862016  
chloroplast         0.605263         0.575000  0.589744  
Thylakoid           0.300000         0.428571  0.352941  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.3         0.4            0.2             0.7     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.581789
Nucleus_export  0.448168
===========================================

 TPR, FPR, FNR: 

                    0         1      2
Nucleus         0.750  0.287977  0.250
Nucleus_export  0.625  0.392696  0.375
===========================================

 cs acc: 

                 0
ER             NaN
Peroxisome     NaN
Mitochondrion  0.0
SIGNAL         NaN
chloroplast    NaN
Thylakoid      NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                 0.875                   0.8875           0.774597   
ER                        NaN                  -0.0000           0.000000   
Peroxisome                NaN                  -0.0000           0.000000   
Mitochondrion           0.000                   0.1250           0.000000   
Nucleus_export            NaN                   1.0000           0.000000   
SIGNAL                    NaN                  -0.0000           0.000000   
chloroplast               NaN                  -0.0000           0.000000   
Thylakoid                 NaN                  -0.0000           0.000000   

                recall_score  precision_score  f1_score  
Nucleus                1.000              0.8  0.888889  
ER                     0.000              0.0  0.000000  
Peroxisome             0.000              0.0  0.000000  
Mitochondrion          0.000              0.0  0.000000  
Nucleus_export         0.625              1.0  0.769231  
SIGNAL                 0.000              0.0  0.000000  
chloroplast            0.000              0.0  0.000000  
Thylakoid              0.000              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.3         0.4            0.2             0.7     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.581789
Nucleus_export  0.335668
===========================================

 TPR, FPR, FNR: 

                   0         1      2
Nucleus         0.75  0.287977  0.250
Nucleus_export  0.50  0.297987  0.125
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                 0.875                   0.8875           0.774597   
ER                        NaN                  -0.0000           0.000000   
Peroxisome                NaN                  -0.0000           0.000000   
Mitochondrion           0.000                   0.1250           0.000000   
Nucleus_export            NaN                   1.0000           0.000000   
SIGNAL                    NaN                  -0.0000           0.000000   
chloroplast               NaN                  -0.0000           0.000000   
Thylakoid                 NaN                  -0.0000           0.000000   

                recall_score  precision_score  f1_score  
Nucleus                1.000              0.8  0.888889  
ER                     0.000              0.0  0.000000  
Peroxisome             0.000              0.0  0.000000  
Mitochondrion          0.000              0.0  0.000000  
Nucleus_export         0.625              1.0  0.769231  
SIGNAL                 0.000              0.0  0.000000  
chloroplast            0.000              0.0  0.000000  
Thylakoid              0.000              0.0  0.000000  
