use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.129643  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.455777  [  496/ 3543]

30 class loss: 0.111586 position_loss:0.083716

60 loss: 0.090569  [  976/ 3543]

60 class loss: 0.019313 position_loss:0.016826

90 loss: 0.777809  [ 1456/ 3543]

90 class loss: 0.160099 position_loss:0.144889

120 loss: 0.626161  [ 1936/ 3543]

120 class loss: 0.120636 position_loss:0.117190

150 loss: 0.372875  [ 2416/ 3543]

150 class loss: 0.079340 position_loss:0.069286

180 loss: 0.454613  [ 2896/ 3543]

180 class loss: 0.094883 position_loss:0.084597

210 loss: 0.953695  [ 3376/ 3543]

210 class loss: 0.197172 position_loss:0.177594

Epoch 1: train loss: 0.490991

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.291610

Epoch 1: valid_class_loss:0.059115	valid_position_loss:0.054381

Epoch 1: valid loss 0.2916099558620471 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05438101618699872 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.235502  [   16/ 3543]

221 class loss: 0.051057 position_loss:0.043697

251 loss: 0.071420  [  496/ 3543]

251 class loss: 0.014996 position_loss:0.013284

281 loss: 0.643422  [  976/ 3543]

281 class loss: 0.154088 position_loss:0.118412

311 loss: 0.587290  [ 1456/ 3543]

311 class loss: 0.133881 position_loss:0.108533

341 loss: 0.449660  [ 1936/ 3543]

341 class loss: 0.085503 position_loss:0.084232

371 loss: 0.374509  [ 2416/ 3543]

371 class loss: 0.082796 position_loss:0.069382

401 loss: 0.218247  [ 2896/ 3543]

401 class loss: 0.047310 position_loss:0.040495

431 loss: 0.325962  [ 3376/ 3543]

431 class loss: 0.068145 position_loss:0.060649

Epoch 2: train loss: 0.429152

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.226176

Epoch 2: valid_class_loss:0.049624	valid_position_loss:0.041927

Epoch 2: valid loss 0.22617581480520457 smaller than best loss 0.2916099558620471
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.041926915981842706 smaller than best position loss 0.05438101618699872
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.498665  [   16/ 3543]

442 class loss: 0.111158 position_loss:0.092323

472 loss: 0.260383  [  496/ 3543]

472 class loss: 0.064036 position_loss:0.047808

502 loss: 0.379266  [  976/ 3543]

502 class loss: 0.081028 position_loss:0.070451

532 loss: 0.180346  [ 1456/ 3543]

532 class loss: 0.044269 position_loss:0.033118

562 loss: 0.389053  [ 1936/ 3543]

562 class loss: 0.110754 position_loss:0.070427

592 loss: 0.120730  [ 2416/ 3543]

592 class loss: 0.027684 position_loss:0.022300

622 loss: 0.240946  [ 2896/ 3543]

622 class loss: 0.075258 position_loss:0.043172

652 loss: 0.382664  [ 3376/ 3543]

652 class loss: 0.131231 position_loss:0.067784

Epoch 3: train loss: 0.274997

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.119140

Epoch 3: valid_class_loss:0.038204	valid_position_loss:0.021281

Epoch 3: valid loss 0.1191396409736083 smaller than best loss 0.22617581480520457
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.021281000901508407 smaller than best position loss 0.041926915981842706
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.221231  [   16/ 3543]

663 class loss: 0.080937 position_loss:0.038851

693 loss: 0.202906  [  496/ 3543]

693 class loss: 0.060311 position_loss:0.036560

723 loss: 0.175340  [  976/ 3543]

723 class loss: 0.077596 position_loss:0.029895

753 loss: 0.237838  [ 1456/ 3543]

753 class loss: 0.116554 position_loss:0.039797

783 loss: 0.045255  [ 1936/ 3543]

783 class loss: 0.023078 position_loss:0.007512

813 loss: 0.086658  [ 2416/ 3543]

813 class loss: 0.051285 position_loss:0.013913

843 loss: 0.185045  [ 2896/ 3543]

843 class loss: 0.102253 position_loss:0.030192

873 loss: 0.130997  [ 3376/ 3543]

873 class loss: 0.068932 position_loss:0.021604

Epoch 4: train loss: 0.142957

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.078751

Epoch 4: valid_class_loss:0.032271	valid_position_loss:0.013599

Epoch 4: valid loss 0.07875068614102879 smaller than best loss 0.1191396409736083
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013598756679481381 smaller than best position loss 0.021281000901508407
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.149757  [   16/ 3543]

884 class loss: 0.086162 position_loss:0.024207

914 loss: 0.067751  [  496/ 3543]

914 class loss: 0.046641 position_loss:0.010441

944 loss: 0.109288  [  976/ 3543]

944 class loss: 0.062563 position_loss:0.017687

974 loss: 0.057709  [ 1456/ 3543]

974 class loss: 0.034915 position_loss:0.009214

1004 loss: 0.054470  [ 1936/ 3543]

1004 class loss: 0.042067 position_loss:0.008089

1034 loss: 0.072171  [ 2416/ 3543]

1034 class loss: 0.024832 position_loss:0.012779

1064 loss: 0.122892  [ 2896/ 3543]

1064 class loss: 0.084531 position_loss:0.018943

1094 loss: 0.049995  [ 3376/ 3543]

1094 class loss: 0.035082 position_loss:0.007660

Epoch 5: train loss: 0.099377

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.061995

Epoch 5: valid_class_loss:0.030653	valid_position_loss:0.010355

Epoch 5: valid loss 0.06199453243259442 smaller than best loss 0.07875068614102879
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.01035537096606981 smaller than best position loss 0.013598756679481381
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.068311  [   16/ 3543]

1105 class loss: 0.078257 position_loss:0.008445

1135 loss: 0.093121  [  496/ 3543]

1135 class loss: 0.054550 position_loss:0.014988

1165 loss: 0.031704  [  976/ 3543]

1165 class loss: 0.009237 position_loss:0.005725

1195 loss: 0.039156  [ 1456/ 3543]

1195 class loss: 0.030614 position_loss:0.005790

1225 loss: 0.053142  [ 1936/ 3543]

1225 class loss: 0.047230 position_loss:0.007480

1255 loss: 0.087310  [ 2416/ 3543]

1255 class loss: 0.071304 position_loss:0.012708

1285 loss: 0.106349  [ 2896/ 3543]

1285 class loss: 0.097394 position_loss:0.014777

1315 loss: 0.082625  [ 3376/ 3543]

1315 class loss: 0.066608 position_loss:0.012085

Epoch 6: train loss: 0.082450

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.051544

Epoch 6: valid_class_loss:0.029375	valid_position_loss:0.008350

Epoch 6: valid loss 0.0515441545178123 smaller than best loss 0.06199453243259442
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.008350496987914844 smaller than best position loss 0.01035537096606981
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.116182  [   16/ 3543]

1326 class loss: 0.091702 position_loss:0.017123

1356 loss: 0.103257  [  496/ 3543]

1356 class loss: 0.066507 position_loss:0.016218

1386 loss: 0.039621  [  976/ 3543]

1386 class loss: 0.036518 position_loss:0.005490

1416 loss: 0.056116  [ 1456/ 3543]

1416 class loss: 0.055320 position_loss:0.007535

1446 loss: 0.041358  [ 1936/ 3543]

1446 class loss: 0.040075 position_loss:0.005600

1476 loss: 0.025129  [ 2416/ 3543]

1476 class loss: 0.024156 position_loss:0.003415

1506 loss: 0.031503  [ 2896/ 3543]

1506 class loss: 0.033382 position_loss:0.004075

1536 loss: 0.054499  [ 3376/ 3543]

1536 class loss: 0.027100 position_loss:0.009093

Epoch 7: train loss: 0.066848

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.044041

Epoch 7: valid_class_loss:0.028758	valid_position_loss:0.006891

Epoch 7: valid loss 0.04404065760528449 smaller than best loss 0.0515441545178123
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.006890951265597689 smaller than best position loss 0.008350496987914844
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.056138  [   16/ 3543]

1547 class loss: 0.040968 position_loss:0.008496

1577 loss: 0.035531  [  496/ 3543]

1577 class loss: 0.019327 position_loss:0.005818

1607 loss: 0.081620  [  976/ 3543]

1607 class loss: 0.054933 position_loss:0.012662

1637 loss: 0.076963  [ 1456/ 3543]

1637 class loss: 0.065547 position_loss:0.011023

1667 loss: 0.104911  [ 1936/ 3543]

1667 class loss: 0.079548 position_loss:0.015679

1697 loss: 0.057628  [ 2416/ 3543]

1697 class loss: 0.046870 position_loss:0.008401

1727 loss: 0.047124  [ 2896/ 3543]

1727 class loss: 0.039584 position_loss:0.006786

1757 loss: 0.084588  [ 3376/ 3543]

1757 class loss: 0.059016 position_loss:0.012983

Epoch 8: train loss: 0.052203

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.039893

Epoch 8: valid_class_loss:0.028971	valid_position_loss:0.006047

Epoch 8: valid loss 0.039892938835446576 smaller than best loss 0.04404065760528449
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006047183697044399 smaller than best position loss 0.006890951265597689
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.046528  [   16/ 3543]

1768 class loss: 0.053225 position_loss:0.005757

1798 loss: 0.034834  [  496/ 3543]

1798 class loss: 0.017038 position_loss:0.005831

1828 loss: 0.079074  [  976/ 3543]

1828 class loss: 0.079098 position_loss:0.010542

1858 loss: 0.040881  [ 1456/ 3543]

1858 class loss: 0.045119 position_loss:0.005168

1888 loss: 0.048640  [ 1936/ 3543]

1888 class loss: 0.036983 position_loss:0.007262

1918 loss: 0.054581  [ 2416/ 3543]

1918 class loss: 0.053306 position_loss:0.007362

1948 loss: 0.038724  [ 2896/ 3543]

1948 class loss: 0.042930 position_loss:0.004883

1978 loss: 0.038795  [ 3376/ 3543]

1978 class loss: 0.020366 position_loss:0.006401

Epoch 9: train loss: 0.043098

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.032849

Epoch 9: valid_class_loss:0.025671	valid_position_loss:0.004858

Epoch 9: valid loss 0.0328491427073111 smaller than best loss 0.039892938835446576
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.0048584476487424245 smaller than best position loss 0.006047183697044399
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.017417  [   16/ 3543]

1989 class loss: 0.020429 position_loss:0.002121

2019 loss: 0.038344  [  496/ 3543]

2019 class loss: 0.040517 position_loss:0.004968

2049 loss: 0.063697  [  976/ 3543]

2049 class loss: 0.043619 position_loss:0.009832

2079 loss: 0.012951  [ 1456/ 3543]

2079 class loss: 0.018613 position_loss:0.001349

2109 loss: 0.041695  [ 1936/ 3543]

2109 class loss: 0.051011 position_loss:0.004938

2139 loss: 0.033391  [ 2416/ 3543]

2139 class loss: 0.032396 position_loss:0.004518

2169 loss: 0.030489  [ 2896/ 3543]

2169 class loss: 0.028809 position_loss:0.004177

2199 loss: 0.044684  [ 3376/ 3543]

2199 class loss: 0.028944 position_loss:0.007007

Epoch 10: train loss: 0.037354

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.030398

Epoch 10: valid_class_loss:0.024973	valid_position_loss:0.004415

Epoch 10: valid loss 0.03039794234437035 smaller than best loss 0.0328491427073111
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004414743370511985 smaller than best position loss 0.0048584476487424245
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.031351  [   16/ 3543]

2210 class loss: 0.019715 position_loss:0.004956

2240 loss: 0.043427  [  496/ 3543]

2240 class loss: 0.019328 position_loss:0.007397

2270 loss: 0.029380  [  976/ 3543]

2270 class loss: 0.038028 position_loss:0.003341

2300 loss: 0.013791  [ 1456/ 3543]

2300 class loss: 0.016265 position_loss:0.001674

2330 loss: 0.057302  [ 1936/ 3543]

2330 class loss: 0.053676 position_loss:0.007882

2360 loss: 0.060925  [ 2416/ 3543]

2360 class loss: 0.020198 position_loss:0.010838

2390 loss: 0.056276  [ 2896/ 3543]

2390 class loss: 0.050754 position_loss:0.007872

2420 loss: 0.024352  [ 3376/ 3543]

2420 class loss: 0.032874 position_loss:0.002679

Epoch 11: train loss: 0.032758

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.028100

Epoch 11: valid_class_loss:0.023280	valid_position_loss:0.004068

Epoch 11: valid loss 0.028100267281565436 smaller than best loss 0.03039794234437035
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.004068025893743843 smaller than best position loss 0.004414743370511985
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.015237  [   16/ 3543]

2431 class loss: 0.011773 position_loss:0.002262

2461 loss: 0.006326  [  496/ 3543]

2461 class loss: 0.009016 position_loss:0.000664

2491 loss: 0.012503  [  976/ 3543]

2491 class loss: 0.013641 position_loss:0.001591

2521 loss: 0.033192  [ 1456/ 3543]

2521 class loss: 0.044013 position_loss:0.003704

2551 loss: 0.008479  [ 1936/ 3543]

2551 class loss: 0.010817 position_loss:0.000975

2581 loss: 0.021429  [ 2416/ 3543]

2581 class loss: 0.026756 position_loss:0.002502

2611 loss: 0.020265  [ 2896/ 3543]

2611 class loss: 0.017083 position_loss:0.002914

2641 loss: 0.019301  [ 3376/ 3543]

2641 class loss: 0.028199 position_loss:0.001980

Epoch 12: train loss: 0.029392

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.024902

Epoch 12: valid_class_loss:0.021673	valid_position_loss:0.003535

Epoch 12: valid loss 0.024901539139772482 smaller than best loss 0.028100267281565436
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003535468337034319 smaller than best position loss 0.004068025893743843
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.025253  [   16/ 3543]

2652 class loss: 0.025989 position_loss:0.003318

2682 loss: 0.055443  [  496/ 3543]

2682 class loss: 0.066414 position_loss:0.006661

2712 loss: 0.006938  [  976/ 3543]

2712 class loss: 0.008514 position_loss:0.000820

2742 loss: 0.028371  [ 1456/ 3543]

2742 class loss: 0.035202 position_loss:0.003327

2772 loss: 0.011046  [ 1936/ 3543]

2772 class loss: 0.014003 position_loss:0.001276

2802 loss: 0.036814  [ 2416/ 3543]

2802 class loss: 0.018877 position_loss:0.006104

2832 loss: 0.018595  [ 2896/ 3543]

2832 class loss: 0.026367 position_loss:0.001961

2862 loss: 0.012984  [ 3376/ 3543]

2862 class loss: 0.020734 position_loss:0.001215

Epoch 13: train loss: 0.026267

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.023665

Epoch 13: valid_class_loss:0.020522	valid_position_loss:0.003365

Epoch 13: valid loss 0.023665396351811356 smaller than best loss 0.024901539139772482
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0033649764562473533 smaller than best position loss 0.003535468337034319
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.027924  [   16/ 3543]

2873 class loss: 0.037318 position_loss:0.003097

2903 loss: 0.031876  [  496/ 3543]

2903 class loss: 0.038389 position_loss:0.003816

2933 loss: 0.019660  [  976/ 3543]

2933 class loss: 0.027612 position_loss:0.002091

2963 loss: 0.034375  [ 1456/ 3543]

2963 class loss: 0.040087 position_loss:0.004203

2993 loss: 0.025637  [ 1936/ 3543]

2993 class loss: 0.038418 position_loss:0.002566

3023 loss: 0.013416  [ 2416/ 3543]

3023 class loss: 0.018115 position_loss:0.001475

3053 loss: 0.019742  [ 2896/ 3543]

3053 class loss: 0.018423 position_loss:0.002720

3083 loss: 0.013743  [ 3376/ 3543]

3083 class loss: 0.015869 position_loss:0.001691

Epoch 14: train loss: 0.023613

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.023140

Epoch 14: valid_class_loss:0.019055	valid_position_loss:0.003358

Epoch 14: valid loss 0.023140474285573323 smaller than best loss 0.023665396351811356
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0033577386420647385 smaller than best position loss 0.0033649764562473533
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.052803  [   16/ 3543]

3094 class loss: 0.044612 position_loss:0.007586

3124 loss: 0.031652  [  496/ 3543]

3124 class loss: 0.021105 position_loss:0.004923

3154 loss: 0.013898  [  976/ 3543]

3154 class loss: 0.015279 position_loss:0.001761

3184 loss: 0.017822  [ 1456/ 3543]

3184 class loss: 0.020570 position_loss:0.002193

3214 loss: 0.004714  [ 1936/ 3543]

3214 class loss: 0.006561 position_loss:0.000505

3244 loss: 0.027435  [ 2416/ 3543]

3244 class loss: 0.015665 position_loss:0.004443

3274 loss: 0.028921  [ 2896/ 3543]

3274 class loss: 0.018082 position_loss:0.004579

3304 loss: 0.020383  [ 3376/ 3543]

3304 class loss: 0.020649 position_loss:0.002700

Epoch 15: train loss: 0.021924

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.020755

Epoch 15: valid_class_loss:0.019140	valid_position_loss:0.002875

Epoch 15: valid loss 0.020755466541081662 smaller than best loss 0.023140474285573323
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.002875079679933909 smaller than best position loss 0.0033577386420647385
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__18-52-51/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.764214
Nucleus_export  0.635631
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.893543  0.175764  0.106457
Nucleus_export  0.789434  0.221675  0.210566
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.384615
Mitochondrion  0.356250
SIGNAL         0.867896
chloroplast    0.486842
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988520                 0.904219           0.828873   
ER                   0.944779                 0.631984           0.752349   
Peroxisome           0.636157                 0.353923           0.492723   
Mitochondrion        0.919686                 0.888274           0.831655   
Nucleus_export       0.972355                 0.493173           0.464989   
SIGNAL               0.972575                 0.983077           0.850306   
chloroplast          0.943588                 0.772683           0.707694   
Thylakoid            0.996099                 0.603015           0.601887   

                recall_score  precision_score  f1_score  
Nucleus             0.882812         0.818841  0.849624  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         0.800000  0.444444  
Mitochondrion       0.837500         0.875817  0.856230  
Nucleus_export      0.600000         0.384615  0.468750  
SIGNAL              0.961598         0.926036  0.943482  
chloroplast         0.723684         0.733333  0.728477  
Thylakoid           0.900000         0.409091  0.562500  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.647290
Nucleus_export  0.338982
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.770835  0.195072  0.229165
Nucleus_export  0.438214  0.184631  0.561786
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.257862
SIGNAL         0.883178
chloroplast    0.383562
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.981626                 0.887111           0.825564   
ER                   0.998423                 0.920229           0.878084   
Peroxisome           0.954318                 0.576627           0.643616   
Mitochondrion        0.893061                 0.869894           0.827564   
Nucleus_export       0.949147                 0.286075           0.323399   
SIGNAL               0.974034                 0.982259           0.860762   
chloroplast          0.973076                 0.844499           0.752686   
Thylakoid            0.994275                 0.507427           0.635623   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.795620  0.844961  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.538462         0.777778  0.636364  
Mitochondrion       0.805031         0.901408  0.850498  
Nucleus_export      0.440000         0.268293  0.333333  
SIGNAL              0.965732         0.928144  0.946565  
chloroplast         0.753425         0.785714  0.769231  
Thylakoid           1.000000         0.409091  0.580645  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.639180
Nucleus_export  0.243483
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.761537  0.189088  0.139289
Nucleus_export  0.312500  0.122210  0.127500
===========================================

 cs acc: 

                      0
ER             0.961538
Peroxisome     0.857143
Mitochondrion  0.234375
SIGNAL         0.895161
chloroplast    0.436364
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.981626                 0.887111           0.825564   
ER                   0.998423                 0.920229           0.878084   
Peroxisome           0.954318                 0.576627           0.643616   
Mitochondrion        0.893061                 0.869894           0.827564   
Nucleus_export       0.949147                 0.286075           0.323399   
SIGNAL               0.974034                 0.982259           0.860762   
chloroplast          0.973076                 0.844499           0.752686   
Thylakoid            0.994275                 0.507427           0.635623   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.795620  0.844961  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.538462         0.777778  0.636364  
Mitochondrion       0.805031         0.901408  0.850498  
Nucleus_export      0.440000         0.268293  0.333333  
SIGNAL              0.965732         0.928144  0.946565  
chloroplast         0.753425         0.785714  0.769231  
Thylakoid           1.000000         0.409091  0.580645  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.870109
Nucleus_export  0.301620
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.150105  0.0
Nucleus_export  0.4  0.251049  0.6
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.870109
Nucleus_export  0.301620
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.150105  0.0
Nucleus_export  0.4  0.209720  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
