use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.089412  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.316284  [  496/ 3543]

30 class loss: 0.111585 position_loss:0.083727

60 loss: 0.062539  [  976/ 3543]

60 class loss: 0.019311 position_loss:0.016831

90 loss: 0.536508  [ 1456/ 3543]

90 class loss: 0.160061 position_loss:0.144946

120 loss: 0.431017  [ 1936/ 3543]

120 class loss: 0.120582 position_loss:0.117247

150 loss: 0.257587  [ 2416/ 3543]

150 class loss: 0.079299 position_loss:0.069346

180 loss: 0.313848  [ 2896/ 3543]

180 class loss: 0.094849 position_loss:0.084669

210 loss: 0.658355  [ 3376/ 3543]

210 class loss: 0.197069 position_loss:0.177800

Epoch 1: train loss: 0.338925

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.201150

Epoch 1: valid_class_loss:0.059077	valid_position_loss:0.054437

Epoch 1: valid loss 0.20114958878344202 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.054437185970605866 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.162837  [   16/ 3543]

221 class loss: 0.051027 position_loss:0.043748

251 loss: 0.049349  [  496/ 3543]

251 class loss: 0.014994 position_loss:0.013305

281 loss: 0.447180  [  976/ 3543]

281 class loss: 0.153993 position_loss:0.118755

311 loss: 0.408013  [ 1456/ 3543]

311 class loss: 0.133909 position_loss:0.109013

341 loss: 0.310653  [ 1936/ 3543]

341 class loss: 0.085655 position_loss:0.084630

371 loss: 0.260817  [ 2416/ 3543]

371 class loss: 0.083073 position_loss:0.069938

401 loss: 0.152066  [ 2896/ 3543]

401 class loss: 0.047454 position_loss:0.040874

431 loss: 0.227265  [ 3376/ 3543]

431 class loss: 0.068534 position_loss:0.061326

Epoch 2: train loss: 0.297986

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.158079

Epoch 2: valid_class_loss:0.049858	valid_position_loss:0.042438

Epoch 2: valid loss 0.15807889456683913 smaller than best loss 0.20114958878344202
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.042437819372591 smaller than best position loss 0.054437185970605866
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.348420  [   16/ 3543]

442 class loss: 0.111423 position_loss:0.093384

472 loss: 0.182829  [  496/ 3543]

472 class loss: 0.064364 position_loss:0.048412

502 loss: 0.265150  [  976/ 3543]

502 class loss: 0.081219 position_loss:0.071423

532 loss: 0.126994  [ 1456/ 3543]

532 class loss: 0.044398 position_loss:0.033658

562 loss: 0.276442  [ 1936/ 3543]

562 class loss: 0.110225 position_loss:0.071910

592 loss: 0.085406  [ 2416/ 3543]

592 class loss: 0.027760 position_loss:0.022846

622 loss: 0.174101  [ 2896/ 3543]

622 class loss: 0.074788 position_loss:0.044751

652 loss: 0.281558  [ 3376/ 3543]

652 class loss: 0.131058 position_loss:0.071362

Epoch 3: train loss: 0.195380

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.087450

Epoch 3: valid_class_loss:0.038288	valid_position_loss:0.022406

Epoch 3: valid loss 0.08745048108295293 smaller than best loss 0.15807889456683913
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.022406372957649693 smaller than best position loss 0.042437819372591
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.164299  [   16/ 3543]

663 class loss: 0.080954 position_loss:0.041194

693 loss: 0.146956  [  496/ 3543]

693 class loss: 0.060067 position_loss:0.038080

723 loss: 0.130987  [  976/ 3543]

723 class loss: 0.077159 position_loss:0.031580

753 loss: 0.180125  [ 1456/ 3543]

753 class loss: 0.116520 position_loss:0.042386

783 loss: 0.034199  [ 1936/ 3543]

783 class loss: 0.023162 position_loss:0.007944

813 loss: 0.065902  [ 2416/ 3543]

813 class loss: 0.051282 position_loss:0.014643

843 loss: 0.138087  [ 2896/ 3543]

843 class loss: 0.101068 position_loss:0.031319

873 loss: 0.096259  [ 3376/ 3543]

873 class loss: 0.068358 position_loss:0.022042

Epoch 4: train loss: 0.105846

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.056223

Epoch 4: valid_class_loss:0.032297	valid_position_loss:0.013637

Epoch 4: valid loss 0.056222882741360745 smaller than best loss 0.08745048108295293
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013637168387025304 smaller than best position loss 0.022406372957649693
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.111128  [   16/ 3543]

884 class loss: 0.085512 position_loss:0.024787

914 loss: 0.051356  [  496/ 3543]

914 class loss: 0.046332 position_loss:0.010774

944 loss: 0.080495  [  976/ 3543]

944 class loss: 0.062148 position_loss:0.017934

974 loss: 0.042812  [ 1456/ 3543]

974 class loss: 0.034516 position_loss:0.009392

1004 loss: 0.041362  [ 1936/ 3543]

1004 class loss: 0.041575 position_loss:0.008251

1034 loss: 0.051389  [ 2416/ 3543]

1034 class loss: 0.025025 position_loss:0.012914

1064 loss: 0.091916  [ 2896/ 3543]

1064 class loss: 0.083437 position_loss:0.019231

1094 loss: 0.037585  [ 3376/ 3543]

1094 class loss: 0.034767 position_loss:0.007799

Epoch 5: train loss: 0.073340

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.045346

Epoch 5: valid_class_loss:0.030461	valid_position_loss:0.010558

Epoch 5: valid loss 0.045345668794396686 smaller than best loss 0.056222882741360745
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010557588790864906 smaller than best position loss 0.013637168387025304
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.053800  [   16/ 3543]

1105 class loss: 0.075478 position_loss:0.008592

1135 loss: 0.068780  [  496/ 3543]

1135 class loss: 0.053800 position_loss:0.015254

1165 loss: 0.022548  [  976/ 3543]

1165 class loss: 0.009319 position_loss:0.005833

1195 loss: 0.029610  [ 1456/ 3543]

1195 class loss: 0.030046 position_loss:0.005878

1225 loss: 0.040481  [ 1936/ 3543]

1225 class loss: 0.045656 position_loss:0.007579

1255 loss: 0.065648  [ 2416/ 3543]

1255 class loss: 0.068329 position_loss:0.012862

1285 loss: 0.080909  [ 2896/ 3543]

1285 class loss: 0.092976 position_loss:0.014975

1315 loss: 0.062476  [ 3376/ 3543]

1315 class loss: 0.064979 position_loss:0.012245

Epoch 6: train loss: 0.061293

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.039165

Epoch 6: valid_class_loss:0.029226	valid_position_loss:0.008827

Epoch 6: valid loss 0.039165065582120774 smaller than best loss 0.045345668794396686
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.008826957058238213 smaller than best position loss 0.010557588790864906
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.088914  [   16/ 3543]

1326 class loss: 0.088462 position_loss:0.017828

1356 loss: 0.078604  [  496/ 3543]

1356 class loss: 0.066958 position_loss:0.016885

1386 loss: 0.030519  [  976/ 3543]

1386 class loss: 0.035466 position_loss:0.005609

1416 loss: 0.043496  [ 1456/ 3543]

1416 class loss: 0.052886 position_loss:0.007760

1446 loss: 0.032759  [ 1936/ 3543]

1446 class loss: 0.038844 position_loss:0.005943

1476 loss: 0.020035  [ 2416/ 3543]

1476 class loss: 0.023596 position_loss:0.003651

1506 loss: 0.025584  [ 2896/ 3543]

1506 class loss: 0.033556 position_loss:0.004320

1536 loss: 0.043196  [ 3376/ 3543]

1536 class loss: 0.028156 position_loss:0.010143

Epoch 7: train loss: 0.051403

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.032778

Epoch 7: valid_class_loss:0.027406	valid_position_loss:0.007093

Epoch 7: valid loss 0.03277841616485801 smaller than best loss 0.039165065582120774
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.007092944382590558 smaller than best position loss 0.008826957058238213
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.043794  [   16/ 3543]

1547 class loss: 0.041224 position_loss:0.009016

1577 loss: 0.029695  [  496/ 3543]

1577 class loss: 0.019609 position_loss:0.006948

1607 loss: 0.063409  [  976/ 3543]

1607 class loss: 0.052661 position_loss:0.013757

1637 loss: 0.060855  [ 1456/ 3543]

1637 class loss: 0.063819 position_loss:0.011875

1667 loss: 0.077846  [ 1936/ 3543]

1667 class loss: 0.073323 position_loss:0.016022

1697 loss: 0.045076  [ 2416/ 3543]

1697 class loss: 0.044424 position_loss:0.009080

1727 loss: 0.036456  [ 2896/ 3543]

1727 class loss: 0.037392 position_loss:0.007198

1757 loss: 0.064005  [ 3376/ 3543]

1757 class loss: 0.056485 position_loss:0.013553

Epoch 8: train loss: 0.040448

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.029804

Epoch 8: valid_class_loss:0.027617	valid_position_loss:0.006180

Epoch 8: valid loss 0.0298040806340603 smaller than best loss 0.03277841616485801
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006179544092429474 smaller than best position loss 0.007092944382590558
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.036623  [   16/ 3543]

1768 class loss: 0.049699 position_loss:0.006017

1798 loss: 0.024824  [  496/ 3543]

1798 class loss: 0.016947 position_loss:0.005753

1828 loss: 0.060366  [  976/ 3543]

1828 class loss: 0.072542 position_loss:0.010856

1858 loss: 0.031773  [ 1456/ 3543]

1858 class loss: 0.042402 position_loss:0.005292

1888 loss: 0.036814  [ 1936/ 3543]

1888 class loss: 0.034481 position_loss:0.007596

1918 loss: 0.042472  [ 2416/ 3543]

1918 class loss: 0.051331 position_loss:0.007608

1948 loss: 0.029680  [ 2896/ 3543]

1948 class loss: 0.039236 position_loss:0.004980

1978 loss: 0.029072  [ 3376/ 3543]

1978 class loss: 0.019816 position_loss:0.006740

Epoch 9: train loss: 0.033183

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.024927

Epoch 9: valid_class_loss:0.024406	valid_position_loss:0.005037

Epoch 9: valid loss 0.024926880959134045 smaller than best loss 0.0298040806340603
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.0050374817510001665 smaller than best position loss 0.006179544092429474
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.013553  [   16/ 3543]

1989 class loss: 0.018837 position_loss:0.002182

2019 loss: 0.030539  [  496/ 3543]

2019 class loss: 0.040106 position_loss:0.005151

2049 loss: 0.049016  [  976/ 3543]

2049 class loss: 0.041838 position_loss:0.010521

2079 loss: 0.010268  [ 1456/ 3543]

2079 class loss: 0.017080 position_loss:0.001372

2109 loss: 0.032241  [ 1936/ 3543]

2109 class loss: 0.046116 position_loss:0.005061

2139 loss: 0.026466  [ 2416/ 3543]

2139 class loss: 0.029837 position_loss:0.004956

2169 loss: 0.023818  [ 2896/ 3543]

2169 class loss: 0.026491 position_loss:0.004496

2199 loss: 0.033129  [ 3376/ 3543]

2199 class loss: 0.027089 position_loss:0.007230

Epoch 10: train loss: 0.028665

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.022967

Epoch 10: valid_class_loss:0.023398	valid_position_loss:0.004550

Epoch 10: valid loss 0.022966752665206692 smaller than best loss 0.024926880959134045
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.0045502688952541465 smaller than best position loss 0.0050374817510001665
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.023493  [   16/ 3543]

2210 class loss: 0.018278 position_loss:0.005220

2240 loss: 0.031115  [  496/ 3543]

2240 class loss: 0.018502 position_loss:0.007484

2270 loss: 0.022413  [  976/ 3543]

2270 class loss: 0.032940 position_loss:0.003430

2300 loss: 0.010664  [ 1456/ 3543]

2300 class loss: 0.014803 position_loss:0.001719

2330 loss: 0.042531  [ 1936/ 3543]

2330 class loss: 0.046927 position_loss:0.008067

2360 loss: 0.042683  [ 2416/ 3543]

2360 class loss: 0.018913 position_loss:0.010914

2390 loss: 0.042488  [ 2896/ 3543]

2390 class loss: 0.046927 position_loss:0.008054

2420 loss: 0.018607  [ 3376/ 3543]

2420 class loss: 0.028511 position_loss:0.002731

Epoch 11: train loss: 0.025076

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.021193

Epoch 11: valid_class_loss:0.021637	valid_position_loss:0.004194

Epoch 11: valid loss 0.021193204121654284 smaller than best loss 0.022966752665206692
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.004194298805119294 smaller than best position loss 0.0045502688952541465
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.011182  [   16/ 3543]

2431 class loss: 0.010990 position_loss:0.002255

2461 loss: 0.004927  [  496/ 3543]

2461 class loss: 0.008180 position_loss:0.000660

2491 loss: 0.009598  [  976/ 3543]

2491 class loss: 0.012665 position_loss:0.001613

2521 loss: 0.026187  [ 1456/ 3543]

2521 class loss: 0.040760 position_loss:0.003780

2551 loss: 0.006496  [ 1936/ 3543]

2551 class loss: 0.009684 position_loss:0.000980

2581 loss: 0.016732  [ 2416/ 3543]

2581 class loss: 0.024548 position_loss:0.002565

2611 loss: 0.014934  [ 2896/ 3543]

2611 class loss: 0.015015 position_loss:0.002979

2641 loss: 0.015049  [ 3376/ 3543]

2641 class loss: 0.024837 position_loss:0.002031

Epoch 12: train loss: 0.022506

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.018722

Epoch 12: valid_class_loss:0.019828	valid_position_loss:0.003634

Epoch 12: valid loss 0.01872230912335806 smaller than best loss 0.021193204121654284
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003633904509476901 smaller than best position loss 0.004194298805119294
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.019630  [   16/ 3543]

2652 class loss: 0.023880 position_loss:0.003501

2682 loss: 0.042196  [  496/ 3543]

2682 class loss: 0.059049 position_loss:0.006754

2712 loss: 0.005429  [  976/ 3543]

2712 class loss: 0.007843 position_loss:0.000844

2742 loss: 0.021572  [ 1456/ 3543]

2742 class loss: 0.030630 position_loss:0.003409

2772 loss: 0.008479  [ 1936/ 3543]

2772 class loss: 0.012282 position_loss:0.001316

2802 loss: 0.026818  [ 2416/ 3543]

2802 class loss: 0.018094 position_loss:0.006236

2832 loss: 0.013961  [ 2896/ 3543]

2832 class loss: 0.021990 position_loss:0.001989

2862 loss: 0.010333  [ 3376/ 3543]

2862 class loss: 0.018786 position_loss:0.001221

Epoch 13: train loss: 0.020094

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.017835

Epoch 13: valid_class_loss:0.018864	valid_position_loss:0.003464

Epoch 13: valid loss 0.01783452354580551 smaller than best loss 0.01872230912335806
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0034639368219277385 smaller than best position loss 0.003633904509476901
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.021647  [   16/ 3543]

2873 class loss: 0.033256 position_loss:0.003169

2903 loss: 0.024535  [  496/ 3543]

2903 class loss: 0.034383 position_loss:0.003922

2933 loss: 0.015725  [  976/ 3543]

2933 class loss: 0.026056 position_loss:0.002112

2963 loss: 0.025724  [ 1456/ 3543]

2963 class loss: 0.035124 position_loss:0.004205

2993 loss: 0.020083  [ 1936/ 3543]

2993 class loss: 0.032864 position_loss:0.002739

3023 loss: 0.010373  [ 2416/ 3543]

3023 class loss: 0.016249 position_loss:0.001487

3053 loss: 0.014531  [ 2896/ 3543]

3053 class loss: 0.016074 position_loss:0.002752

3083 loss: 0.010708  [ 3376/ 3543]

3083 class loss: 0.014334 position_loss:0.001779

Epoch 14: train loss: 0.018054

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.017407

Epoch 14: valid_class_loss:0.017548	valid_position_loss:0.003467

Epoch 14: valid loss 0.017407340049527736 smaller than best loss 0.01783452354580551
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.038248  [   16/ 3543]

3094 class loss: 0.037485 position_loss:0.007726

3124 loss: 0.023590  [  496/ 3543]

3124 class loss: 0.019185 position_loss:0.005158

3154 loss: 0.010793  [  976/ 3543]

3154 class loss: 0.013981 position_loss:0.001840

3184 loss: 0.013378  [ 1456/ 3543]

3184 class loss: 0.017959 position_loss:0.002217

3214 loss: 0.003752  [ 1936/ 3543]

3214 class loss: 0.006199 position_loss:0.000506

3244 loss: 0.020422  [ 2416/ 3543]

3244 class loss: 0.013975 position_loss:0.004729

3274 loss: 0.021658  [ 2896/ 3543]

3274 class loss: 0.016821 position_loss:0.004815

3304 loss: 0.015741  [ 3376/ 3543]

3304 class loss: 0.019019 position_loss:0.002820

Epoch 15: train loss: 0.016757

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.015717

Epoch 15: valid_class_loss:0.017566	valid_position_loss:0.002958

Epoch 15: valid loss 0.015716688280443255 smaller than best loss 0.017407340049527736
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0029584415277785128 smaller than best position loss 0.0034639368219277385
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-17__01-23-37/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.756425
Nucleus_export  0.632316
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.877221  0.165012  0.122779
Nucleus_export  0.794297  0.234152  0.205703
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.384615
Mitochondrion  0.337500
SIGNAL         0.867896
chloroplast    0.539474
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.989466                 0.910728           0.844007   
ER                   0.929486                 0.625941           0.752349   
Peroxisome           0.702217                 0.309213           0.492723   
Mitochondrion        0.923439                 0.898616           0.858819   
Nucleus_export       0.972432                 0.506106           0.478521   
SIGNAL               0.979525                 0.987321           0.892339   
chloroplast          0.970358                 0.840866           0.753170   
Thylakoid            0.996765                 0.636732           0.664111   

                recall_score  precision_score  f1_score  
Nucleus             0.859375         0.866142  0.862745  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         0.800000  0.444444  
Mitochondrion       0.781250         0.984252  0.871080  
Nucleus_export      0.600000         0.405405  0.483871  
SIGNAL              0.969278         0.948872  0.958967  
chloroplast         0.671053         0.879310  0.761194  
Thylakoid           0.700000         0.636364  0.666667  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.647031
Nucleus_export  0.330463
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.763364  0.182280  0.236636
Nucleus_export  0.433929  0.192841  0.566071
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.245283
SIGNAL         0.880062
chloroplast    0.410959
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.982173                 0.886704           0.835873   
ER                   0.998524                 0.933297           0.897611   
Peroxisome           0.912909                 0.536029           0.584508   
Mitochondrion        0.904344                 0.887666           0.825932   
Nucleus_export       0.949147                 0.283394           0.319138   
SIGNAL               0.982307                 0.988120           0.890598   
chloroplast          0.982139                 0.894833           0.827671   
Thylakoid            0.994381                 0.557716           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.876033         0.834646  0.854839  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.461538         0.750000  0.571429  
Mitochondrion       0.723270         0.991379  0.836364  
Nucleus_export      0.400000         0.285714  0.333333  
SIGNAL              0.968847         0.946728  0.957660  
chloroplast         0.753425         0.932203  0.833333  
Thylakoid           0.777778         0.466667  0.583333  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.626028
Nucleus_export  0.237842
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.740636  0.176065  0.135397
Nucleus_export  0.312500  0.124753  0.087500
===========================================

 cs acc: 

                      0
ER             0.962963
Peroxisome     0.833333
Mitochondrion  0.234783
SIGNAL         0.890675
chloroplast    0.472727
Thylakoid      0.714286
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.982173                 0.886704           0.835873   
ER                   0.998524                 0.933297           0.897611   
Peroxisome           0.912909                 0.536029           0.584508   
Mitochondrion        0.904344                 0.887666           0.825932   
Nucleus_export       0.949147                 0.283394           0.319138   
SIGNAL               0.982307                 0.988120           0.890598   
chloroplast          0.982139                 0.894833           0.827671   
Thylakoid            0.994381                 0.557716           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.876033         0.834646  0.854839  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.461538         0.750000  0.571429  
Mitochondrion       0.723270         0.991379  0.836364  
Nucleus_export      0.400000         0.285714  0.333333  
SIGNAL              0.968847         0.946728  0.957660  
chloroplast         0.753425         0.932203  0.833333  
Thylakoid           0.777778         0.466667  0.583333  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.875756
Nucleus_export  0.293336
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.142156  0.0
Nucleus_export  0.4  0.266836  0.6
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.875756
Nucleus_export  0.293336
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.142156  0.0
Nucleus_export  0.4  0.226159  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
