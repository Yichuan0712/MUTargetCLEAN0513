use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.127406  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.446456  [  496/ 3543]

30 class loss: 0.111590 position_loss:0.083712

60 loss: 0.088950  [  976/ 3543]

60 class loss: 0.019315 position_loss:0.016824

90 loss: 0.764346  [ 1456/ 3543]

90 class loss: 0.160132 position_loss:0.144863

120 loss: 0.615988  [ 1936/ 3543]

120 class loss: 0.120670 position_loss:0.117164

150 loss: 0.366135  [ 2416/ 3543]

150 class loss: 0.079367 position_loss:0.069259

180 loss: 0.446557  [ 2896/ 3543]

180 class loss: 0.094920 position_loss:0.084565

210 loss: 0.936836  [ 3376/ 3543]

210 class loss: 0.197240 position_loss:0.177505

Epoch 1: train loss: 0.482303

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.286566

Epoch 1: valid_class_loss:0.059141	valid_position_loss:0.054356

Epoch 1: valid loss 0.2865655133944127 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.054356055362254845 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.231140  [   16/ 3543]

221 class loss: 0.051080 position_loss:0.043674

251 loss: 0.070125  [  496/ 3543]

251 class loss: 0.014999 position_loss:0.013275

281 loss: 0.629818  [  976/ 3543]

281 class loss: 0.154176 position_loss:0.118255

311 loss: 0.575030  [ 1456/ 3543]

311 class loss: 0.133910 position_loss:0.108310

341 loss: 0.441612  [ 1936/ 3543]

341 class loss: 0.085452 position_loss:0.084050

371 loss: 0.366322  [ 2416/ 3543]

371 class loss: 0.082720 position_loss:0.069128

401 loss: 0.213425  [ 2896/ 3543]

401 class loss: 0.047261 position_loss:0.040322

431 loss: 0.318709  [ 3376/ 3543]

431 class loss: 0.068011 position_loss:0.060341

Epoch 2: train loss: 0.420350

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.220861

Epoch 2: valid_class_loss:0.049539	valid_position_loss:0.041695

Epoch 2: valid loss 0.22086069764881078 smaller than best loss 0.2865655133944127
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.04169520554861924 smaller than best position loss 0.054356055362254845
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.486982  [   16/ 3543]

442 class loss: 0.111105 position_loss:0.091841

472 loss: 0.253642  [  496/ 3543]

472 class loss: 0.063933 position_loss:0.047532

502 loss: 0.370235  [  976/ 3543]

502 class loss: 0.081054 position_loss:0.069994

532 loss: 0.175322  [ 1456/ 3543]

532 class loss: 0.044236 position_loss:0.032853

562 loss: 0.376127  [ 1936/ 3543]

562 class loss: 0.111244 position_loss:0.069663

592 loss: 0.117031  [ 2416/ 3543]

592 class loss: 0.027661 position_loss:0.022023

622 loss: 0.230831  [ 2896/ 3543]

622 class loss: 0.075495 position_loss:0.042391

652 loss: 0.363311  [ 3376/ 3543]

652 class loss: 0.131415 position_loss:0.066091

Epoch 3: train loss: 0.266020

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.113546

Epoch 3: valid_class_loss:0.038209	valid_position_loss:0.020799

Epoch 3: valid loss 0.11354644566301335 smaller than best loss 0.22086069764881078
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.020798856097705785 smaller than best position loss 0.04169520554861924
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.209072  [   16/ 3543]

663 class loss: 0.081054 position_loss:0.037762

693 loss: 0.194784  [  496/ 3543]

693 class loss: 0.060580 position_loss:0.035928

723 loss: 0.165511  [  976/ 3543]

723 class loss: 0.077925 position_loss:0.029206

753 loss: 0.222999  [ 1456/ 3543]

753 class loss: 0.116842 position_loss:0.038758

783 loss: 0.042484  [ 1936/ 3543]

783 class loss: 0.023088 position_loss:0.007342

813 loss: 0.080995  [ 2416/ 3543]

813 class loss: 0.051406 position_loss:0.013629

843 loss: 0.174621  [ 2896/ 3543]

843 class loss: 0.103410 position_loss:0.029754

873 loss: 0.124538  [ 3376/ 3543]

873 class loss: 0.069544 position_loss:0.021430

Epoch 4: train loss: 0.135549

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.075990

Epoch 4: valid_class_loss:0.032359	valid_position_loss:0.013580

Epoch 4: valid loss 0.07599009090713035 smaller than best loss 0.11354644566301335
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013580046534313685 smaller than best position loss 0.020798856097705785
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.141561  [   16/ 3543]

884 class loss: 0.086825 position_loss:0.023971

914 loss: 0.063257  [  496/ 3543]

914 class loss: 0.046943 position_loss:0.010304

944 loss: 0.103557  [  976/ 3543]

944 class loss: 0.062820 position_loss:0.017570

974 loss: 0.054504  [ 1456/ 3543]

974 class loss: 0.035290 position_loss:0.009136

1004 loss: 0.050740  [ 1936/ 3543]

1004 class loss: 0.042370 position_loss:0.008029

1034 loss: 0.069716  [ 2416/ 3543]

1034 class loss: 0.024742 position_loss:0.012706

1064 loss: 0.115223  [ 2896/ 3543]

1064 class loss: 0.085390 position_loss:0.018775

1094 loss: 0.046853  [ 3376/ 3543]

1094 class loss: 0.035347 position_loss:0.007603

Epoch 5: train loss: 0.094094

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.059102

Epoch 5: valid_class_loss:0.030838	valid_position_loss:0.010279

Epoch 5: valid loss 0.05910244160806308 smaller than best loss 0.07599009090713035
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010278583394586234 smaller than best position loss 0.013580046534313685
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.062074  [   16/ 3543]

1105 class loss: 0.080253 position_loss:0.008402

1135 loss: 0.088018  [  496/ 3543]

1135 class loss: 0.055063 position_loss:0.014850

1165 loss: 0.030675  [  976/ 3543]

1165 class loss: 0.009194 position_loss:0.005675

1195 loss: 0.036533  [ 1456/ 3543]

1195 class loss: 0.030963 position_loss:0.005758

1225 loss: 0.049376  [ 1936/ 3543]

1225 class loss: 0.048643 position_loss:0.007443

1255 loss: 0.081899  [ 2416/ 3543]

1255 class loss: 0.074329 position_loss:0.012663

1285 loss: 0.099231  [ 2896/ 3543]

1285 class loss: 0.101892 position_loss:0.014752

1315 loss: 0.077077  [ 3376/ 3543]

1315 class loss: 0.067822 position_loss:0.012024

Epoch 6: train loss: 0.077762

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.048069

Epoch 6: valid_class_loss:0.029525	valid_position_loss:0.008138

Epoch 6: valid loss 0.048068879892562144 smaller than best loss 0.05910244160806308
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.008137519874682675 smaller than best position loss 0.010278583394586234
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.107540  [   16/ 3543]

1326 class loss: 0.093689 position_loss:0.016823

1356 loss: 0.096048  [  496/ 3543]

1356 class loss: 0.066473 position_loss:0.015886

1386 loss: 0.036462  [  976/ 3543]

1386 class loss: 0.037300 position_loss:0.005427

1416 loss: 0.051523  [ 1456/ 3543]

1416 class loss: 0.057015 position_loss:0.007454

1446 loss: 0.037736  [ 1936/ 3543]

1446 class loss: 0.041173 position_loss:0.005488

1476 loss: 0.023172  [ 2416/ 3543]

1476 class loss: 0.025151 position_loss:0.003377

1506 loss: 0.028313  [ 2896/ 3543]

1506 class loss: 0.033454 position_loss:0.003990

1536 loss: 0.049758  [ 3376/ 3543]

1536 class loss: 0.026564 position_loss:0.008623

Epoch 7: train loss: 0.061899

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.043475

Epoch 7: valid_class_loss:0.030491	valid_position_loss:0.007170

Epoch 7: valid loss 0.04347519077616811 smaller than best loss 0.048068879892562144
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.0071704965869165485 smaller than best position loss 0.008137519874682675
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.051006  [   16/ 3543]

1547 class loss: 0.039908 position_loss:0.008206

1577 loss: 0.032175  [  496/ 3543]

1577 class loss: 0.019057 position_loss:0.005482

1607 loss: 0.072777  [  976/ 3543]

1607 class loss: 0.053965 position_loss:0.011857

1637 loss: 0.067807  [ 1456/ 3543]

1637 class loss: 0.065334 position_loss:0.010295

1667 loss: 0.097947  [ 1936/ 3543]

1667 class loss: 0.084224 position_loss:0.015378

1697 loss: 0.053888  [ 2416/ 3543]

1697 class loss: 0.049364 position_loss:0.008309

1727 loss: 0.043672  [ 2896/ 3543]

1727 class loss: 0.041499 position_loss:0.006659

1757 loss: 0.079553  [ 3376/ 3543]

1757 class loss: 0.061700 position_loss:0.012826

Epoch 8: train loss: 0.047950

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.038176

Epoch 8: valid_class_loss:0.030148	valid_position_loss:0.006128

Epoch 8: valid loss 0.038176019611055344 smaller than best loss 0.04347519077616811
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006127790128734475 smaller than best position loss 0.0071704965869165485
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.042286  [   16/ 3543]

1768 class loss: 0.056452 position_loss:0.005635

1798 loss: 0.033810  [  496/ 3543]

1798 class loss: 0.017229 position_loss:0.005900

1828 loss: 0.072898  [  976/ 3543]

1828 class loss: 0.084306 position_loss:0.010364

1858 loss: 0.038078  [ 1456/ 3543]

1858 class loss: 0.050064 position_loss:0.005112

1888 loss: 0.045478  [ 1936/ 3543]

1888 class loss: 0.039261 position_loss:0.007133

1918 loss: 0.050049  [ 2416/ 3543]

1918 class loss: 0.054780 position_loss:0.007271

1948 loss: 0.035912  [ 2896/ 3543]

1948 class loss: 0.046802 position_loss:0.004842

1978 loss: 0.035640  [ 3376/ 3543]

1978 class loss: 0.020520 position_loss:0.006102

Epoch 9: train loss: 0.039615

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.030391

Epoch 9: valid_class_loss:0.026503	valid_position_loss:0.004753

Epoch 9: valid loss 0.03039119992717048 smaller than best loss 0.038176019611055344
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.0047531040364930804 smaller than best position loss 0.006127790128734475
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.015866  [   16/ 3543]

1989 class loss: 0.021609 position_loss:0.002093

2019 loss: 0.034769  [  496/ 3543]

2019 class loss: 0.041997 position_loss:0.004854

2049 loss: 0.058609  [  976/ 3543]

2049 class loss: 0.044366 position_loss:0.009503

2079 loss: 0.011636  [ 1456/ 3543]

2079 class loss: 0.019638 position_loss:0.001345

2109 loss: 0.039122  [ 1936/ 3543]

2109 class loss: 0.057631 position_loss:0.004943

2139 loss: 0.031206  [ 2416/ 3543]

2139 class loss: 0.036211 position_loss:0.004431

2169 loss: 0.028057  [ 2896/ 3543]

2169 class loss: 0.030958 position_loss:0.004063

2199 loss: 0.042429  [ 3376/ 3543]

2199 class loss: 0.030184 position_loss:0.006977

Epoch 10: train loss: 0.034553

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.028265

Epoch 10: valid_class_loss:0.026115	valid_position_loss:0.004347

Epoch 10: valid loss 0.028264877844413287 smaller than best loss 0.03039119992717048
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.0043472270426701655 smaller than best position loss 0.0047531040364930804
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.029320  [   16/ 3543]

2210 class loss: 0.021250 position_loss:0.004801

2240 loss: 0.042205  [  496/ 3543]

2240 class loss: 0.020208 position_loss:0.007431

2270 loss: 0.026454  [  976/ 3543]

2270 class loss: 0.039591 position_loss:0.003311

2300 loss: 0.012805  [ 1456/ 3543]

2300 class loss: 0.018066 position_loss:0.001658

2330 loss: 0.053947  [ 1936/ 3543]

2330 class loss: 0.058861 position_loss:0.007846

2360 loss: 0.054417  [ 2416/ 3543]

2360 class loss: 0.021536 position_loss:0.009807

2390 loss: 0.052782  [ 2896/ 3543]

2390 class loss: 0.053637 position_loss:0.007875

2420 loss: 0.022375  [ 3376/ 3543]

2420 class loss: 0.036326 position_loss:0.002659

Epoch 11: train loss: 0.030237

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.026165

Epoch 11: valid_class_loss:0.024497	valid_position_loss:0.004008

Epoch 11: valid loss 0.026164827803699102 smaller than best loss 0.028264877844413287
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.004008108084412792 smaller than best position loss 0.0043472270426701655
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.014396  [   16/ 3543]

2431 class loss: 0.012541 position_loss:0.002252

2461 loss: 0.005735  [  496/ 3543]

2461 class loss: 0.009585 position_loss:0.000668

2491 loss: 0.011735  [  976/ 3543]

2491 class loss: 0.014791 position_loss:0.001608

2521 loss: 0.030249  [ 1456/ 3543]

2521 class loss: 0.047299 position_loss:0.003685

2551 loss: 0.007756  [ 1936/ 3543]

2551 class loss: 0.011533 position_loss:0.000975

2581 loss: 0.019436  [ 2416/ 3543]

2581 class loss: 0.028359 position_loss:0.002469

2611 loss: 0.019328  [ 2896/ 3543]

2611 class loss: 0.018872 position_loss:0.002922

2641 loss: 0.017772  [ 3376/ 3543]

2641 class loss: 0.031566 position_loss:0.001976

Epoch 12: train loss: 0.027200

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.023265

Epoch 12: valid_class_loss:0.023005	valid_position_loss:0.003503

Epoch 12: valid loss 0.02326513346004203 smaller than best loss 0.026164827803699102
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0035027990264472598 smaller than best position loss 0.004008108084412792
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.023473  [   16/ 3543]

2652 class loss: 0.028489 position_loss:0.003270

2682 loss: 0.051715  [  496/ 3543]

2682 class loss: 0.071670 position_loss:0.006759

2712 loss: 0.006267  [  976/ 3543]

2712 class loss: 0.008968 position_loss:0.000805

2742 loss: 0.025995  [ 1456/ 3543]

2742 class loss: 0.038938 position_loss:0.003252

2772 loss: 0.010208  [ 1936/ 3543]

2772 class loss: 0.015539 position_loss:0.001265

2802 loss: 0.037045  [ 2416/ 3543]

2802 class loss: 0.019276 position_loss:0.006445

2832 loss: 0.017105  [ 2896/ 3543]

2832 class loss: 0.029178 position_loss:0.001962

2862 loss: 0.011733  [ 3376/ 3543]

2862 class loss: 0.022540 position_loss:0.001220

Epoch 13: train loss: 0.024361

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.022038

Epoch 13: valid_class_loss:0.021820	valid_position_loss:0.003317

Epoch 13: valid loss 0.022038306480503266 smaller than best loss 0.02326513346004203
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0033166712339551033 smaller than best position loss 0.0035027990264472598
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.025732  [   16/ 3543]

2873 class loss: 0.041210 position_loss:0.003086

2903 loss: 0.029075  [  496/ 3543]

2903 class loss: 0.040750 position_loss:0.003777

2933 loss: 0.017946  [  976/ 3543]

2933 class loss: 0.029580 position_loss:0.002110

2963 loss: 0.032237  [ 1456/ 3543]

2963 class loss: 0.044316 position_loss:0.004232

2993 loss: 0.022577  [ 1936/ 3543]

2993 class loss: 0.040713 position_loss:0.002480

3023 loss: 0.012258  [ 2416/ 3543]

3023 class loss: 0.019689 position_loss:0.001467

3053 loss: 0.018051  [ 2896/ 3543]

3053 class loss: 0.020073 position_loss:0.002607

3083 loss: 0.012757  [ 3376/ 3543]

3083 class loss: 0.017168 position_loss:0.001693

Epoch 14: train loss: 0.021863

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.021663

Epoch 14: valid_class_loss:0.020228	valid_position_loss:0.003321

Epoch 14: valid loss 0.021662504081565018 smaller than best loss 0.022038306480503266
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.050071  [   16/ 3543]

3094 class loss: 0.051145 position_loss:0.007457

3124 loss: 0.029452  [  496/ 3543]

3124 class loss: 0.022598 position_loss:0.004760

3154 loss: 0.012986  [  976/ 3543]

3154 class loss: 0.016749 position_loss:0.001760

3184 loss: 0.016761  [ 1456/ 3543]

3184 class loss: 0.022991 position_loss:0.002203

3214 loss: 0.004264  [ 1936/ 3543]

3214 class loss: 0.006846 position_loss:0.000510

3244 loss: 0.026629  [ 2416/ 3543]

3244 class loss: 0.017412 position_loss:0.004455

3274 loss: 0.027799  [ 2896/ 3543]

3274 class loss: 0.019016 position_loss:0.004609

3304 loss: 0.019438  [ 3376/ 3543]

3304 class loss: 0.022836 position_loss:0.002746

Epoch 15: train loss: 0.020335

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.019369

Epoch 15: valid_class_loss:0.020341	valid_position_loss:0.002857

Epoch 15: valid loss 0.019368708255834286 smaller than best loss 0.021662504081565018
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.002856673684918976 smaller than best position loss 0.0033166712339551033
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0614_1/2024-06-16__20-10-42/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.765952
Nucleus_export  0.634917
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.863781  0.130950  0.136219
Nucleus_export  0.782429  0.213827  0.217571
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.384615
Mitochondrion  0.368750
SIGNAL         0.870968
chloroplast    0.447368
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988202                 0.905555           0.822314   
ER                   0.950113                 0.637689           0.752349   
Peroxisome           0.625587                 0.340809           0.552334   
Mitochondrion        0.909233                 0.870859           0.812624   
Nucleus_export       0.973784                 0.509269           0.458596   
SIGNAL               0.965723                 0.979082           0.810060   
chloroplast          0.917246                 0.743631           0.663055   
Thylakoid            0.995338                 0.544307           0.588309   

                recall_score  precision_score  f1_score  
Nucleus             0.843750         0.843750  0.843750  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.787500         0.893617  0.837209  
Nucleus_export      0.600000         0.375000  0.461538  
SIGNAL              0.949309         0.908824  0.928625  
chloroplast         0.723684         0.654762  0.687500  
Thylakoid           0.900000         0.391304  0.545455  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.608828
Nucleus_export  0.344006
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.691248  0.142131  0.308752
Nucleus_export  0.439643  0.175833  0.560357
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.270440
SIGNAL         0.884735
chloroplast    0.410959
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980919                 0.885274           0.833448   
ER                   0.998390                 0.914301           0.878084   
Peroxisome           0.940392                 0.577094           0.731700   
Mitochondrion        0.880237                 0.845142           0.789037   
Nucleus_export       0.949806                 0.292123           0.346124   
SIGNAL               0.967061                 0.978415           0.828624   
chloroplast          0.966046                 0.793303           0.696723   
Thylakoid            0.993851                 0.434522           0.650895   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.823077  0.852590  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.538462         1.000000  0.700000  
Mitochondrion       0.735849         0.906977  0.812500  
Nucleus_export      0.480000         0.279070  0.352941  
SIGNAL              0.953271         0.916168  0.934351  
chloroplast         0.794521         0.651685  0.716049  
Thylakoid           1.000000         0.428571  0.600000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.590134
Nucleus_export  0.247016
===========================================

 TPR, FPR, FNR: 

                      0         1         2
Nucleus         0.67162  0.137918  0.212678
Nucleus_export  0.31250  0.120536  0.167500
===========================================

 cs acc: 

                      0
ER             0.961538
Peroxisome     0.857143
Mitochondrion  0.239316
SIGNAL         0.898693
chloroplast    0.448276
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980919                 0.885274           0.833448   
ER                   0.998390                 0.914301           0.878084   
Peroxisome           0.940392                 0.577094           0.731700   
Mitochondrion        0.880237                 0.845142           0.789037   
Nucleus_export       0.949806                 0.292123           0.346124   
SIGNAL               0.967061                 0.978415           0.828624   
chloroplast          0.966046                 0.793303           0.696723   
Thylakoid            0.993851                 0.434522           0.650895   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.823077  0.852590  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.538462         1.000000  0.700000  
Mitochondrion       0.735849         0.906977  0.812500  
Nucleus_export      0.480000         0.279070  0.352941  
SIGNAL              0.953271         0.916168  0.934351  
chloroplast         0.794521         0.651685  0.716049  
Thylakoid           1.000000         0.428571  0.600000  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927211
Nucleus_export  0.307276
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.078633  0.0
Nucleus_export  0.4  0.235560  0.6
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.2     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927211
Nucleus_export  0.307276
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.078633  0.0
Nucleus_export  0.4  0.224448  0.4
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
