use k-fold index: 0

Done Loading data

number of steps for training data: 419

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 419

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.469179  [   16/ 6708]

0 class loss: 0.045658 position_loss:0.092010

30 loss: 0.661613  [  496/ 6708]

30 class loss: 0.092780 position_loss:0.128611

60 loss: 0.758190  [  976/ 6708]

60 class loss: 0.093290 position_loss:0.147906

90 loss: 0.432598  [ 1456/ 6708]

90 class loss: 0.057617 position_loss:0.084215

120 loss: 0.398579  [ 1936/ 6708]

120 class loss: 0.075927 position_loss:0.076679

150 loss: 0.321819  [ 2416/ 6708]

150 class loss: 0.051895 position_loss:0.062288

180 loss: 0.127691  [ 2896/ 6708]

180 class loss: 0.022815 position_loss:0.024626

210 loss: 0.430135  [ 3376/ 6708]

210 class loss: 0.056323 position_loss:0.083774

240 loss: 0.593024  [ 3856/ 6708]

240 class loss: 0.085528 position_loss:0.115184

270 loss: 0.770064  [ 4336/ 6708]

270 class loss: 0.135209 position_loss:0.148605

300 loss: 0.710873  [ 4816/ 6708]

300 class loss: 0.155592 position_loss:0.135951

330 loss: 0.899745  [ 5296/ 6708]

330 class loss: 0.098342 position_loss:0.176015

360 loss: 1.241381  [ 5776/ 6708]

360 class loss: 0.152465 position_loss:0.242178

390 loss: 0.290061  [ 6256/ 6708]

390 class loss: 0.045436 position_loss:0.056195

Epoch 1: train loss: 0.473801

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.284579

Epoch 1: valid_class_loss:0.059276	valid_position_loss:0.054545

Epoch 1: valid loss 0.28457876724543 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05454472087636969 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

419 loss: 0.736947  [   16/ 6708]

419 class loss: 0.107646 position_loss:0.143083

449 loss: 0.292765  [  496/ 6708]

449 class loss: 0.065259 position_loss:0.055943

479 loss: 0.198764  [  976/ 6708]

479 class loss: 0.096086 position_loss:0.035909

509 loss: 0.664245  [ 1456/ 6708]

509 class loss: 0.063055 position_loss:0.130327

539 loss: 0.293080  [ 1936/ 6708]

539 class loss: 0.103309 position_loss:0.054484

569 loss: 0.390367  [ 2416/ 6708]

569 class loss: 0.052833 position_loss:0.075960

599 loss: 0.352785  [ 2896/ 6708]

599 class loss: 0.071173 position_loss:0.067710

629 loss: 0.443120  [ 3376/ 6708]

629 class loss: 0.071751 position_loss:0.085754

659 loss: 0.064793  [ 3856/ 6708]

659 class loss: 0.014991 position_loss:0.012359

689 loss: 0.240948  [ 4336/ 6708]

689 class loss: 0.056387 position_loss:0.045934

719 loss: 0.428899  [ 4816/ 6708]

719 class loss: 0.083303 position_loss:0.082448

749 loss: 0.086779  [ 5296/ 6708]

749 class loss: 0.031194 position_loss:0.016108

779 loss: 0.304352  [ 5776/ 6708]

779 class loss: 0.117699 position_loss:0.056163

809 loss: 0.055304  [ 6256/ 6708]

809 class loss: 0.020401 position_loss:0.010245

Epoch 2: train loss: 0.321404

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.098301

Epoch 2: valid_class_loss:0.036499	valid_position_loss:0.018200

Epoch 2: valid loss 0.0983014734188552 smaller than best loss 0.28457876724543
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.018200323011606085 smaller than best position loss 0.05454472087636969
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

838 loss: 0.095622  [   16/ 6708]

838 class loss: 0.027859 position_loss:0.018010

868 loss: 0.081518  [  496/ 6708]

868 class loss: 0.023894 position_loss:0.015348

898 loss: 0.263349  [  976/ 6708]

898 class loss: 0.023730 position_loss:0.051721

928 loss: 0.066237  [ 1456/ 6708]

928 class loss: 0.033951 position_loss:0.011889

958 loss: 0.055421  [ 1936/ 6708]

958 class loss: 0.030845 position_loss:0.009850

988 loss: 0.141209  [ 2416/ 6708]

988 class loss: 0.070599 position_loss:0.025418

1018 loss: 0.134053  [ 2896/ 6708]

1018 class loss: 0.039646 position_loss:0.025225

1048 loss: 0.087918  [ 3376/ 6708]

1048 class loss: 0.036236 position_loss:0.016134

1078 loss: 0.166149  [ 3856/ 6708]

1078 class loss: 0.029444 position_loss:0.032052

1108 loss: 0.110764  [ 4336/ 6708]

1108 class loss: 0.069093 position_loss:0.019389

1138 loss: 0.190333  [ 4816/ 6708]

1138 class loss: 0.066075 position_loss:0.035424

1168 loss: 0.132184  [ 5296/ 6708]

1168 class loss: 0.064913 position_loss:0.023840

1198 loss: 0.088258  [ 5776/ 6708]

1198 class loss: 0.031011 position_loss:0.016411

1228 loss: 0.082580  [ 6256/ 6708]

1228 class loss: 0.025819 position_loss:0.015483

Epoch 3: train loss: 0.103501

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.058928

Epoch 3: valid_class_loss:0.031879	valid_position_loss:0.010511

Epoch 3: valid loss 0.058928321842406865 smaller than best loss 0.0983014734188552
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.010510508302501428 smaller than best position loss 0.018200323011606085
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

1257 loss: 0.069103  [   16/ 6708]

1257 class loss: 0.084557 position_loss:0.010438

1287 loss: 0.056617  [  496/ 6708]

1287 class loss: 0.018501 position_loss:0.010583

1317 loss: 0.050440  [  976/ 6708]

1317 class loss: 0.038836 position_loss:0.008535

1347 loss: 0.032316  [ 1456/ 6708]

1347 class loss: 0.017901 position_loss:0.005747

1377 loss: 0.047014  [ 1936/ 6708]

1377 class loss: 0.042267 position_loss:0.007712

1407 loss: 0.049543  [ 2416/ 6708]

1407 class loss: 0.039690 position_loss:0.008321

1437 loss: 0.109057  [ 2896/ 6708]

1437 class loss: 0.049368 position_loss:0.019837

1467 loss: 0.228747  [ 3376/ 6708]

1467 class loss: 0.086875 position_loss:0.042274

1497 loss: 0.066420  [ 3856/ 6708]

1497 class loss: 0.052231 position_loss:0.011195

1527 loss: 0.036745  [ 4336/ 6708]

1527 class loss: 0.023970 position_loss:0.006390

1557 loss: 0.071304  [ 4816/ 6708]

1557 class loss: 0.036514 position_loss:0.012800

1587 loss: 0.006007  [ 5296/ 6708]

1587 class loss: 0.010005 position_loss:0.000801

1617 loss: 0.011476  [ 5776/ 6708]

1617 class loss: 0.020814 position_loss:0.001463

1647 loss: 0.051965  [ 6256/ 6708]

1647 class loss: 0.060600 position_loss:0.007969

Epoch 4: train loss: 0.070270

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.042758

Epoch 4: valid_class_loss:0.028724	valid_position_loss:0.007403

Epoch 4: valid loss 0.042757765979150895 smaller than best loss 0.058928321842406865
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.007402589650941057 smaller than best position loss 0.010510508302501428
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

1676 loss: 0.097519  [   16/ 6708]

1676 class loss: 0.085633 position_loss:0.016078

1706 loss: 0.079873  [  496/ 6708]

1706 class loss: 0.057813 position_loss:0.013662

1736 loss: 0.008408  [  976/ 6708]

1736 class loss: 0.017491 position_loss:0.000982

1766 loss: 0.024938  [ 1456/ 6708]

1766 class loss: 0.036339 position_loss:0.003534

1796 loss: 0.042709  [ 1936/ 6708]

1796 class loss: 0.043813 position_loss:0.006789

1826 loss: 0.069369  [ 2416/ 6708]

1826 class loss: 0.025172 position_loss:0.012867

1856 loss: 0.052665  [ 2896/ 6708]

1856 class loss: 0.043343 position_loss:0.008799

1886 loss: 0.077352  [ 3376/ 6708]

1886 class loss: 0.039777 position_loss:0.013879

1916 loss: 0.059008  [ 3856/ 6708]

1916 class loss: 0.038570 position_loss:0.010259

1946 loss: 0.021319  [ 4336/ 6708]

1946 class loss: 0.046048 position_loss:0.002422

1976 loss: 0.041673  [ 4816/ 6708]

1976 class loss: 0.045066 position_loss:0.006532

2006 loss: 0.087913  [ 5296/ 6708]

2006 class loss: 0.031784 position_loss:0.016311

2036 loss: 0.086205  [ 5776/ 6708]

2036 class loss: 0.044662 position_loss:0.015454

2066 loss: 0.028502  [ 6256/ 6708]

2066 class loss: 0.037622 position_loss:0.004196

Epoch 5: train loss: 0.048086

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.031990

Epoch 5: valid_class_loss:0.028052	valid_position_loss:0.005276

Epoch 5: valid loss 0.03199048051694479 smaller than best loss 0.042757765979150895
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.005276026737250159 smaller than best position loss 0.007402589650941057
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

2095 loss: 0.011906  [   16/ 6708]

2095 class loss: 0.014041 position_loss:0.001820

2125 loss: 0.022878  [  496/ 6708]

2125 class loss: 0.031564 position_loss:0.003313

2155 loss: 0.024924  [  976/ 6708]

2155 class loss: 0.029814 position_loss:0.003792

2185 loss: 0.043197  [ 1456/ 6708]

2185 class loss: 0.043544 position_loss:0.006898

2215 loss: 0.004035  [ 1936/ 6708]

2215 class loss: 0.009017 position_loss:0.000446

2245 loss: 0.051187  [ 2416/ 6708]

2245 class loss: 0.048182 position_loss:0.008310

2275 loss: 0.058191  [ 2896/ 6708]

2275 class loss: 0.041560 position_loss:0.009976

2305 loss: 0.038097  [ 3376/ 6708]

2305 class loss: 0.023486 position_loss:0.006680

2335 loss: 0.043404  [ 3856/ 6708]

2335 class loss: 0.051768 position_loss:0.006610

2365 loss: 0.044295  [ 4336/ 6708]

2365 class loss: 0.054528 position_loss:0.006678

2395 loss: 0.008367  [ 4816/ 6708]

2395 class loss: 0.012223 position_loss:0.001184

2425 loss: 0.056801  [ 5296/ 6708]

2425 class loss: 0.059673 position_loss:0.008973

2455 loss: 0.013553  [ 5776/ 6708]

2455 class loss: 0.020073 position_loss:0.001908

2485 loss: 0.021812  [ 6256/ 6708]

2485 class loss: 0.037207 position_loss:0.002874

Epoch 6: train loss: 0.035242

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.025361

Epoch 6: valid_class_loss:0.025560	valid_position_loss:0.004050

Epoch 6: valid loss 0.02536117878945835 smaller than best loss 0.03199048051694479
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.0040498174436363965 smaller than best position loss 0.005276026737250159
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

2514 loss: 0.046111  [   16/ 6708]

2514 class loss: 0.051218 position_loss:0.007173

2544 loss: 0.034105  [  496/ 6708]

2544 class loss: 0.013359 position_loss:0.006287

2574 loss: 0.043379  [  976/ 6708]

2574 class loss: 0.039250 position_loss:0.007106

2604 loss: 0.027987  [ 1456/ 6708]

2604 class loss: 0.045354 position_loss:0.003783

2634 loss: 0.017661  [ 1936/ 6708]

2634 class loss: 0.011932 position_loss:0.003055

2664 loss: 0.054935  [ 2416/ 6708]

2664 class loss: 0.053494 position_loss:0.008847

2694 loss: 0.015501  [ 2896/ 6708]

2694 class loss: 0.016349 position_loss:0.002446

2724 loss: 0.039827  [ 3376/ 6708]

2724 class loss: 0.055813 position_loss:0.005733

2754 loss: 0.035071  [ 3856/ 6708]

2754 class loss: 0.033975 position_loss:0.005655

2784 loss: 0.035707  [ 4336/ 6708]

2784 class loss: 0.020997 position_loss:0.006302

2814 loss: 0.030151  [ 4816/ 6708]

2814 class loss: 0.019314 position_loss:0.005258

2844 loss: 0.033087  [ 5296/ 6708]

2844 class loss: 0.039908 position_loss:0.005021

2874 loss: 0.012562  [ 5776/ 6708]

2874 class loss: 0.021611 position_loss:0.001648

2904 loss: 0.051274  [ 6256/ 6708]

2904 class loss: 0.040251 position_loss:0.008645

Epoch 7: train loss: 0.028565

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.022428

Epoch 7: valid_class_loss:0.022771	valid_position_loss:0.003575

Epoch 7: valid loss 0.022427535242331088 smaller than best loss 0.02536117878945835
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.0035746657728192507 smaller than best position loss 0.0040498174436363965
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

2933 loss: 0.022707  [   16/ 6708]

2933 class loss: 0.036557 position_loss:0.003079

2963 loss: 0.053090  [  496/ 6708]

2963 class loss: 0.029938 position_loss:0.009420

2993 loss: 0.012599  [  976/ 6708]

2993 class loss: 0.013343 position_loss:0.001986

3023 loss: 0.031471  [ 1456/ 6708]

3023 class loss: 0.030684 position_loss:0.005067

3053 loss: 0.012550  [ 1936/ 6708]

3053 class loss: 0.022262 position_loss:0.001620

3083 loss: 0.007979  [ 2416/ 6708]

3083 class loss: 0.014581 position_loss:0.001013

3113 loss: 0.010815  [ 2896/ 6708]

3113 class loss: 0.016426 position_loss:0.001506

3143 loss: 0.026900  [ 3376/ 6708]

3143 class loss: 0.020281 position_loss:0.004569

3173 loss: 0.020759  [ 3856/ 6708]

3173 class loss: 0.026189 position_loss:0.003104

3203 loss: 0.025342  [ 4336/ 6708]

3203 class loss: 0.010239 position_loss:0.004659

3233 loss: 0.019324  [ 4816/ 6708]

3233 class loss: 0.025109 position_loss:0.002860

3263 loss: 0.029370  [ 5296/ 6708]

3263 class loss: 0.044409 position_loss:0.004098

3293 loss: 0.014481  [ 5776/ 6708]

3293 class loss: 0.026412 position_loss:0.001840

3323 loss: 0.024805  [ 6256/ 6708]

3323 class loss: 0.035346 position_loss:0.003547

Epoch 8: train loss: 0.023388

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.020477

Epoch 8: valid_class_loss:0.021249	valid_position_loss:0.003245

Epoch 8: valid loss 0.02047698165626565 smaller than best loss 0.022427535242331088
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.0032454391390047896 smaller than best position loss 0.0035746657728192507
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

3352 loss: 0.029482  [   16/ 6708]

3352 class loss: 0.022875 position_loss:0.004981

3382 loss: 0.023278  [  496/ 6708]

3382 class loss: 0.022498 position_loss:0.003756

3412 loss: 0.035785  [  976/ 6708]

3412 class loss: 0.050925 position_loss:0.005120

3442 loss: 0.070040  [ 1456/ 6708]

3442 class loss: 0.046195 position_loss:0.012160

3472 loss: 0.010867  [ 1936/ 6708]

3472 class loss: 0.019591 position_loss:0.001390

3502 loss: 0.009626  [ 2416/ 6708]

3502 class loss: 0.016472 position_loss:0.001266

3532 loss: 0.023130  [ 2896/ 6708]

3532 class loss: 0.025572 position_loss:0.003603

3562 loss: 0.016118  [ 3376/ 6708]

3562 class loss: 0.027986 position_loss:0.002104

3592 loss: 0.007263  [ 3856/ 6708]

3592 class loss: 0.011232 position_loss:0.001003

3622 loss: 0.033641  [ 4336/ 6708]

3622 class loss: 0.031935 position_loss:0.005451

3652 loss: 0.029468  [ 4816/ 6708]

3652 class loss: 0.033235 position_loss:0.004564

3682 loss: 0.014369  [ 5296/ 6708]

3682 class loss: 0.024827 position_loss:0.001881

3712 loss: 0.005544  [ 5776/ 6708]

3712 class loss: 0.007164 position_loss:0.000822

3742 loss: 0.019110  [ 6256/ 6708]

3742 class loss: 0.012535 position_loss:0.003321

Epoch 9: train loss: 0.019601

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.019774

Epoch 9: valid_class_loss:0.019670	valid_position_loss:0.003168

Epoch 9: valid loss 0.019773975595305363 smaller than best loss 0.02047698165626565
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.0031679778328285234 smaller than best position loss 0.0032454391390047896
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

3771 loss: 0.015553  [   16/ 6708]

3771 class loss: 0.017515 position_loss:0.002410

3801 loss: 0.011851  [  496/ 6708]

3801 class loss: 0.018784 position_loss:0.001619

3831 loss: 0.022754  [  976/ 6708]

3831 class loss: 0.008326 position_loss:0.004218

3861 loss: 0.030717  [ 1456/ 6708]

3861 class loss: 0.041572 position_loss:0.004480

3891 loss: 0.007289  [ 1936/ 6708]

3891 class loss: 0.017766 position_loss:0.000747

3921 loss: 0.011400  [ 2416/ 6708]

3921 class loss: 0.028012 position_loss:0.001159

3951 loss: 0.023001  [ 2896/ 6708]

3951 class loss: 0.030124 position_loss:0.003395

3981 loss: 0.011225  [ 3376/ 6708]

3981 class loss: 0.016835 position_loss:0.001572

4011 loss: 0.012549  [ 3856/ 6708]

4011 class loss: 0.024975 position_loss:0.001511

4041 loss: 0.004831  [ 4336/ 6708]

4041 class loss: 0.017085 position_loss:0.000283

4071 loss: 0.005985  [ 4816/ 6708]

4071 class loss: 0.020742 position_loss:0.000367

4101 loss: 0.003882  [ 5296/ 6708]

4101 class loss: 0.010245 position_loss:0.000367

4131 loss: 0.003023  [ 5776/ 6708]

4131 class loss: 0.009158 position_loss:0.000238

4161 loss: 0.009426  [ 6256/ 6708]

4161 class loss: 0.018378 position_loss:0.001150

Epoch 10: train loss: 0.017218

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.018996

Epoch 10: valid_class_loss:0.018886	valid_position_loss:0.003044

Epoch 10: valid loss 0.018996162927730632 smaller than best loss 0.019773975595305363
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.003043793255331687 smaller than best position loss 0.0031679778328285234
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

4190 loss: 0.031172  [   16/ 6708]

4190 class loss: 0.036622 position_loss:0.004770

4220 loss: 0.014625  [  496/ 6708]

4220 class loss: 0.022960 position_loss:0.002007

4250 loss: 0.019378  [  976/ 6708]

4250 class loss: 0.022904 position_loss:0.002959

4280 loss: 0.008971  [ 1456/ 6708]

4280 class loss: 0.027797 position_loss:0.000682

4310 loss: 0.006700  [ 1936/ 6708]

4310 class loss: 0.013924 position_loss:0.000783

4340 loss: 0.017939  [ 2416/ 6708]

4340 class loss: 0.021711 position_loss:0.002719

4370 loss: 0.009942  [ 2896/ 6708]

4370 class loss: 0.027046 position_loss:0.000907

4400 loss: 0.003722  [ 3376/ 6708]

4400 class loss: 0.008123 position_loss:0.000420

4430 loss: 0.004565  [ 3856/ 6708]

4430 class loss: 0.009335 position_loss:0.000540

4460 loss: 0.014866  [ 4336/ 6708]

4460 class loss: 0.016521 position_loss:0.002312

4490 loss: 0.048932  [ 4816/ 6708]

4490 class loss: 0.023399 position_loss:0.008850

4520 loss: 0.003844  [ 5296/ 6708]

4520 class loss: 0.016050 position_loss:0.000127

4550 loss: 0.067498  [ 5776/ 6708]

4550 class loss: 0.044070 position_loss:0.011737

4580 loss: 0.006447  [ 6256/ 6708]

4580 class loss: 0.011863 position_loss:0.000815

Epoch 11: train loss: 0.015025

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.018380

Epoch 11: valid_class_loss:0.017557	valid_position_loss:0.002974

Epoch 11: valid loss 0.018379801777457468 smaller than best loss 0.018996162927730632
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0029736796299760435 smaller than best position loss 0.003043793255331687
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

4609 loss: 0.005168  [   16/ 6708]

4609 class loss: 0.012762 position_loss:0.000523

4639 loss: 0.007769  [  496/ 6708]

4639 class loss: 0.011057 position_loss:0.001112

4669 loss: 0.005641  [  976/ 6708]

4669 class loss: 0.009695 position_loss:0.000740

4699 loss: 0.071599  [ 1456/ 6708]

4699 class loss: 0.027181 position_loss:0.013233

4729 loss: 0.015845  [ 1936/ 6708]

4729 class loss: 0.026616 position_loss:0.002104

4759 loss: 0.022599  [ 2416/ 6708]

4759 class loss: 0.011991 position_loss:0.004040

4789 loss: 0.015964  [ 2896/ 6708]

4789 class loss: 0.014820 position_loss:0.002600

4819 loss: 0.002432  [ 3376/ 6708]

4819 class loss: 0.004904 position_loss:0.000290

4849 loss: 0.025330  [ 3856/ 6708]

4849 class loss: 0.029945 position_loss:0.003868

4879 loss: 0.013235  [ 4336/ 6708]

4879 class loss: 0.018901 position_loss:0.001891

4909 loss: 0.003975  [ 4816/ 6708]

4909 class loss: 0.007350 position_loss:0.000501

4939 loss: 0.021286  [ 5296/ 6708]

4939 class loss: 0.021216 position_loss:0.003409

4969 loss: 0.010950  [ 5776/ 6708]

4969 class loss: 0.013755 position_loss:0.001640

4999 loss: 0.013073  [ 6256/ 6708]

4999 class loss: 0.017832 position_loss:0.001901

Epoch 12: train loss: 0.013798

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.017970

Epoch 12: valid_class_loss:0.016715	valid_position_loss:0.002925

Epoch 12: valid loss 0.017970065317518547 smaller than best loss 0.018379801777457468
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0029254292245408146 smaller than best position loss 0.0029736796299760435
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

5028 loss: 0.007983  [   16/ 6708]

5028 class loss: 0.013572 position_loss:0.001054

5058 loss: 0.009679  [  496/ 6708]

5058 class loss: 0.019590 position_loss:0.001152

5088 loss: 0.005215  [  976/ 6708]

5088 class loss: 0.007864 position_loss:0.000728

5118 loss: 0.011452  [ 1456/ 6708]

5118 class loss: 0.014202 position_loss:0.001722

5148 loss: 0.012017  [ 1936/ 6708]

5148 class loss: 0.027531 position_loss:0.001302

5178 loss: 0.009844  [ 2416/ 6708]

5178 class loss: 0.011300 position_loss:0.001517

5208 loss: 0.010962  [ 2896/ 6708]

5208 class loss: 0.020791 position_loss:0.001361

5238 loss: 0.003530  [ 3376/ 6708]

5238 class loss: 0.007932 position_loss:0.000389

5268 loss: 0.004111  [ 3856/ 6708]

5268 class loss: 0.009713 position_loss:0.000434

5298 loss: 0.018484  [ 4336/ 6708]

5298 class loss: 0.035464 position_loss:0.002278

5328 loss: 0.010743  [ 4816/ 6708]

5328 class loss: 0.016146 position_loss:0.001503

5358 loss: 0.056422  [ 5296/ 6708]

5358 class loss: 0.037072 position_loss:0.009801

5388 loss: 0.037620  [ 5776/ 6708]

5388 class loss: 0.018785 position_loss:0.006773

5418 loss: 0.014075  [ 6256/ 6708]

5418 class loss: 0.011216 position_loss:0.002366

Epoch 13: train loss: 0.012233

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.020150

Epoch 13: valid_class_loss:0.015900	valid_position_loss:0.003394

Fold 0 Epoch 14 train...
-------------------------------

5447 loss: 0.023006  [   16/ 6708]

5447 class loss: 0.016107 position_loss:0.003957

5477 loss: 0.008031  [  496/ 6708]

5477 class loss: 0.014127 position_loss:0.001041

5507 loss: 0.017542  [  976/ 6708]

5507 class loss: 0.035264 position_loss:0.002098

5537 loss: 0.009770  [ 1456/ 6708]

5537 class loss: 0.022716 position_loss:0.001045

5567 loss: 0.013763  [ 1936/ 6708]

5567 class loss: 0.018591 position_loss:0.002009

5597 loss: 0.015737  [ 2416/ 6708]

5597 class loss: 0.030590 position_loss:0.001924

5627 loss: 0.004690  [ 2896/ 6708]

5627 class loss: 0.012445 position_loss:0.000440

5657 loss: 0.005919  [ 3376/ 6708]

5657 class loss: 0.010316 position_loss:0.000771

5687 loss: 0.006156  [ 3856/ 6708]

5687 class loss: 0.013803 position_loss:0.000679

5717 loss: 0.008280  [ 4336/ 6708]

5717 class loss: 0.011729 position_loss:0.001187

5747 loss: 0.014158  [ 4816/ 6708]

5747 class loss: 0.015642 position_loss:0.002206

5777 loss: 0.002458  [ 5296/ 6708]

5777 class loss: 0.004404 position_loss:0.000315

5807 loss: 0.004593  [ 5776/ 6708]

5807 class loss: 0.007004 position_loss:0.000638

5837 loss: 0.013268  [ 6256/ 6708]

5837 class loss: 0.016148 position_loss:0.002008

Epoch 14: train loss: 0.010928

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.018825

Epoch 14: valid_class_loss:0.015472	valid_position_loss:0.003146

Fold 0 Epoch 15 train...
-------------------------------

5866 loss: 0.005801  [   16/ 6708]

5866 class loss: 0.012076 position_loss:0.000677

5896 loss: 0.007560  [  496/ 6708]

5896 class loss: 0.009451 position_loss:0.001134

5926 loss: 0.010486  [  976/ 6708]

5926 class loss: 0.019953 position_loss:0.001299

5956 loss: 0.012455  [ 1456/ 6708]

5956 class loss: 0.005797 position_loss:0.002259

5986 loss: 0.008986  [ 1936/ 6708]

5986 class loss: 0.021164 position_loss:0.000951

6016 loss: 0.006820  [ 2416/ 6708]

6016 class loss: 0.012487 position_loss:0.000864

6046 loss: 0.009418  [ 2896/ 6708]

6046 class loss: 0.005635 position_loss:0.001658

6076 loss: 0.003742  [ 3376/ 6708]

6076 class loss: 0.007112 position_loss:0.000464

6106 loss: 0.008935  [ 3856/ 6708]

6106 class loss: 0.007541 position_loss:0.001485

6136 loss: 0.010601  [ 4336/ 6708]

6136 class loss: 0.017800 position_loss:0.001408

6166 loss: 0.002659  [ 4816/ 6708]

6166 class loss: 0.007323 position_loss:0.000239

6196 loss: 0.002615  [ 5296/ 6708]

6196 class loss: 0.004934 position_loss:0.000326

6226 loss: 0.018161  [ 5776/ 6708]

6226 class loss: 0.039053 position_loss:0.002070

6256 loss: 0.006114  [ 6256/ 6708]

6256 class loss: 0.004657 position_loss:0.001036

Epoch 15: train loss: 0.010347

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.018993

Epoch 15: valid_class_loss:0.015385	valid_position_loss:0.003183

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0625/2024-06-26__12-06-50/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.764474
Nucleus_export  0.554962
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.896389  0.182779  0.103611
Nucleus_export  0.640610  0.124417  0.359390
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.384615
Mitochondrion  0.368750
SIGNAL         0.872504
chloroplast    0.342105
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988386                 0.911585           0.838932   
ER                   0.935370                 0.620316           0.762677   
Peroxisome           0.724237                 0.347479           0.552334   
Mitochondrion        0.948314                 0.911584           0.874694   
Nucleus_export       0.968880                 0.541789           0.561425   
SIGNAL               0.977951                 0.986361           0.881455   
chloroplast          0.955797                 0.869760           0.820014   
Thylakoid            0.995814                 0.588546           0.686721   

                recall_score  precision_score  f1_score  
Nucleus             0.812500         0.904348  0.855967  
ER                  0.866667         0.684211  0.764706  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.837500         0.950355  0.890365  
Nucleus_export      0.560000         0.583333  0.571429  
SIGNAL              0.946237         0.960998  0.953560  
chloroplast         0.763158         0.906250  0.828571  
Thylakoid           0.900000         0.529412  0.666667  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.636810
Nucleus_export  0.168012
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.753471  0.192668  0.246529
Nucleus_export  0.193342  0.073708  0.806658
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.238994
SIGNAL         0.884735
chloroplast    0.301370
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.984186                 0.892652           0.833448   
ER                   0.998625                 0.917601           0.853835   
Peroxisome           0.974433                 0.599753           0.683551   
Mitochondrion        0.925733                 0.914391           0.881644   
Nucleus_export       0.861550                 0.297500           0.326186   
SIGNAL               0.980573                 0.988039           0.904976   
chloroplast          0.984742                 0.884625           0.896996   
Thylakoid            0.994593                 0.467172           0.607456   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.823077  0.852590  
ER                  0.827586         0.888889  0.857143  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.823899         0.977612  0.894198  
Nucleus_export      0.320000         0.363636  0.340426  
SIGNAL              0.959502         0.965517  0.962500  
chloroplast         0.904110         0.904110  0.904110  
Thylakoid           0.888889         0.421053  0.571429  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.610671
Nucleus_export  0.086627
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.723418  0.182700  0.160879
Nucleus_export  0.104868  0.047111  0.215132
===========================================

 cs acc: 

                      0
ER             0.958333
Peroxisome     0.857143
Mitochondrion  0.267176
SIGNAL         0.894481
chloroplast    0.318182
Thylakoid      0.750000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.984186                 0.892652           0.833448   
ER                   0.998625                 0.917601           0.853835   
Peroxisome           0.974433                 0.599753           0.683551   
Mitochondrion        0.925733                 0.914391           0.881644   
Nucleus_export       0.861550                 0.297500           0.326186   
SIGNAL               0.980573                 0.988039           0.904976   
chloroplast          0.984742                 0.884625           0.896996   
Thylakoid            0.994593                 0.467172           0.607456   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.823077  0.852590  
ER                  0.827586         0.888889  0.857143  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.823899         0.977612  0.894198  
Nucleus_export      0.320000         0.363636  0.340426  
SIGNAL              0.959502         0.965517  0.962500  
chloroplast         0.904110         0.904110  0.904110  
Thylakoid           0.888889         0.421053  0.571429  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.889486
Nucleus_export  0.140809
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.125647  0.0
Nucleus_export  0.2  0.139396  0.8
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.2             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.889486
Nucleus_export  0.140809
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.125647  0.0
Nucleus_export  0.2  0.127005  0.4
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
