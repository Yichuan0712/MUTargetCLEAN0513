use k-fold index: 0

Done Loading data

number of steps for training data: 202

number of steps for valid data: 56

number of steps for test data: 58

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 202

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.841871  [   16/ 3239]

0 class loss: 0.175549 position_loss:0.161352

30 loss: 0.672515  [  496/ 3239]

30 class loss: 0.140033 position_loss:0.128902

60 loss: 0.487769  [  976/ 3239]

60 class loss: 0.104566 position_loss:0.093371

90 loss: 0.695422  [ 1456/ 3239]

90 class loss: 0.160710 position_loss:0.132656

120 loss: 0.860773  [ 1936/ 3239]

120 class loss: 0.185666 position_loss:0.164728

150 loss: 0.743189  [ 2416/ 3239]

150 class loss: 0.176609 position_loss:0.141573

180 loss: 0.961506  [ 2896/ 3239]

180 class loss: 0.204421 position_loss:0.184124

Epoch 1: train loss: 0.598540

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 1: valid loss:0.341551

Epoch 1: valid_class_loss:0.070670	valid_position_loss:0.065483

Epoch 1: valid loss 0.34155117189649475 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.065483429981121 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

202 loss: 0.523635  [   16/ 3239]

202 class loss: 0.111730 position_loss:0.100258

232 loss: 0.413187  [  496/ 3239]

232 class loss: 0.095171 position_loss:0.078831

262 loss: 0.391711  [  976/ 3239]

262 class loss: 0.082394 position_loss:0.075046

292 loss: 0.735223  [ 1456/ 3239]

292 class loss: 0.160887 position_loss:0.140609

322 loss: 0.530973  [ 1936/ 3239]

322 class loss: 0.142310 position_loss:0.100502

352 loss: 0.385448  [ 2416/ 3239]

352 class loss: 0.071011 position_loss:0.074249

382 loss: 0.520269  [ 2896/ 3239]

382 class loss: 0.141499 position_loss:0.098394

Epoch 2: train loss: 0.535777

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 2: valid loss:0.284548

Epoch 2: valid_class_loss:0.062772	valid_position_loss:0.054399

Epoch 2: valid loss 0.28454843348453474 smaller than best loss 0.34155117189649475
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.054398821753862694 smaller than best position loss 0.065483429981121
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

404 loss: 0.196624  [   16/ 3239]

404 class loss: 0.043040 position_loss:0.037603

434 loss: 0.105808  [  496/ 3239]

434 class loss: 0.024884 position_loss:0.020166

464 loss: 0.233182  [  976/ 3239]

464 class loss: 0.055471 position_loss:0.044418

494 loss: 0.438401  [ 1456/ 3239]

494 class loss: 0.105121 position_loss:0.083475

524 loss: 0.757166  [ 1936/ 3239]

524 class loss: 0.219098 position_loss:0.142669

554 loss: 0.406024  [ 2416/ 3239]

554 class loss: 0.125493 position_loss:0.076185

584 loss: 0.376593  [ 2896/ 3239]

584 class loss: 0.120219 position_loss:0.070510

Epoch 3: train loss: 0.362840

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 3: valid loss:0.157281

Epoch 3: valid_class_loss:0.047961	valid_position_loss:0.029538

Epoch 3: valid loss 0.1572808235713652 smaller than best loss 0.28454843348453474
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.029537721852807692 smaller than best position loss 0.054398821753862694
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

606 loss: 0.213621  [   16/ 3239]

606 class loss: 0.067430 position_loss:0.040027

636 loss: 0.130702  [  496/ 3239]

636 class loss: 0.041015 position_loss:0.024500

666 loss: 0.102542  [  976/ 3239]

666 class loss: 0.044118 position_loss:0.018744

696 loss: 0.216869  [ 1456/ 3239]

696 class loss: 0.068117 position_loss:0.040649

726 loss: 0.216328  [ 1936/ 3239]

726 class loss: 0.124508 position_loss:0.038285

756 loss: 0.204415  [ 2416/ 3239]

756 class loss: 0.096029 position_loss:0.037042

786 loss: 0.274268  [ 2896/ 3239]

786 class loss: 0.170618 position_loss:0.048029

Epoch 4: train loss: 0.194242

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 4: valid loss:0.091580

Epoch 4: valid_class_loss:0.039592	valid_position_loss:0.016732

Epoch 4: valid loss 0.09157980794504636 smaller than best loss 0.1572808235713652
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.01673226498237229 smaller than best position loss 0.029537721852807692
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

808 loss: 0.072291  [   16/ 3239]

808 class loss: 0.025459 position_loss:0.013440

838 loss: 0.210642  [  496/ 3239]

838 class loss: 0.105443 position_loss:0.037911

868 loss: 0.089419  [  976/ 3239]

868 class loss: 0.054718 position_loss:0.015695

898 loss: 0.107212  [ 1456/ 3239]

898 class loss: 0.071927 position_loss:0.018565

928 loss: 0.132071  [ 1936/ 3239]

928 class loss: 0.030207 position_loss:0.025206

958 loss: 0.168091  [ 2416/ 3239]

958 class loss: 0.094272 position_loss:0.029847

988 loss: 0.166710  [ 2896/ 3239]

988 class loss: 0.102955 position_loss:0.029224

Epoch 5: train loss: 0.126791

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 5: valid loss:0.073492

Epoch 5: valid_class_loss:0.037699	valid_position_loss:0.013190

Epoch 5: valid loss 0.07349192696126647 smaller than best loss 0.09157980794504636
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.013190420701899321 smaller than best position loss 0.01673226498237229
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1010 loss: 0.068783  [   16/ 3239]

1010 class loss: 0.062859 position_loss:0.011242

1040 loss: 0.203529  [  496/ 3239]

1040 class loss: 0.058363 position_loss:0.038371

1070 loss: 0.067997  [  976/ 3239]

1070 class loss: 0.068434 position_loss:0.010862

1100 loss: 0.120784  [ 1456/ 3239]

1100 class loss: 0.068622 position_loss:0.021412

1130 loss: 0.141997  [ 1936/ 3239]

1130 class loss: 0.081877 position_loss:0.025124

1160 loss: 0.105838  [ 2416/ 3239]

1160 class loss: 0.057166 position_loss:0.018881

1190 loss: 0.072455  [ 2896/ 3239]

1190 class loss: 0.043959 position_loss:0.012733

Epoch 6: train loss: 0.104702

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 6: valid loss:0.058774

Epoch 6: valid_class_loss:0.036380	valid_position_loss:0.010300

Epoch 6: valid loss 0.058774078894203795 smaller than best loss 0.07349192696126647
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.010299622498918578 smaller than best position loss 0.013190420701899321
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1212 loss: 0.127836  [   16/ 3239]

1212 class loss: 0.075306 position_loss:0.022555

1242 loss: 0.146223  [  496/ 3239]

1242 class loss: 0.148724 position_loss:0.023296

1272 loss: 0.042742  [  976/ 3239]

1272 class loss: 0.041973 position_loss:0.006869

1302 loss: 0.040979  [ 1456/ 3239]

1302 class loss: 0.036282 position_loss:0.006744

1332 loss: 0.039111  [ 1936/ 3239]

1332 class loss: 0.046120 position_loss:0.005977

1362 loss: 0.080602  [ 2416/ 3239]

1362 class loss: 0.055388 position_loss:0.013905

1392 loss: 0.078269  [ 2896/ 3239]

1392 class loss: 0.053955 position_loss:0.013496

Epoch 7: train loss: 0.084935

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 7: valid loss:0.048992

Epoch 7: valid_class_loss:0.034082	valid_position_loss:0.008435

Epoch 7: valid loss 0.04899163377325631 smaller than best loss 0.058774078894203795
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.008435057639037118 smaller than best position loss 0.010299622498918578
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1414 loss: 0.073842  [   16/ 3239]

1414 class loss: 0.052951 position_loss:0.012650

1444 loss: 0.085737  [  496/ 3239]

1444 class loss: 0.104146 position_loss:0.012981

1474 loss: 0.105959  [  976/ 3239]

1474 class loss: 0.128449 position_loss:0.016054

1504 loss: 0.104718  [ 1456/ 3239]

1504 class loss: 0.091018 position_loss:0.017303

1534 loss: 0.062262  [ 1936/ 3239]

1534 class loss: 0.080330 position_loss:0.009239

1564 loss: 0.047943  [ 2416/ 3239]

1564 class loss: 0.049899 position_loss:0.007593

1594 loss: 0.035412  [ 2896/ 3239]

1594 class loss: 0.045230 position_loss:0.005273

Epoch 8: train loss: 0.064182

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 8: valid loss:0.046384

Epoch 8: valid_class_loss:0.036451	valid_position_loss:0.007819

Epoch 8: valid loss 0.046383761578656015 smaller than best loss 0.04899163377325631
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.007818718530206596 smaller than best position loss 0.008435057639037118
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1616 loss: 0.040975  [   16/ 3239]

1616 class loss: 0.053860 position_loss:0.006041

1646 loss: 0.044705  [  496/ 3239]

1646 class loss: 0.058658 position_loss:0.006595

1676 loss: 0.081650  [  976/ 3239]

1676 class loss: 0.043496 position_loss:0.014590

1706 loss: 0.037280  [ 1456/ 3239]

1706 class loss: 0.026241 position_loss:0.006406

1736 loss: 0.017568  [ 1936/ 3239]

1736 class loss: 0.023316 position_loss:0.002581

1766 loss: 0.068071  [ 2416/ 3239]

1766 class loss: 0.084890 position_loss:0.010219

1796 loss: 0.042160  [ 2896/ 3239]

1796 class loss: 0.057743 position_loss:0.006122

Epoch 9: train loss: 0.051963

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 9: valid loss:0.037382

Epoch 9: valid_class_loss:0.033411	valid_position_loss:0.006140

Epoch 9: valid loss 0.03738155321701168 smaller than best loss 0.046383761578656015
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.006139863830720097 smaller than best position loss 0.007818718530206596
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1818 loss: 0.025338  [   16/ 3239]

1818 class loss: 0.035141 position_loss:0.003662

1848 loss: 0.036738  [  496/ 3239]

1848 class loss: 0.053776 position_loss:0.005196

1878 loss: 0.022759  [  976/ 3239]

1878 class loss: 0.027299 position_loss:0.003460

1908 loss: 0.023672  [ 1456/ 3239]

1908 class loss: 0.021434 position_loss:0.003877

1938 loss: 0.022942  [ 1936/ 3239]

1938 class loss: 0.019525 position_loss:0.003808

1968 loss: 0.019032  [ 2416/ 3239]

1968 class loss: 0.025726 position_loss:0.002777

1998 loss: 0.015362  [ 2896/ 3239]

1998 class loss: 0.019730 position_loss:0.002283

Epoch 10: train loss: 0.044229

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 10: valid loss:0.031809

Epoch 10: valid_class_loss:0.031262	valid_position_loss:0.005111

Epoch 10: valid loss 0.03180926191966893 smaller than best loss 0.03738155321701168
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.005111375134202414 smaller than best position loss 0.006139863830720097
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2020 loss: 0.041626  [   16/ 3239]

2020 class loss: 0.053088 position_loss:0.006202

2050 loss: 0.044014  [  496/ 3239]

2050 class loss: 0.039126 position_loss:0.007238

2080 loss: 0.044208  [  976/ 3239]

2080 class loss: 0.036607 position_loss:0.007377

2110 loss: 0.034996  [ 1456/ 3239]

2110 class loss: 0.022808 position_loss:0.006087

2140 loss: 0.073276  [ 1936/ 3239]

2140 class loss: 0.025129 position_loss:0.013650

2170 loss: 0.026371  [ 2416/ 3239]

2170 class loss: 0.021627 position_loss:0.004409

2200 loss: 0.026389  [ 2896/ 3239]

2200 class loss: 0.025636 position_loss:0.004252

Epoch 11: train loss: 0.038547

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 11: valid loss:0.028979

Epoch 11: valid_class_loss:0.030341	valid_position_loss:0.004582

Epoch 11: valid loss 0.028978714579371227 smaller than best loss 0.03180926191966893
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.004582094644236945 smaller than best position loss 0.005111375134202414
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2222 loss: 0.033714  [   16/ 3239]

2222 class loss: 0.047342 position_loss:0.004849

2252 loss: 0.048746  [  496/ 3239]

2252 class loss: 0.067245 position_loss:0.007059

2282 loss: 0.028420  [  976/ 3239]

2282 class loss: 0.038325 position_loss:0.004151

2312 loss: 0.039315  [ 1456/ 3239]

2312 class loss: 0.037527 position_loss:0.006362

2342 loss: 0.014325  [ 1936/ 3239]

2342 class loss: 0.021366 position_loss:0.002010

2372 loss: 0.048238  [ 2416/ 3239]

2372 class loss: 0.051814 position_loss:0.007575

2402 loss: 0.027157  [ 2896/ 3239]

2402 class loss: 0.046090 position_loss:0.003588

Epoch 12: train loss: 0.034559

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 12: valid loss:0.027017

Epoch 12: valid_class_loss:0.029116	valid_position_loss:0.004239

Epoch 12: valid loss 0.027016519583262462 smaller than best loss 0.028978714579371227
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.004238683184003502 smaller than best position loss 0.004582094644236945
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2424 loss: 0.026786  [   16/ 3239]

2424 class loss: 0.034580 position_loss:0.003974

2454 loss: 0.053646  [  496/ 3239]

2454 class loss: 0.061420 position_loss:0.008272

2484 loss: 0.033852  [  976/ 3239]

2484 class loss: 0.049860 position_loss:0.004776

2514 loss: 0.027091  [ 1456/ 3239]

2514 class loss: 0.039022 position_loss:0.003857

2544 loss: 0.022141  [ 1936/ 3239]

2544 class loss: 0.035085 position_loss:0.003025

2574 loss: 0.046950  [ 2416/ 3239]

2574 class loss: 0.044799 position_loss:0.007598

2604 loss: 0.040715  [ 2896/ 3239]

2604 class loss: 0.049668 position_loss:0.006156

Epoch 13: train loss: 0.030787

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 13: valid loss:0.025400

Epoch 13: valid_class_loss:0.027449	valid_position_loss:0.003982

Epoch 13: valid loss 0.02540031439324133 smaller than best loss 0.027016519583262462
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.00398208771536238 smaller than best position loss 0.004238683184003502
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2626 loss: 0.020884  [   16/ 3239]

2626 class loss: 0.032165 position_loss:0.002890

2656 loss: 0.012749  [  496/ 3239]

2656 class loss: 0.015755 position_loss:0.001920

2686 loss: 0.028105  [  976/ 3239]

2686 class loss: 0.037166 position_loss:0.004134

2716 loss: 0.032606  [ 1456/ 3239]

2716 class loss: 0.026046 position_loss:0.005479

2746 loss: 0.035433  [ 1936/ 3239]

2746 class loss: 0.018383 position_loss:0.006351

2776 loss: 0.036167  [ 2416/ 3239]

2776 class loss: 0.023102 position_loss:0.006309

2806 loss: 0.051101  [ 2896/ 3239]

2806 class loss: 0.036675 position_loss:0.008753

Epoch 14: train loss: 0.027798

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 14: valid loss:0.023442

Epoch 14: valid_class_loss:0.026414	valid_position_loss:0.003632

Epoch 14: valid loss 0.02344161950679746 smaller than best loss 0.02540031439324133
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0036317529921109626 smaller than best position loss 0.00398208771536238
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

2828 loss: 0.023998  [   16/ 3239]

2828 class loss: 0.028969 position_loss:0.003641

2858 loss: 0.028489  [  496/ 3239]

2858 class loss: 0.047375 position_loss:0.003803

2888 loss: 0.027523  [  976/ 3239]

2888 class loss: 0.022823 position_loss:0.004592

2918 loss: 0.037228  [ 1456/ 3239]

2918 class loss: 0.046571 position_loss:0.005583

2948 loss: 0.029455  [ 1936/ 3239]

2948 class loss: 0.022258 position_loss:0.005001

2978 loss: 0.025140  [ 2416/ 3239]

2978 class loss: 0.025402 position_loss:0.004012

3008 loss: 0.052106  [ 2896/ 3239]

3008 class loss: 0.049107 position_loss:0.008457

Epoch 15: train loss: 0.025157

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 56

Epoch 15: valid loss:0.021932

Epoch 15: valid_class_loss:0.026012	valid_position_loss:0.003346

Epoch 15: valid loss 0.02193230324916638 smaller than best loss 0.02344161950679746
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0033459776311809326 smaller than best position loss 0.0036317529921109626
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__03-54-07/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.6         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.737734
Nucleus_export  0.683593
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.843913  0.143752  0.156087
Nucleus_export  0.774802  0.115394  0.225198
===========================================

 cs acc: 

                      0
ER             0.833333
Peroxisome     0.400000
Mitochondrion  0.396947
SIGNAL         0.853432
chloroplast    0.394366
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988816                 0.914440           0.869258   
ER                   0.965021                 0.706211           0.779405   
Peroxisome           0.712500                 0.436466           0.562483   
Mitochondrion        0.847962                 0.729635           0.656305   
Nucleus_export       0.973815                 0.527045           0.482906   
SIGNAL               0.916137                 0.952499           0.668011   
chloroplast          0.905295                 0.716468           0.699443   
Thylakoid            0.982386                 0.503480           0.615508   

                recall_score  precision_score  f1_score  
Nucleus             0.893805         0.878261  0.885965  
ER                  0.833333         0.740741  0.784314  
Peroxisome          0.400000         0.800000  0.533333  
Mitochondrion       0.534351         0.897436  0.669856  
Nucleus_export      0.722222         0.342105  0.464286  
SIGNAL              0.777365         0.926991  0.845610  
chloroplast         0.633803         0.818182  0.714286  
Thylakoid           0.900000         0.428571  0.580645  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.6         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.597207
Nucleus_export  0.252270
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.679246  0.154254  0.320754
Nucleus_export  0.281875  0.066158  0.718125
===========================================

 cs acc: 

                      0
ER             0.954545
Peroxisome     0.750000
Mitochondrion  0.261905
SIGNAL         0.876977
chloroplast    0.393939
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.982157                 0.901903           0.852035   
ER                   0.998220                 0.902010           0.806023   
Peroxisome           0.969851                 0.851667           0.823335   
Mitochondrion        0.806831                 0.685947           0.624496   
Nucleus_export       0.933817                 0.304228           0.223958   
SIGNAL               0.918827                 0.952138           0.670841   
chloroplast          0.945045                 0.710280           0.650440   
Thylakoid            0.994365                 0.492345           0.635002   

                recall_score  precision_score  f1_score  
Nucleus             0.881818         0.858407  0.869955  
ER                  0.772727         0.850000  0.809524  
Peroxisome          0.875000         0.777778  0.823529  
Mitochondrion       0.452381         0.950000  0.612903  
Nucleus_export      0.350000         0.175000  0.233333  
SIGNAL              0.780316         0.934737  0.850575  
chloroplast         0.590909         0.764706  0.666667  
Thylakoid           1.000000         0.409091  0.580645  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.6         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.580078
Nucleus_export  0.220579
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.661064  0.150374  0.220754
Nucleus_export  0.246875  0.042017  0.103125
===========================================

 cs acc: 

                      0
ER             0.941176
Peroxisome     0.857143
Mitochondrion  0.315789
SIGNAL         0.903153
chloroplast    0.410256
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.982157                 0.901903           0.852035   
ER                   0.998220                 0.902010           0.806023   
Peroxisome           0.969851                 0.851667           0.823335   
Mitochondrion        0.806831                 0.685947           0.624496   
Nucleus_export       0.933817                 0.304228           0.223958   
SIGNAL               0.918827                 0.952138           0.670841   
chloroplast          0.945045                 0.710280           0.650440   
Thylakoid            0.994365                 0.492345           0.635002   

                recall_score  precision_score  f1_score  
Nucleus             0.881818         0.858407  0.869955  
ER                  0.772727         0.850000  0.809524  
Peroxisome          0.875000         0.777778  0.823529  
Mitochondrion       0.452381         0.950000  0.612903  
Nucleus_export      0.350000         0.175000  0.233333  
SIGNAL              0.780316         0.934737  0.850575  
chloroplast         0.590909         0.764706  0.666667  
Thylakoid           1.000000         0.409091  0.580645  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.6         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927450
Nucleus_export  0.186238
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.078341  0.0
Nucleus_export  0.2  0.109639  0.8
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.4              1.0  0.571429  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.6         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927450
Nucleus_export  0.186238
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.078341  0.0
Nucleus_export  0.2  0.054415  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.4              1.0  0.571429  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
