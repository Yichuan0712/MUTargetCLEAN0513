use k-fold index: 2

Done Loading data

number of steps for training data: 200

number of steps for valid data: 58

number of steps for test data: 59

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 200

Start training...

Fold 2 Epoch 1 train...
-------------------------------

0 loss: 0.985578  [   16/ 3202]

0 class loss: 0.214915 position_loss:0.188519

30 loss: 0.683974  [  496/ 3202]

30 class loss: 0.143601 position_loss:0.131051

60 loss: 1.093716  [  976/ 3202]

60 class loss: 0.225232 position_loss:0.209734

90 loss: 0.251807  [ 1456/ 3202]

90 class loss: 0.053986 position_loss:0.048202

120 loss: 1.297651  [ 1936/ 3202]

120 class loss: 0.272208 position_loss:0.248642

150 loss: 0.804892  [ 2416/ 3202]

150 class loss: 0.172707 position_loss:0.154070

180 loss: 0.771972  [ 2896/ 3202]

180 class loss: 0.156594 position_loss:0.148131

Epoch 1: train loss: 0.701084

Fold 2 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 1: valid loss:0.296236

Epoch 1: valid_class_loss:0.063517	valid_position_loss:0.056707

Epoch 1: valid loss 0.2962360941113473 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05670652504434319 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 2 train...
-------------------------------

200 loss: 0.906993  [   16/ 3202]

200 class loss: 0.176486 position_loss:0.174339

230 loss: 0.777801  [  496/ 3202]

230 class loss: 0.147725 position_loss:0.149651

260 loss: 0.507057  [  976/ 3202]

260 class loss: 0.121185 position_loss:0.096564

290 loss: 0.668660  [ 1456/ 3202]

290 class loss: 0.153181 position_loss:0.127605

320 loss: 0.512446  [ 1936/ 3202]

320 class loss: 0.115603 position_loss:0.097865

350 loss: 0.678437  [ 2416/ 3202]

350 class loss: 0.148342 position_loss:0.129754

380 loss: 0.420582  [ 2896/ 3202]

380 class loss: 0.097391 position_loss:0.080221

Epoch 2: train loss: 0.687000

Fold 2 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 2: valid loss:0.291601

Epoch 2: valid_class_loss:0.063062	valid_position_loss:0.055798

Epoch 2: valid loss 0.2916008394540642 smaller than best loss 0.2962360941113473
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.055797681288243674 smaller than best position loss 0.05670652504434319
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 3 train...
-------------------------------

400 loss: 0.834073  [   16/ 3202]

400 class loss: 0.171037 position_loss:0.159973

430 loss: 0.493699  [  496/ 3202]

430 class loss: 0.089845 position_loss:0.095146

460 loss: 0.131370  [  976/ 3202]

460 class loss: 0.028935 position_loss:0.025117

490 loss: 1.169972  [ 1456/ 3202]

490 class loss: 0.158533 position_loss:0.227653

520 loss: 0.597386  [ 1936/ 3202]

520 class loss: 0.131637 position_loss:0.114212

550 loss: 1.022781  [ 2416/ 3202]

550 class loss: 0.230410 position_loss:0.195340

580 loss: 0.730487  [ 2896/ 3202]

580 class loss: 0.137089 position_loss:0.140614

Epoch 3: train loss: 0.683394

Fold 2 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 3: valid loss:0.292056

Epoch 3: valid_class_loss:0.062787	valid_position_loss:0.055900

Fold 2 Epoch 4 train...
-------------------------------

600 loss: 1.335038  [   16/ 3202]

600 class loss: 0.300982 position_loss:0.254968

630 loss: 0.459046  [  496/ 3202]

630 class loss: 0.104158 position_loss:0.087643

660 loss: 0.155897  [  976/ 3202]

660 class loss: 0.033957 position_loss:0.029821

690 loss: 0.709068  [ 1456/ 3202]

690 class loss: 0.155144 position_loss:0.135608

720 loss: 0.317542  [ 1936/ 3202]

720 class loss: 0.089067 position_loss:0.059946

750 loss: 0.616241  [ 2416/ 3202]

750 class loss: 0.122992 position_loss:0.118329

780 loss: 1.020093  [ 2896/ 3202]

780 class loss: 0.247479 position_loss:0.194119

Epoch 4: train loss: 0.581389

Fold 2 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 4: valid loss:0.194387

Epoch 4: valid_class_loss:0.048591	valid_position_loss:0.036934

Epoch 4: valid loss 0.19438676935027457 smaller than best loss 0.2916008394540642
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.03693372319958512 smaller than best position loss 0.055797681288243674
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 5 train...
-------------------------------

800 loss: 0.250403  [   16/ 3202]

800 class loss: 0.059945 position_loss:0.047683

830 loss: 0.620810  [  496/ 3202]

830 class loss: 0.161931 position_loss:0.117685

860 loss: 0.462192  [  976/ 3202]

860 class loss: 0.148652 position_loss:0.086492

890 loss: 0.353810  [ 1456/ 3202]

890 class loss: 0.116265 position_loss:0.066111

920 loss: 0.277976  [ 1936/ 3202]

920 class loss: 0.104997 position_loss:0.051395

950 loss: 0.307633  [ 2416/ 3202]

950 class loss: 0.114430 position_loss:0.056949

980 loss: 0.155597  [ 2896/ 3202]

980 class loss: 0.063403 position_loss:0.028583

Epoch 5: train loss: 0.301770

Fold 2 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 5: valid loss:0.082842

Epoch 5: valid_class_loss:0.036036	valid_position_loss:0.015127

Epoch 5: valid loss 0.0828417970129607 smaller than best loss 0.19438676935027457
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.015126902094306812 smaller than best position loss 0.03693372319958512
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 6 train...
-------------------------------

1000 loss: 0.038429  [   16/ 3202]

1000 class loss: 0.018915 position_loss:0.006929

1030 loss: 0.128850  [  496/ 3202]

1030 class loss: 0.053583 position_loss:0.023627

1060 loss: 0.143114  [  976/ 3202]

1060 class loss: 0.094469 position_loss:0.024844

1090 loss: 0.208654  [ 1456/ 3202]

1090 class loss: 0.106554 position_loss:0.037469

1120 loss: 0.115445  [ 1936/ 3202]

1120 class loss: 0.100952 position_loss:0.019051

1150 loss: 0.095327  [ 2416/ 3202]

1150 class loss: 0.057096 position_loss:0.016782

1180 loss: 0.146221  [ 2896/ 3202]

1180 class loss: 0.066636 position_loss:0.026579

Epoch 6: train loss: 0.152632

Fold 2 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 6: valid loss:0.059620

Epoch 6: valid_class_loss:0.032255	valid_position_loss:0.010634

Epoch 6: valid loss 0.05962018818899748 smaller than best loss 0.0828417970129607
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.010633820804678234 smaller than best position loss 0.015126902094306812
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 7 train...
-------------------------------

1200 loss: 0.181301  [   16/ 3202]

1200 class loss: 0.135834 position_loss:0.030827

1230 loss: 0.115011  [  496/ 3202]

1230 class loss: 0.068786 position_loss:0.020251

1260 loss: 0.059200  [  976/ 3202]

1260 class loss: 0.060179 position_loss:0.009433

1290 loss: 0.119636  [ 1456/ 3202]

1290 class loss: 0.079944 position_loss:0.020730

1320 loss: 0.145614  [ 1936/ 3202]

1320 class loss: 0.070705 position_loss:0.026295

1350 loss: 0.059870  [ 2416/ 3202]

1350 class loss: 0.020153 position_loss:0.011168

1380 loss: 0.060978  [ 2896/ 3202]

1380 class loss: 0.057705 position_loss:0.009887

Epoch 7: train loss: 0.121182

Fold 2 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 7: valid loss:0.053787

Epoch 7: valid_class_loss:0.032670	valid_position_loss:0.009451

Epoch 7: valid loss 0.05378704362337307 smaller than best loss 0.05962018818899748
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.009450615308875693 smaller than best position loss 0.010633820804678234
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 8 train...
-------------------------------

1400 loss: 0.105858  [   16/ 3202]

1400 class loss: 0.104176 position_loss:0.017005

1430 loss: 0.097048  [  496/ 3202]

1430 class loss: 0.075887 position_loss:0.016374

1460 loss: 0.063295  [  976/ 3202]

1460 class loss: 0.029029 position_loss:0.011498

1490 loss: 0.139348  [ 1456/ 3202]

1490 class loss: 0.078519 position_loss:0.024729

1520 loss: 0.092487  [ 1936/ 3202]

1520 class loss: 0.076776 position_loss:0.015426

1550 loss: 0.142652  [ 2416/ 3202]

1550 class loss: 0.107868 position_loss:0.024216

1580 loss: 0.072838  [ 2896/ 3202]

1580 class loss: 0.088270 position_loss:0.011037

Epoch 8: train loss: 0.102342

Fold 2 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 8: valid loss:0.040008

Epoch 8: valid_class_loss:0.029107	valid_position_loss:0.006837

Epoch 8: valid loss 0.04000763943719179 smaller than best loss 0.05378704362337307
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006837233911578662 smaller than best position loss 0.009450615308875693
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 9 train...
-------------------------------

1600 loss: 0.082057  [   16/ 3202]

1600 class loss: 0.078183 position_loss:0.013284

1630 loss: 0.017773  [  496/ 3202]

1630 class loss: 0.022837 position_loss:0.002641

1660 loss: 0.026168  [  976/ 3202]

1660 class loss: 0.030059 position_loss:0.004031

1690 loss: 0.076821  [ 1456/ 3202]

1690 class loss: 0.070302 position_loss:0.012552

1720 loss: 0.029035  [ 1936/ 3202]

1720 class loss: 0.025886 position_loss:0.004772

1750 loss: 0.092864  [ 2416/ 3202]

1750 class loss: 0.115251 position_loss:0.013963

1780 loss: 0.061849  [ 2896/ 3202]

1780 class loss: 0.077104 position_loss:0.009286

Epoch 9: train loss: 0.078946

Fold 2 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 9: valid loss:0.036890

Epoch 9: valid_class_loss:0.031868	valid_position_loss:0.006103

Epoch 9: valid loss 0.036889660324338984 smaller than best loss 0.04000763943719179
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.006103225465055894 smaller than best position loss 0.006837233911578662
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 10 train...
-------------------------------

1800 loss: 0.009026  [   16/ 3202]

1800 class loss: 0.013430 position_loss:0.001268

1830 loss: 0.114112  [  496/ 3202]

1830 class loss: 0.133300 position_loss:0.017490

1860 loss: 0.069754  [  976/ 3202]

1860 class loss: 0.048893 position_loss:0.011995

1890 loss: 0.071319  [ 1456/ 3202]

1890 class loss: 0.104840 position_loss:0.010070

1920 loss: 0.094169  [ 1936/ 3202]

1920 class loss: 0.134591 position_loss:0.013450

1950 loss: 0.136280  [ 2416/ 3202]

1950 class loss: 0.085032 position_loss:0.023855

1980 loss: 0.046425  [ 2896/ 3202]

1980 class loss: 0.070196 position_loss:0.006477

Epoch 10: train loss: 0.063778

Fold 2 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 10: valid loss:0.030376

Epoch 10: valid_class_loss:0.028941	valid_position_loss:0.004918

Epoch 10: valid loss 0.030376326630313064 smaller than best loss 0.036889660324338984
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004917640079415935 smaller than best position loss 0.006103225465055894
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 11 train...
-------------------------------

2000 loss: 0.075507  [   16/ 3202]

2000 class loss: 0.102322 position_loss:0.011009

2030 loss: 0.027658  [  496/ 3202]

2030 class loss: 0.030661 position_loss:0.004305

2060 loss: 0.064195  [  976/ 3202]

2060 class loss: 0.048088 position_loss:0.010915

2090 loss: 0.113537  [ 1456/ 3202]

2090 class loss: 0.106834 position_loss:0.018434

2120 loss: 0.081904  [ 1936/ 3202]

2120 class loss: 0.085485 position_loss:0.012961

2150 loss: 0.023971  [ 2416/ 3202]

2150 class loss: 0.036464 position_loss:0.003336

2180 loss: 0.041691  [ 2896/ 3202]

2180 class loss: 0.058130 position_loss:0.006013

Epoch 11: train loss: 0.052757

Fold 2 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 11: valid loss:0.026288

Epoch 11: valid_class_loss:0.027287	valid_position_loss:0.004166

Epoch 11: valid loss 0.026288005759004078 smaller than best loss 0.030376326630313064
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.00416612748075168 smaller than best position loss 0.004917640079415935
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 12 train...
-------------------------------

2200 loss: 0.026474  [   16/ 3202]

2200 class loss: 0.038793 position_loss:0.003743

2230 loss: 0.092746  [  496/ 3202]

2230 class loss: 0.118404 position_loss:0.013813

2260 loss: 0.073603  [  976/ 3202]

2260 class loss: 0.077382 position_loss:0.011625

2290 loss: 0.033240  [ 1456/ 3202]

2290 class loss: 0.048691 position_loss:0.004700

2320 loss: 0.048976  [ 1936/ 3202]

2320 class loss: 0.077251 position_loss:0.006705

2350 loss: 0.014057  [ 2416/ 3202]

2350 class loss: 0.018480 position_loss:0.002072

2380 loss: 0.046638  [ 2896/ 3202]

2380 class loss: 0.075601 position_loss:0.006303

Epoch 12: train loss: 0.046866

Fold 2 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 12: valid loss:0.024628

Epoch 12: valid_class_loss:0.024499	valid_position_loss:0.003946

Epoch 12: valid loss 0.024628073399982072 smaller than best loss 0.026288005759004078
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003945640357940642 smaller than best position loss 0.00416612748075168
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 13 train...
-------------------------------

2400 loss: 0.017383  [   16/ 3202]

2400 class loss: 0.025064 position_loss:0.002474

2430 loss: 0.036001  [  496/ 3202]

2430 class loss: 0.055277 position_loss:0.004989

2460 loss: 0.062900  [  976/ 3202]

2460 class loss: 0.111808 position_loss:0.008108

2490 loss: 0.027621  [ 1456/ 3202]

2490 class loss: 0.022501 position_loss:0.004624

2520 loss: 0.036030  [ 1936/ 3202]

2520 class loss: 0.040166 position_loss:0.005599

2550 loss: 0.049202  [ 2416/ 3202]

2550 class loss: 0.054476 position_loss:0.007661

2580 loss: 0.052840  [ 2896/ 3202]

2580 class loss: 0.085089 position_loss:0.007164

Epoch 13: train loss: 0.041174

Fold 2 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 13: valid loss:0.023360

Epoch 13: valid_class_loss:0.024295	valid_position_loss:0.003700

Epoch 13: valid loss 0.02335975950925525 smaller than best loss 0.024628073399982072
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0037001422112281296 smaller than best position loss 0.003945640357940642
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 14 train...
-------------------------------

2600 loss: 0.031369  [   16/ 3202]

2600 class loss: 0.054798 position_loss:0.004082

2630 loss: 0.027872  [  496/ 3202]

2630 class loss: 0.022350 position_loss:0.004680

2660 loss: 0.048070  [  976/ 3202]

2660 class loss: 0.076113 position_loss:0.006570

2690 loss: 0.055180  [ 1456/ 3202]

2690 class loss: 0.095717 position_loss:0.007207

2720 loss: 0.016179  [ 1936/ 3202]

2720 class loss: 0.014026 position_loss:0.002675

2750 loss: 0.042698  [ 2416/ 3202]

2750 class loss: 0.066693 position_loss:0.005872

2780 loss: 0.044551  [ 2896/ 3202]

2780 class loss: 0.067124 position_loss:0.006225

Epoch 14: train loss: 0.035832

Fold 2 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 14: valid loss:0.022359

Epoch 14: valid_class_loss:0.023617	valid_position_loss:0.003527

Epoch 14: valid loss 0.022359292076660854 smaller than best loss 0.02335975950925525
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0035271617193699434 smaller than best position loss 0.0037001422112281296
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Fold 2 Epoch 15 train...
-------------------------------

2800 loss: 0.028200  [   16/ 3202]

2800 class loss: 0.024585 position_loss:0.004657

2830 loss: 0.005525  [  496/ 3202]

2830 class loss: 0.011537 position_loss:0.000644

2860 loss: 0.019684  [  976/ 3202]

2860 class loss: 0.023487 position_loss:0.002997

2890 loss: 0.042965  [ 1456/ 3202]

2890 class loss: 0.071591 position_loss:0.005729

2920 loss: 0.089458  [ 1936/ 3202]

2920 class loss: 0.067121 position_loss:0.015207

2950 loss: 0.035087  [ 2416/ 3202]

2950 class loss: 0.057378 position_loss:0.004722

2980 loss: 0.029462  [ 2896/ 3202]

2980 class loss: 0.024071 position_loss:0.004930

Epoch 15: train loss: 0.032672

Fold 2 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 58

Epoch 15: valid loss:0.020819

Epoch 15: valid_class_loss:0.022534	valid_position_loss:0.003262

Epoch 15: valid loss 0.020819064924747933 smaller than best loss 0.022359292076660854
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0032624678565538663 smaller than best position loss 0.0035271617193699434
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__06-11-32/checkpoints/best_model.pth

Fold 2 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.5            0.2             0.5     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.688556
Nucleus_export  0.536616
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.840834  0.229674  0.159166
Nucleus_export  0.713409  0.313714  0.286591
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     0.555556
Mitochondrion  0.328467
SIGNAL         0.831560
chloroplast    0.514286
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.954377                 0.830430           0.750744   
ER                   0.989639                 0.642478           0.708585   
Peroxisome           0.733235                 0.561612           0.743720   
Mitochondrion        0.837975                 0.678825           0.566616   
Nucleus_export       0.957273                 0.279750           0.402286   
SIGNAL               0.913794                 0.950363           0.679084   
chloroplast          0.980671                 0.897912           0.813218   
Thylakoid            0.993637                 0.508783           0.662618   

                recall_score  precision_score  f1_score  
Nucleus             0.764151         0.794118  0.778846  
ER                  0.954545         0.538462  0.688525  
Peroxisome          0.555556         1.000000  0.714286  
Mitochondrion       0.562044         0.693694  0.620968  
Nucleus_export      0.894737         0.200000  0.326923  
SIGNAL              0.881206         0.873462  0.877317  
chloroplast         0.771429         0.885246  0.824427  
Thylakoid           0.888889         0.500000  0.640000  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.5            0.2             0.5     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.653810
Nucleus_export  0.380516
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.821871  0.256762  0.178129
Nucleus_export  0.484861  0.257709  0.515139
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     0.636364
Mitochondrion  0.229008
SIGNAL         0.832753
chloroplast    0.397059
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.972682                 0.855026           0.825135   
ER                   0.996333                 0.772472           0.818515   
Peroxisome           0.927985                 0.766037           0.736548   
Mitochondrion        0.831536                 0.632186           0.551754   
Nucleus_export       0.939725                 0.245312           0.309546   
SIGNAL               0.918255                 0.955366           0.679672   
chloroplast          0.951157                 0.708769           0.746086   
Thylakoid            1.000000                 1.000000           0.753465   

                recall_score  precision_score  f1_score  
Nucleus             0.823009         0.869159  0.845455  
ER                  1.000000         0.677419  0.807692  
Peroxisome          0.545455         1.000000  0.705882  
Mitochondrion       0.480916         0.750000  0.586047  
Nucleus_export      0.800000         0.142857  0.242424  
SIGNAL              0.874564         0.879159  0.876856  
chloroplast         0.735294         0.793651  0.763359  
Thylakoid           1.000000         0.571429  0.727273  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.5            0.2             0.5     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.590721
Nucleus_export  0.273332
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.748222  0.238617  0.074786
Nucleus_export  0.366111  0.237386  0.433889
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     1.000000
Mitochondrion  0.269841
SIGNAL         0.850598
chloroplast    0.460000
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.972682                 0.855026           0.825135   
ER                   0.996333                 0.772472           0.818515   
Peroxisome           0.927985                 0.766037           0.736548   
Mitochondrion        0.831536                 0.632186           0.551754   
Nucleus_export       0.939725                 0.245312           0.309546   
SIGNAL               0.918255                 0.955366           0.679672   
chloroplast          0.951157                 0.708769           0.746086   
Thylakoid            1.000000                 1.000000           0.753465   

                recall_score  precision_score  f1_score  
Nucleus             0.823009         0.869159  0.845455  
ER                  1.000000         0.677419  0.807692  
Peroxisome          0.545455         1.000000  0.705882  
Mitochondrion       0.480916         0.750000  0.586047  
Nucleus_export      0.800000         0.142857  0.242424  
SIGNAL              0.874564         0.879159  0.876856  
chloroplast         0.735294         0.793651  0.763359  
Thylakoid           1.000000         0.571429  0.727273  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.5            0.2             0.5     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.841450
Nucleus_export  0.549317
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.960317  0.143321  0.039683
Nucleus_export  0.620588  0.160396  0.379412
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                     0.71                0.3   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus             0.800000              0.8  0.800000  
ER                  0.000000              0.0  0.000000  
Peroxisome          0.000000              0.0  0.000000  
Mitochondrion       0.000000              0.0  0.000000  
Nucleus_export      0.714286              1.0  0.833333  
SIGNAL              0.000000              0.0  0.000000  
chloroplast         0.000000              0.0  0.000000  
Thylakoid           0.000000              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.5            0.2             0.5     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.691766
Nucleus_export  0.291046
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.788889  0.114267  0.011111
Nucleus_export  0.334874  0.130009  0.379412
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                     0.71                0.3   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus             0.800000              0.8  0.800000  
ER                  0.000000              0.0  0.000000  
Peroxisome          0.000000              0.0  0.000000  
Mitochondrion       0.000000              0.0  0.000000  
Nucleus_export      0.714286              1.0  0.833333  
SIGNAL              0.000000              0.0  0.000000  
chloroplast         0.000000              0.0  0.000000  
Thylakoid           0.000000              0.0  0.000000  
