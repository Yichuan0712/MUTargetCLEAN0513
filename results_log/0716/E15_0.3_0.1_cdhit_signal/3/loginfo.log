use k-fold index: 3

Done Loading data

number of steps for training data: 205

number of steps for valid data: 62

number of steps for test data: 61

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 205

Start training...

Fold 3 Epoch 1 train...
-------------------------------

0 loss: 0.570286  [   16/ 3286]

0 class loss: 0.106013 position_loss:0.109817

30 loss: 0.725000  [  496/ 3286]

30 class loss: 0.154492 position_loss:0.138820

60 loss: 0.487305  [  976/ 3286]

60 class loss: 0.108612 position_loss:0.093116

90 loss: 0.809961  [ 1456/ 3286]

90 class loss: 0.158855 position_loss:0.155638

120 loss: 0.454842  [ 1936/ 3286]

120 class loss: 0.095727 position_loss:0.087139

150 loss: 0.485279  [ 2416/ 3286]

150 class loss: 0.110657 position_loss:0.092629

180 loss: 0.573567  [ 2896/ 3286]

180 class loss: 0.117897 position_loss:0.109997

Epoch 1: train loss: 0.554155

Fold 3 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 1: valid loss:0.261300

Epoch 1: valid_class_loss:0.058194	valid_position_loss:0.049932

Epoch 1: valid loss 0.2612998656128004 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.049932210143502846 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 2 train...
-------------------------------

205 loss: 1.100545  [   16/ 3286]

205 class loss: 0.177693 position_loss:0.213001

235 loss: 0.390749  [  496/ 3286]

235 class loss: 0.081627 position_loss:0.074885

265 loss: 0.559427  [  976/ 3286]

265 class loss: 0.126724 position_loss:0.106816

295 loss: 0.428464  [ 1456/ 3286]

295 class loss: 0.089716 position_loss:0.082104

325 loss: 0.461742  [ 1936/ 3286]

325 class loss: 0.102121 position_loss:0.088264

355 loss: 0.293144  [ 2416/ 3286]

355 class loss: 0.064265 position_loss:0.056058

385 loss: 0.278198  [ 2896/ 3286]

385 class loss: 0.063574 position_loss:0.053097

Epoch 2: train loss: 0.493999

Fold 3 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 2: valid loss:0.216462

Epoch 2: valid_class_loss:0.051401	valid_position_loss:0.041236

Epoch 2: valid loss 0.21646200965263637 smaller than best loss 0.2612998656128004
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.041236353966919846 smaller than best position loss 0.049932210143502846
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 3 train...
-------------------------------

410 loss: 0.563972  [   16/ 3286]

410 class loss: 0.129759 position_loss:0.107604

440 loss: 0.380744  [  496/ 3286]

440 class loss: 0.095153 position_loss:0.072343

470 loss: 0.167022  [  976/ 3286]

470 class loss: 0.043121 position_loss:0.031679

500 loss: 0.346821  [ 1456/ 3286]

500 class loss: 0.096381 position_loss:0.065509

530 loss: 0.595462  [ 1936/ 3286]

530 class loss: 0.175434 position_loss:0.112075

560 loss: 0.217926  [ 2416/ 3286]

560 class loss: 0.062725 position_loss:0.041076

590 loss: 0.416483  [ 2896/ 3286]

590 class loss: 0.128052 position_loss:0.078174

Epoch 3: train loss: 0.333271

Fold 3 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 3: valid loss:0.117213

Epoch 3: valid_class_loss:0.038227	valid_position_loss:0.021914

Epoch 3: valid loss 0.11721328708281459 smaller than best loss 0.21646200965263637
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.021913589640803692 smaller than best position loss 0.041236353966919846
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 4 train...
-------------------------------

615 loss: 0.156681  [   16/ 3286]

615 class loss: 0.060075 position_loss:0.028933

645 loss: 0.103860  [  496/ 3286]

645 class loss: 0.033080 position_loss:0.019449

675 loss: 0.280496  [  976/ 3286]

675 class loss: 0.127393 position_loss:0.051004

705 loss: 0.120749  [ 1456/ 3286]

705 class loss: 0.033857 position_loss:0.022795

735 loss: 0.150811  [ 1936/ 3286]

735 class loss: 0.102715 position_loss:0.026054

765 loss: 0.148983  [ 2416/ 3286]

765 class loss: 0.092926 position_loss:0.026080

795 loss: 0.115918  [ 2896/ 3286]

795 class loss: 0.081899 position_loss:0.019908

Epoch 4: train loss: 0.175759

Fold 3 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 4: valid loss:0.068419

Epoch 4: valid_class_loss:0.031428	valid_position_loss:0.012427

Epoch 4: valid loss 0.0684193781296771 smaller than best loss 0.11721328708281459
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.012426744891968298 smaller than best position loss 0.021913589640803692
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 5 train...
-------------------------------

820 loss: 0.053293  [   16/ 3286]

820 class loss: 0.031599 position_loss:0.009395

850 loss: 0.153898  [  496/ 3286]

850 class loss: 0.126809 position_loss:0.025707

880 loss: 0.214993  [  976/ 3286]

880 class loss: 0.145475 position_loss:0.037180

910 loss: 0.090596  [ 1456/ 3286]

910 class loss: 0.065337 position_loss:0.015506

940 loss: 0.030791  [ 1936/ 3286]

940 class loss: 0.024424 position_loss:0.005181

970 loss: 0.156232  [ 2416/ 3286]

970 class loss: 0.104906 position_loss:0.027050

1000 loss: 0.031217  [ 2896/ 3286]

1000 class loss: 0.018792 position_loss:0.005492

Epoch 5: train loss: 0.111265

Fold 3 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 5: valid loss:0.056121

Epoch 5: valid_class_loss:0.029243	valid_position_loss:0.010054

Epoch 5: valid loss 0.056120937725912964 smaller than best loss 0.0684193781296771
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010054473475208592 smaller than best position loss 0.012426744891968298
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 6 train...
-------------------------------

1025 loss: 0.129738  [   16/ 3286]

1025 class loss: 0.025470 position_loss:0.024929

1055 loss: 0.054085  [  496/ 3286]

1055 class loss: 0.035381 position_loss:0.009402

1085 loss: 0.177647  [  976/ 3286]

1085 class loss: 0.179289 position_loss:0.028358

1115 loss: 0.193532  [ 1456/ 3286]

1115 class loss: 0.116481 position_loss:0.034047

1145 loss: 0.045756  [ 1936/ 3286]

1145 class loss: 0.046644 position_loss:0.007286

1175 loss: 0.055642  [ 2416/ 3286]

1175 class loss: 0.054434 position_loss:0.008951

1205 loss: 0.116304  [ 2896/ 3286]

1205 class loss: 0.100709 position_loss:0.019233

Epoch 6: train loss: 0.090429

Fold 3 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 6: valid loss:0.046299

Epoch 6: valid_class_loss:0.027718	valid_position_loss:0.008151

Epoch 6: valid loss 0.04629881573407295 smaller than best loss 0.056120937725912964
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.008151060198120291 smaller than best position loss 0.010054473475208592
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 7 train...
-------------------------------

1230 loss: 0.105259  [   16/ 3286]

1230 class loss: 0.040751 position_loss:0.019422

1260 loss: 0.049636  [  496/ 3286]

1260 class loss: 0.052621 position_loss:0.007822

1290 loss: 0.050494  [  976/ 3286]

1290 class loss: 0.055922 position_loss:0.007862

1320 loss: 0.081082  [ 1456/ 3286]

1320 class loss: 0.050701 position_loss:0.014188

1350 loss: 0.086013  [ 1936/ 3286]

1350 class loss: 0.028815 position_loss:0.016050

1380 loss: 0.099876  [ 2416/ 3286]

1380 class loss: 0.037353 position_loss:0.018481

1410 loss: 0.046468  [ 2896/ 3286]

1410 class loss: 0.055203 position_loss:0.007086

Epoch 7: train loss: 0.072773

Fold 3 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 7: valid loss:0.036439

Epoch 7: valid_class_loss:0.027796	valid_position_loss:0.006176

Epoch 7: valid loss 0.03643907983429724 smaller than best loss 0.04629881573407295
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.006175977922803984 smaller than best position loss 0.008151060198120291
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 8 train...
-------------------------------

1435 loss: 0.048466  [   16/ 3286]

1435 class loss: 0.055128 position_loss:0.007488

1465 loss: 0.056474  [  496/ 3286]

1465 class loss: 0.026062 position_loss:0.010252

1495 loss: 0.037525  [  976/ 3286]

1495 class loss: 0.052163 position_loss:0.005419

1525 loss: 0.009741  [ 1456/ 3286]

1525 class loss: 0.012354 position_loss:0.001454

1555 loss: 0.036116  [ 1936/ 3286]

1555 class loss: 0.047284 position_loss:0.005332

1585 loss: 0.030616  [ 2416/ 3286]

1585 class loss: 0.042570 position_loss:0.004420

1615 loss: 0.054473  [ 2896/ 3286]

1615 class loss: 0.067285 position_loss:0.008203

Epoch 8: train loss: 0.057323

Fold 3 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 8: valid loss:0.030012

Epoch 8: valid_class_loss:0.026517	valid_position_loss:0.004942

Epoch 8: valid loss 0.03001218897264915 smaller than best loss 0.03643907983429724
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.004941739164042406 smaller than best position loss 0.006175977922803984
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 9 train...
-------------------------------

1640 loss: 0.128540  [   16/ 3286]

1640 class loss: 0.123708 position_loss:0.020760

1670 loss: 0.044738  [  496/ 3286]

1670 class loss: 0.066102 position_loss:0.006303

1700 loss: 0.076938  [  976/ 3286]

1700 class loss: 0.103840 position_loss:0.011234

1730 loss: 0.038871  [ 1456/ 3286]

1730 class loss: 0.023663 position_loss:0.006828

1760 loss: 0.035549  [ 1936/ 3286]

1760 class loss: 0.059595 position_loss:0.004726

1790 loss: 0.044661  [ 2416/ 3286]

1790 class loss: 0.058771 position_loss:0.006581

1820 loss: 0.082015  [ 2896/ 3286]

1820 class loss: 0.044688 position_loss:0.014616

Epoch 9: train loss: 0.047773

Fold 3 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 9: valid loss:0.026688

Epoch 9: valid_class_loss:0.024326	valid_position_loss:0.004365

Epoch 9: valid loss 0.026688349670495964 smaller than best loss 0.03001218897264915
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004364624017208052 smaller than best position loss 0.004941739164042406
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 10 train...
-------------------------------

1845 loss: 0.088271  [   16/ 3286]

1845 class loss: 0.123424 position_loss:0.012717

1875 loss: 0.031348  [  496/ 3286]

1875 class loss: 0.050867 position_loss:0.004235

1905 loss: 0.054551  [  976/ 3286]

1905 class loss: 0.068161 position_loss:0.008184

1935 loss: 0.023933  [ 1456/ 3286]

1935 class loss: 0.042799 position_loss:0.003075

1965 loss: 0.043643  [ 1936/ 3286]

1965 class loss: 0.037537 position_loss:0.007227

1995 loss: 0.009950  [ 2416/ 3286]

1995 class loss: 0.017424 position_loss:0.001293

2025 loss: 0.020125  [ 2896/ 3286]

2025 class loss: 0.034550 position_loss:0.002643

Epoch 10: train loss: 0.040931

Fold 3 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 10: valid loss:0.024620

Epoch 10: valid_class_loss:0.023120	valid_position_loss:0.003999

Epoch 10: valid loss 0.024619887787790364 smaller than best loss 0.026688349670495964
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.003999165100974611 smaller than best position loss 0.004364624017208052
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 11 train...
-------------------------------

2050 loss: 0.021127  [   16/ 3286]

2050 class loss: 0.028119 position_loss:0.003101

2080 loss: 0.076585  [  496/ 3286]

2080 class loss: 0.107530 position_loss:0.011016

2110 loss: 0.026797  [  976/ 3286]

2110 class loss: 0.029372 position_loss:0.004184

2140 loss: 0.042478  [ 1456/ 3286]

2140 class loss: 0.054324 position_loss:0.006323

2170 loss: 0.044697  [ 1936/ 3286]

2170 class loss: 0.045433 position_loss:0.007122

2200 loss: 0.040185  [ 2416/ 3286]

2200 class loss: 0.035775 position_loss:0.006606

2230 loss: 0.019724  [ 2896/ 3286]

2230 class loss: 0.025473 position_loss:0.002926

Epoch 11: train loss: 0.036213

Fold 3 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 11: valid loss:0.023247

Epoch 11: valid_class_loss:0.021574	valid_position_loss:0.003787

Epoch 11: valid loss 0.023247491180751475 smaller than best loss 0.024619887787790364
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0037865348908737635 smaller than best position loss 0.003999165100974611
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 12 train...
-------------------------------

2255 loss: 0.019769  [   16/ 3286]

2255 class loss: 0.032574 position_loss:0.002651

2285 loss: 0.048611  [  496/ 3286]

2285 class loss: 0.076130 position_loss:0.006677

2315 loss: 0.040908  [  976/ 3286]

2315 class loss: 0.050796 position_loss:0.006150

2345 loss: 0.009718  [ 1456/ 3286]

2345 class loss: 0.019936 position_loss:0.001146

2375 loss: 0.013960  [ 1936/ 3286]

2375 class loss: 0.017322 position_loss:0.002099

2405 loss: 0.020366  [ 2416/ 3286]

2405 class loss: 0.022769 position_loss:0.003163

2435 loss: 0.037878  [ 2896/ 3286]

2435 class loss: 0.050680 position_loss:0.005548

Epoch 12: train loss: 0.032314

Fold 3 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 12: valid loss:0.022633

Epoch 12: valid_class_loss:0.019973	valid_position_loss:0.003728

Epoch 12: valid loss 0.022632964187296902 smaller than best loss 0.023247491180751475
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003727692611797688 smaller than best position loss 0.0037865348908737635
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 13 train...
-------------------------------

2460 loss: 0.044747  [   16/ 3286]

2460 class loss: 0.062174 position_loss:0.006462

2490 loss: 0.013846  [  496/ 3286]

2490 class loss: 0.024464 position_loss:0.001791

2520 loss: 0.038255  [  976/ 3286]

2520 class loss: 0.051600 position_loss:0.005587

2550 loss: 0.055278  [ 1456/ 3286]

2550 class loss: 0.056086 position_loss:0.008812

2580 loss: 0.024210  [ 1936/ 3286]

2580 class loss: 0.026030 position_loss:0.003801

2610 loss: 0.026010  [ 2416/ 3286]

2610 class loss: 0.040548 position_loss:0.003580

2640 loss: 0.026430  [ 2896/ 3286]

2640 class loss: 0.031083 position_loss:0.004043

Epoch 13: train loss: 0.029028

Fold 3 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 13: valid loss:0.022649

Epoch 13: valid_class_loss:0.019378	valid_position_loss:0.003755

Fold 3 Epoch 14 train...
-------------------------------

2665 loss: 0.014776  [   16/ 3286]

2665 class loss: 0.028353 position_loss:0.001821

2695 loss: 0.020186  [  496/ 3286]

2695 class loss: 0.029332 position_loss:0.002864

2725 loss: 0.023024  [  976/ 3286]

2725 class loss: 0.031108 position_loss:0.003360

2755 loss: 0.023656  [ 1456/ 3286]

2755 class loss: 0.041285 position_loss:0.003080

2785 loss: 0.032731  [ 1936/ 3286]

2785 class loss: 0.051148 position_loss:0.004500

2815 loss: 0.027172  [ 2416/ 3286]

2815 class loss: 0.038108 position_loss:0.003910

2845 loss: 0.026214  [ 2896/ 3286]

2845 class loss: 0.033951 position_loss:0.003885

Epoch 14: train loss: 0.025947

Fold 3 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 14: valid loss:0.020199

Epoch 14: valid_class_loss:0.020117	valid_position_loss:0.003235

Epoch 14: valid loss 0.020198546835171482 smaller than best loss 0.022632964187296902
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0032350108719706467 smaller than best position loss 0.003727692611797688
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 3 Epoch 15 train...
-------------------------------

2870 loss: 0.025170  [   16/ 3286]

2870 class loss: 0.037700 position_loss:0.003526

2900 loss: 0.032015  [  496/ 3286]

2900 class loss: 0.031139 position_loss:0.005158

2930 loss: 0.012471  [  976/ 3286]

2930 class loss: 0.021275 position_loss:0.001643

2960 loss: 0.015027  [ 1456/ 3286]

2960 class loss: 0.018755 position_loss:0.002255

2990 loss: 0.031578  [ 1936/ 3286]

2990 class loss: 0.049775 position_loss:0.004325

3020 loss: 0.021401  [ 2416/ 3286]

3020 class loss: 0.040832 position_loss:0.002647

3050 loss: 0.028864  [ 2896/ 3286]

3050 class loss: 0.050205 position_loss:0.003765

Epoch 15: train loss: 0.023122

Fold 3 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 62

Epoch 15: valid loss:0.020817

Epoch 15: valid_class_loss:0.017825	valid_position_loss:0.003450

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0716/2024-07-17__13-12-54/checkpoints/best_model.pth

Fold 3 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.9  0.4         0.4            0.2             0.9     0.3   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.686392
Nucleus_export  0.556360
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.836892  0.221808  0.163108
Nucleus_export  0.766225  0.380733  0.233775
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     0.666667
Mitochondrion  0.272152
SIGNAL         0.837696
chloroplast    0.492958
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.974742                 0.871592           0.803090   
ER                   0.996944                 0.870622           0.881615   
Peroxisome           0.929389                 0.817951           0.780809   
Mitochondrion        0.920734                 0.871596           0.712660   
Nucleus_export       0.952108                 0.235069           0.383270   
SIGNAL               0.951286                 0.958819           0.805770   
chloroplast          0.976331                 0.837171           0.790555   
Thylakoid            1.000000                 1.000000           1.000000   

                recall_score  precision_score  f1_score  
Nucleus             0.803030         0.854839  0.828125  
ER                  1.000000         0.783784  0.878788  
Peroxisome          0.750000         0.818182  0.782609  
Mitochondrion       0.829114         0.700535  0.759420  
Nucleus_export      0.560000         0.291667  0.383562  
SIGNAL              0.872600         0.954198  0.911577  
chloroplast         0.845070         0.769231  0.805369  
Thylakoid           1.000000         1.000000  1.000000  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.9  0.4         0.4            0.2             0.9     0.3   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.592424
Nucleus_export  0.534724
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.705011  0.183671  0.294989
Nucleus_export  0.717339  0.286538  0.282661
===========================================

 cs acc: 

                      0
ER             0.928571
Peroxisome     0.583333
Mitochondrion  0.297468
SIGNAL         0.829787
chloroplast    0.301370
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.945994                 0.776384           0.669095   
ER                   0.956446                 0.757663           0.858370   
Peroxisome           0.785280                 0.598290           0.761779   
Mitochondrion        0.866022                 0.796987           0.634411   
Nucleus_export       0.920296                 0.204189           0.242541   
SIGNAL               0.951309                 0.953928           0.787695   
chloroplast          0.955365                 0.903664           0.839180   
Thylakoid            0.978170                 0.715778           0.815226   

                recall_score  precision_score  f1_score  
Nucleus             0.650407         0.769231  0.704846  
ER                  0.892857         0.833333  0.862069  
Peroxisome          0.583333         1.000000  0.736842  
Mitochondrion       0.746835         0.651934  0.696165  
Nucleus_export      0.360000         0.200000  0.257143  
SIGNAL              0.856383         0.952663  0.901961  
chloroplast         0.863014         0.840000  0.851351  
Thylakoid           0.666667         1.000000  0.800000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.9  0.4         0.4            0.2             0.9     0.3   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.467187
Nucleus_export  0.279271
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.567125  0.148885  0.083281
Nucleus_export  0.360000  0.111227  0.000000
===========================================

 cs acc: 

                      0
ER             1.000000
Peroxisome     0.857143
Mitochondrion  0.296610
SIGNAL         0.859213
chloroplast    0.301587
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.945994                 0.776384           0.669095   
ER                   0.956446                 0.757663           0.858370   
Peroxisome           0.785280                 0.598290           0.761779   
Mitochondrion        0.866022                 0.796987           0.634411   
Nucleus_export       0.920296                 0.204189           0.242541   
SIGNAL               0.951309                 0.953928           0.787695   
chloroplast          0.955365                 0.903664           0.839180   
Thylakoid            0.978170                 0.715778           0.815226   

                recall_score  precision_score  f1_score  
Nucleus             0.650407         0.769231  0.704846  
ER                  0.892857         0.833333  0.862069  
Peroxisome          0.583333         1.000000  0.736842  
Mitochondrion       0.746835         0.651934  0.696165  
Nucleus_export      0.360000         0.200000  0.257143  
SIGNAL              0.856383         0.952663  0.901961  
chloroplast         0.863014         0.840000  0.851351  
Thylakoid           0.666667         1.000000  0.800000  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.9  0.4         0.4            0.2             0.9     0.3   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.498335
Nucleus_export  0.568140
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.572917  0.204376  0.427083
Nucleus_export  0.777778  0.326477  0.222222
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                 0.492857               -0.1   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus             0.500000              0.4  0.444444  
ER                  0.000000              0.0  0.000000  
Peroxisome          0.000000              0.0  0.000000  
Mitochondrion       0.000000              0.0  0.000000  
Nucleus_export      0.444444              1.0  0.615385  
SIGNAL              0.000000              0.0  0.000000  
chloroplast         0.000000              0.0  0.000000  
Thylakoid           0.000000              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.9  0.4         0.4            0.2             0.9     0.3   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.186968
Nucleus_export  0.330965
===========================================

 TPR, FPR, FNR: 

                       0         1     2
Nucleus         0.250000  0.176258  0.25
Nucleus_export  0.444444  0.162389  0.00
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                 0.492857               -0.1   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus             0.500000              0.4  0.444444  
ER                  0.000000              0.0  0.000000  
Peroxisome          0.000000              0.0  0.000000  
Mitochondrion       0.000000              0.0  0.000000  
Nucleus_export      0.444444              1.0  0.615385  
SIGNAL              0.000000              0.0  0.000000  
chloroplast         0.000000              0.0  0.000000  
Thylakoid           0.000000              0.0  0.000000  
