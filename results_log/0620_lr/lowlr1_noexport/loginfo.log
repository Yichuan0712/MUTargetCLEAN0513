use k-fold index: 0

Done Loading data

number of steps for training data: 414

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 414

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.143596  [   16/ 6633]

0 class loss: 0.031340 position_loss:0.027466

30 loss: 0.643105  [  496/ 6633]

30 class loss: 0.140100 position_loss:0.123017

60 loss: 0.321747  [  976/ 6633]

60 class loss: 0.070924 position_loss:0.061513

90 loss: 0.333015  [ 1456/ 6633]

90 class loss: 0.070664 position_loss:0.063777

120 loss: 0.101563  [ 1936/ 6633]

120 class loss: 0.021777 position_loss:0.019442

150 loss: 0.489377  [ 2416/ 6633]

150 class loss: 0.109701 position_loss:0.093487

180 loss: 0.483972  [ 2896/ 6633]

180 class loss: 0.116479 position_loss:0.092135

210 loss: 0.178382  [ 3376/ 6633]

210 class loss: 0.040478 position_loss:0.034057

240 loss: 0.193862  [ 3856/ 6633]

240 class loss: 0.044618 position_loss:0.036988

270 loss: 0.255515  [ 4336/ 6633]

270 class loss: 0.055461 position_loss:0.048885

300 loss: 0.575613  [ 4816/ 6633]

300 class loss: 0.115667 position_loss:0.110496

330 loss: 0.333656  [ 5296/ 6633]

330 class loss: 0.071528 position_loss:0.063870

360 loss: 0.118952  [ 5776/ 6633]

360 class loss: 0.025620 position_loss:0.022766

390 loss: 0.091499  [ 6256/ 6633]

390 class loss: 0.020829 position_loss:0.017467

Epoch 1: train loss: 0.357951

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.276719

Epoch 1: valid_class_loss:0.058206	valid_position_loss:0.053016

Epoch 1: valid loss 0.2767188295430808 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05301553562900325 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

414 loss: 0.442646  [   16/ 6633]

414 class loss: 0.104782 position_loss:0.084338

444 loss: 0.245550  [  496/ 6633]

444 class loss: 0.049399 position_loss:0.047134

474 loss: 0.257045  [  976/ 6633]

474 class loss: 0.065446 position_loss:0.048791

504 loss: 0.140746  [ 1456/ 6633]

504 class loss: 0.031330 position_loss:0.026896

534 loss: 0.297812  [ 1936/ 6633]

534 class loss: 0.068403 position_loss:0.056826

564 loss: 0.245217  [ 2416/ 6633]

564 class loss: 0.056123 position_loss:0.046799

594 loss: 0.084697  [ 2896/ 6633]

594 class loss: 0.019041 position_loss:0.016178

624 loss: 0.245363  [ 3376/ 6633]

624 class loss: 0.060114 position_loss:0.046668

654 loss: 0.124963  [ 3856/ 6633]

654 class loss: 0.028232 position_loss:0.023863

684 loss: 0.377442  [ 4336/ 6633]

684 class loss: 0.111113 position_loss:0.071044

714 loss: 0.200691  [ 4816/ 6633]

714 class loss: 0.041357 position_loss:0.038484

744 loss: 0.103684  [ 5296/ 6633]

744 class loss: 0.025550 position_loss:0.019715

774 loss: 0.217955  [ 5776/ 6633]

774 class loss: 0.059823 position_loss:0.041198

804 loss: 0.263329  [ 6256/ 6633]

804 class loss: 0.077991 position_loss:0.049546

Epoch 2: train loss: 0.278039

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.157417

Epoch 2: valid_class_loss:0.041624	valid_position_loss:0.029818

Epoch 2: valid loss 0.15741702692619058 smaller than best loss 0.2767188295430808
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.02981845423944375 smaller than best position loss 0.05301553562900325
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

828 loss: 0.402719  [   16/ 6633]

828 class loss: 0.108215 position_loss:0.076215

858 loss: 0.284868  [  496/ 6633]

858 class loss: 0.086358 position_loss:0.053519

888 loss: 0.095074  [  976/ 6633]

888 class loss: 0.027607 position_loss:0.017911

918 loss: 0.181394  [ 1456/ 6633]

918 class loss: 0.059297 position_loss:0.033907

948 loss: 0.142131  [ 1936/ 6633]

948 class loss: 0.059082 position_loss:0.026063

978 loss: 0.221988  [ 2416/ 6633]

978 class loss: 0.088657 position_loss:0.040851

1008 loss: 0.040739  [ 2896/ 6633]

1008 class loss: 0.014499 position_loss:0.007568

1038 loss: 0.148554  [ 3376/ 6633]

1038 class loss: 0.027792 position_loss:0.028599

1068 loss: 0.121024  [ 3856/ 6633]

1068 class loss: 0.056495 position_loss:0.021945

1098 loss: 0.063338  [ 4336/ 6633]

1098 class loss: 0.032374 position_loss:0.011373

1128 loss: 0.177122  [ 4816/ 6633]

1128 class loss: 0.116055 position_loss:0.030782

1158 loss: 0.048138  [ 5296/ 6633]

1158 class loss: 0.024032 position_loss:0.008666

1188 loss: 0.113642  [ 5776/ 6633]

1188 class loss: 0.064225 position_loss:0.020159

1218 loss: 0.128570  [ 6256/ 6633]

1218 class loss: 0.087833 position_loss:0.022201

Epoch 3: train loss: 0.130619

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.074439

Epoch 3: valid_class_loss:0.032946	valid_position_loss:0.013570

Epoch 3: valid loss 0.07443947141088143 smaller than best loss 0.15741702692619058
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.013570043165787601 smaller than best position loss 0.02981845423944375
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

1242 loss: 0.171015  [   16/ 6633]

1242 class loss: 0.112405 position_loss:0.029707

1272 loss: 0.057394  [  496/ 6633]

1272 class loss: 0.025228 position_loss:0.010470

1302 loss: 0.065652  [  976/ 6633]

1302 class loss: 0.039273 position_loss:0.011559

1332 loss: 0.065927  [ 1456/ 6633]

1332 class loss: 0.025454 position_loss:0.012167

1362 loss: 0.043496  [ 1936/ 6633]

1362 class loss: 0.028329 position_loss:0.007566

1392 loss: 0.060781  [ 2416/ 6633]

1392 class loss: 0.048079 position_loss:0.010233

1422 loss: 0.072217  [ 2896/ 6633]

1422 class loss: 0.048944 position_loss:0.012486

1452 loss: 0.032592  [ 3376/ 6633]

1452 class loss: 0.024825 position_loss:0.005525

1482 loss: 0.091090  [ 3856/ 6633]

1482 class loss: 0.071561 position_loss:0.015356

1512 loss: 0.060287  [ 4336/ 6633]

1512 class loss: 0.043030 position_loss:0.010336

1542 loss: 0.053710  [ 4816/ 6633]

1542 class loss: 0.039174 position_loss:0.009175

1572 loss: 0.123175  [ 5296/ 6633]

1572 class loss: 0.104440 position_loss:0.020457

1602 loss: 0.043141  [ 5776/ 6633]

1602 class loss: 0.034995 position_loss:0.007228

1632 loss: 0.059223  [ 6256/ 6633]

1632 class loss: 0.054755 position_loss:0.009654

Epoch 4: train loss: 0.070877

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.064261

Epoch 4: valid_class_loss:0.031899	valid_position_loss:0.011576

Epoch 4: valid loss 0.06426061413370932 smaller than best loss 0.07443947141088143
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.01157615091781895 smaller than best position loss 0.013570043165787601
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

1656 loss: 0.110823  [   16/ 6633]

1656 class loss: 0.078595 position_loss:0.019021

1686 loss: 0.034369  [  496/ 6633]

1686 class loss: 0.030632 position_loss:0.005648

1716 loss: 0.107845  [  976/ 6633]

1716 class loss: 0.060306 position_loss:0.019157

1746 loss: 0.048241  [ 1456/ 6633]

1746 class loss: 0.046124 position_loss:0.007803

1776 loss: 0.111929  [ 1936/ 6633]

1776 class loss: 0.049124 position_loss:0.020421

1806 loss: 0.054800  [ 2416/ 6633]

1806 class loss: 0.055131 position_loss:0.008755

1836 loss: 0.042275  [ 2896/ 6633]

1836 class loss: 0.014555 position_loss:0.007873

1866 loss: 0.064093  [ 3376/ 6633]

1866 class loss: 0.051117 position_loss:0.010774

1896 loss: 0.024213  [ 3856/ 6633]

1896 class loss: 0.015038 position_loss:0.004241

1926 loss: 0.085763  [ 4336/ 6633]

1926 class loss: 0.056194 position_loss:0.014905

1956 loss: 0.104888  [ 4816/ 6633]

1956 class loss: 0.087284 position_loss:0.017486

1986 loss: 0.050942  [ 5296/ 6633]

1986 class loss: 0.056759 position_loss:0.007918

2016 loss: 0.053849  [ 5776/ 6633]

2016 class loss: 0.049557 position_loss:0.008787

2046 loss: 0.025983  [ 6256/ 6633]

2046 class loss: 0.018921 position_loss:0.004440

Epoch 5: train loss: 0.057992

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.051909

Epoch 5: valid_class_loss:0.031427	valid_position_loss:0.009125

Epoch 5: valid loss 0.051908533965183655 smaller than best loss 0.06426061413370932
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.009124635544634198 smaller than best position loss 0.01157615091781895
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

2070 loss: 0.017474  [   16/ 6633]

2070 class loss: 0.013498 position_loss:0.002955

2100 loss: 0.064108  [  496/ 6633]

2100 class loss: 0.065094 position_loss:0.010218

2130 loss: 0.101128  [  976/ 6633]

2130 class loss: 0.047273 position_loss:0.018335

2160 loss: 0.083340  [ 1456/ 6633]

2160 class loss: 0.039410 position_loss:0.015092

2190 loss: 0.054493  [ 1936/ 6633]

2190 class loss: 0.038976 position_loss:0.009339

2220 loss: 0.024550  [ 2416/ 6633]

2220 class loss: 0.026031 position_loss:0.003869

2250 loss: 0.034367  [ 2896/ 6633]

2250 class loss: 0.036647 position_loss:0.005407

2280 loss: 0.062203  [ 3376/ 6633]

2280 class loss: 0.044785 position_loss:0.010649

2310 loss: 0.011184  [ 3856/ 6633]

2310 class loss: 0.014367 position_loss:0.001662

2340 loss: 0.065899  [ 4336/ 6633]

2340 class loss: 0.041758 position_loss:0.011509

2370 loss: 0.009650  [ 4816/ 6633]

2370 class loss: 0.011986 position_loss:0.001450

2400 loss: 0.022743  [ 5296/ 6633]

2400 class loss: 0.010744 position_loss:0.004119

2430 loss: 0.011087  [ 5776/ 6633]

2430 class loss: 0.012076 position_loss:0.001734

2460 loss: 0.038027  [ 6256/ 6633]

2460 class loss: 0.045135 position_loss:0.005800

Epoch 6: train loss: 0.049166

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.039939

Epoch 6: valid_class_loss:0.028626	valid_position_loss:0.006843

Epoch 6: valid loss 0.039939382214123374 smaller than best loss 0.051908533965183655
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.006842817386696474 smaller than best position loss 0.009124635544634198
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

2484 loss: 0.018770  [   16/ 6633]

2484 class loss: 0.016769 position_loss:0.003083

2514 loss: 0.032506  [  496/ 6633]

2514 class loss: 0.024405 position_loss:0.005525

2544 loss: 0.024008  [  976/ 6633]

2544 class loss: 0.016446 position_loss:0.004144

2574 loss: 0.040514  [ 1456/ 6633]

2574 class loss: 0.018855 position_loss:0.007349

2604 loss: 0.024466  [ 1936/ 6633]

2604 class loss: 0.030399 position_loss:0.003677

2634 loss: 0.053299  [ 2416/ 6633]

2634 class loss: 0.022749 position_loss:0.009750

2664 loss: 0.017360  [ 2896/ 6633]

2664 class loss: 0.020971 position_loss:0.002633

2694 loss: 0.077894  [ 3376/ 6633]

2694 class loss: 0.063709 position_loss:0.013030

2724 loss: 0.032983  [ 3856/ 6633]

2724 class loss: 0.025327 position_loss:0.005584

2754 loss: 0.061014  [ 4336/ 6633]

2754 class loss: 0.084382 position_loss:0.008827

2784 loss: 0.025760  [ 4816/ 6633]

2784 class loss: 0.033143 position_loss:0.003826

2814 loss: 0.049315  [ 5296/ 6633]

2814 class loss: 0.045705 position_loss:0.008035

2844 loss: 0.021849  [ 5776/ 6633]

2844 class loss: 0.019229 position_loss:0.003601

2874 loss: 0.038715  [ 6256/ 6633]

2874 class loss: 0.052089 position_loss:0.005659

Epoch 7: train loss: 0.038574

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.030708

Epoch 7: valid_class_loss:0.026192	valid_position_loss:0.005094

Epoch 7: valid loss 0.03070844269593703 smaller than best loss 0.039939382214123374
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.00509401098673278 smaller than best position loss 0.006842817386696474
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

2898 loss: 0.090308  [   16/ 6633]

2898 class loss: 0.067780 position_loss:0.015350

2928 loss: 0.016035  [  496/ 6633]

2928 class loss: 0.018496 position_loss:0.002467

2958 loss: 0.027501  [  976/ 6633]

2958 class loss: 0.022653 position_loss:0.004594

2988 loss: 0.026424  [ 1456/ 6633]

2988 class loss: 0.036565 position_loss:0.003822

3018 loss: 0.016620  [ 1936/ 6633]

3018 class loss: 0.027331 position_loss:0.002231

3048 loss: 0.014326  [ 2416/ 6633]

3048 class loss: 0.021877 position_loss:0.001990

3078 loss: 0.022184  [ 2896/ 6633]

3078 class loss: 0.014120 position_loss:0.003872

3108 loss: 0.039193  [ 3376/ 6633]

3108 class loss: 0.052622 position_loss:0.005734

3138 loss: 0.029248  [ 3856/ 6633]

3138 class loss: 0.041884 position_loss:0.004174

3168 loss: 0.055823  [ 4336/ 6633]

3168 class loss: 0.041957 position_loss:0.009486

3198 loss: 0.058761  [ 4816/ 6633]

3198 class loss: 0.058983 position_loss:0.009393

3228 loss: 0.017191  [ 5296/ 6633]

3228 class loss: 0.012855 position_loss:0.002924

3258 loss: 0.013448  [ 5776/ 6633]

3258 class loss: 0.017429 position_loss:0.001992

3288 loss: 0.009671  [ 6256/ 6633]

3288 class loss: 0.009095 position_loss:0.001570

Epoch 8: train loss: 0.031742

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.026369

Epoch 8: valid_class_loss:0.024723	valid_position_loss:0.004285

Epoch 8: valid loss 0.026369134460594454 smaller than best loss 0.03070844269593703
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.004284925556687081 smaller than best position loss 0.00509401098673278
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

3312 loss: 0.015816  [   16/ 6633]

3312 class loss: 0.019220 position_loss:0.002394

3342 loss: 0.058306  [  496/ 6633]

3342 class loss: 0.078957 position_loss:0.008503

3372 loss: 0.067504  [  976/ 6633]

3372 class loss: 0.053723 position_loss:0.011352

3402 loss: 0.007513  [ 1456/ 6633]

3402 class loss: 0.012108 position_loss:0.001018

3432 loss: 0.025057  [ 1936/ 6633]

3432 class loss: 0.043146 position_loss:0.003286

3462 loss: 0.047536  [ 2416/ 6633]

3462 class loss: 0.046939 position_loss:0.007630

3492 loss: 0.022211  [ 2896/ 6633]

3492 class loss: 0.035391 position_loss:0.003027

3522 loss: 0.051941  [ 3376/ 6633]

3522 class loss: 0.032602 position_loss:0.009084

3552 loss: 0.012006  [ 3856/ 6633]

3552 class loss: 0.012701 position_loss:0.001893

3582 loss: 0.031194  [ 4336/ 6633]

3582 class loss: 0.031850 position_loss:0.004965

3612 loss: 0.033670  [ 4816/ 6633]

3612 class loss: 0.053199 position_loss:0.004606

3642 loss: 0.021398  [ 5296/ 6633]

3642 class loss: 0.025918 position_loss:0.003243

3672 loss: 0.013173  [ 5776/ 6633]

3672 class loss: 0.014465 position_loss:0.002056

3702 loss: 0.009724  [ 6256/ 6633]

3702 class loss: 0.012679 position_loss:0.001438

Epoch 9: train loss: 0.026588

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.024015

Epoch 9: valid_class_loss:0.023348	valid_position_loss:0.003869

Epoch 9: valid loss 0.024015373905294037 smaller than best loss 0.026369134460594454
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.0038691715569922273 smaller than best position loss 0.004284925556687081
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

3726 loss: 0.028581  [   16/ 6633]

3726 class loss: 0.038315 position_loss:0.004184

3756 loss: 0.023154  [  496/ 6633]

3756 class loss: 0.042058 position_loss:0.002948

3786 loss: 0.013166  [  976/ 6633]

3786 class loss: 0.022940 position_loss:0.001716

3816 loss: 0.020928  [ 1456/ 6633]

3816 class loss: 0.023179 position_loss:0.003258

3846 loss: 0.021546  [ 1936/ 6633]

3846 class loss: 0.014304 position_loss:0.003737

3876 loss: 0.024180  [ 2416/ 6633]

3876 class loss: 0.026995 position_loss:0.003756

3906 loss: 0.029612  [ 2896/ 6633]

3906 class loss: 0.045135 position_loss:0.004117

3936 loss: 0.009020  [ 3376/ 6633]

3936 class loss: 0.013577 position_loss:0.001261

3966 loss: 0.024496  [ 3856/ 6633]

3966 class loss: 0.040804 position_loss:0.003267

3996 loss: 0.018209  [ 4336/ 6633]

3996 class loss: 0.019334 position_loss:0.002868

4026 loss: 0.030334  [ 4816/ 6633]

4026 class loss: 0.047755 position_loss:0.004157

4056 loss: 0.015657  [ 5296/ 6633]

4056 class loss: 0.026548 position_loss:0.002069

4086 loss: 0.017050  [ 5776/ 6633]

4086 class loss: 0.019613 position_loss:0.002625

4116 loss: 0.047254  [ 6256/ 6633]

4116 class loss: 0.043017 position_loss:0.007730

Epoch 10: train loss: 0.023030

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.021921

Epoch 10: valid_class_loss:0.022548	valid_position_loss:0.003482

Epoch 10: valid loss 0.02192098094479696 smaller than best loss 0.024015373905294037
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.0034822649019015405 smaller than best position loss 0.0038691715569922273
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

4140 loss: 0.013207  [   16/ 6633]

4140 class loss: 0.021517 position_loss:0.001781

4170 loss: 0.015053  [  496/ 6633]

4170 class loss: 0.024316 position_loss:0.002038

4200 loss: 0.016685  [  976/ 6633]

4200 class loss: 0.020234 position_loss:0.002528

4230 loss: 0.027068  [ 1456/ 6633]

4230 class loss: 0.051865 position_loss:0.003339

4260 loss: 0.024339  [ 1936/ 6633]

4260 class loss: 0.025490 position_loss:0.003848

4290 loss: 0.013072  [ 2416/ 6633]

4290 class loss: 0.024056 position_loss:0.001652

4320 loss: 0.005466  [ 2896/ 6633]

4320 class loss: 0.010867 position_loss:0.000659

4350 loss: 0.035038  [ 3376/ 6633]

4350 class loss: 0.021657 position_loss:0.006141

4380 loss: 0.039351  [ 3856/ 6633]

4380 class loss: 0.045671 position_loss:0.006043

4410 loss: 0.014240  [ 4336/ 6633]

4410 class loss: 0.011297 position_loss:0.002396

4440 loss: 0.008868  [ 4816/ 6633]

4440 class loss: 0.015604 position_loss:0.001149

4470 loss: 0.013427  [ 5296/ 6633]

4470 class loss: 0.015335 position_loss:0.002072

4500 loss: 0.024902  [ 5776/ 6633]

4500 class loss: 0.031508 position_loss:0.003720

4530 loss: 0.011250  [ 6256/ 6633]

4530 class loss: 0.014844 position_loss:0.001656

Epoch 11: train loss: 0.020251

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.020602

Epoch 11: valid_class_loss:0.020911	valid_position_loss:0.003284

Epoch 11: valid loss 0.02060151550574458 smaller than best loss 0.02192098094479696
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.003283867769996167 smaller than best position loss 0.0034822649019015405
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

4554 loss: 0.010466  [   16/ 6633]

4554 class loss: 0.008545 position_loss:0.001751

4584 loss: 0.033119  [  496/ 6633]

4584 class loss: 0.051790 position_loss:0.004552

4614 loss: 0.008590  [  976/ 6633]

4614 class loss: 0.013273 position_loss:0.001187

4644 loss: 0.007644  [ 1456/ 6633]

4644 class loss: 0.007147 position_loss:0.001243

4674 loss: 0.005947  [ 1936/ 6633]

4674 class loss: 0.007290 position_loss:0.000898

4704 loss: 0.036610  [ 2416/ 6633]

4704 class loss: 0.034801 position_loss:0.005930

4734 loss: 0.024877  [ 2896/ 6633]

4734 class loss: 0.033183 position_loss:0.003648

4764 loss: 0.028036  [ 3376/ 6633]

4764 class loss: 0.022190 position_loss:0.004720

4794 loss: 0.015572  [ 3856/ 6633]

4794 class loss: 0.023469 position_loss:0.002176

4824 loss: 0.018997  [ 4336/ 6633]

4824 class loss: 0.035335 position_loss:0.002386

4854 loss: 0.006963  [ 4816/ 6633]

4854 class loss: 0.014094 position_loss:0.000829

4884 loss: 0.011705  [ 5296/ 6633]

4884 class loss: 0.023933 position_loss:0.001384

4914 loss: 0.011679  [ 5776/ 6633]

4914 class loss: 0.020264 position_loss:0.001525

4944 loss: 0.007307  [ 6256/ 6633]

4944 class loss: 0.010986 position_loss:0.001022

Epoch 12: train loss: 0.017902

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.019167

Epoch 12: valid_class_loss:0.019953	valid_position_loss:0.003035

Epoch 12: valid loss 0.01916696479694134 smaller than best loss 0.02060151550574458
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003035275612296803 smaller than best position loss 0.003283867769996167
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

4968 loss: 0.023257  [   16/ 6633]

4968 class loss: 0.020377 position_loss:0.003836

4998 loss: 0.028203  [  496/ 6633]

4998 class loss: 0.033205 position_loss:0.004312

5028 loss: 0.012378  [  976/ 6633]

5028 class loss: 0.012236 position_loss:0.001986

5058 loss: 0.005673  [ 1456/ 6633]

5058 class loss: 0.011330 position_loss:0.000681

5088 loss: 0.021340  [ 1936/ 6633]

5088 class loss: 0.014777 position_loss:0.003677

5118 loss: 0.021569  [ 2416/ 6633]

5118 class loss: 0.021905 position_loss:0.003438

5148 loss: 0.022841  [ 2896/ 6633]

5148 class loss: 0.044110 position_loss:0.002804

5178 loss: 0.021042  [ 3376/ 6633]

5178 class loss: 0.018654 position_loss:0.003462

5208 loss: 0.030686  [ 3856/ 6633]

5208 class loss: 0.012284 position_loss:0.005646

5238 loss: 0.024012  [ 4336/ 6633]

5238 class loss: 0.043330 position_loss:0.003069

5268 loss: 0.022574  [ 4816/ 6633]

5268 class loss: 0.032880 position_loss:0.003200

5298 loss: 0.025764  [ 5296/ 6633]

5298 class loss: 0.035699 position_loss:0.003725

5328 loss: 0.025282  [ 5776/ 6633]

5328 class loss: 0.037043 position_loss:0.003575

5358 loss: 0.004473  [ 6256/ 6633]

5358 class loss: 0.008576 position_loss:0.000552

Epoch 13: train loss: 0.016205

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.019306

Epoch 13: valid_class_loss:0.018853	valid_position_loss:0.003107

Fold 0 Epoch 14 train...
-------------------------------

5382 loss: 0.007543  [   16/ 6633]

5382 class loss: 0.009024 position_loss:0.001148

5412 loss: 0.010276  [  496/ 6633]

5412 class loss: 0.023181 position_loss:0.001128

5442 loss: 0.004781  [  976/ 6633]

5442 class loss: 0.009260 position_loss:0.000586

5472 loss: 0.016581  [ 1456/ 6633]

5472 class loss: 0.034335 position_loss:0.001943

5502 loss: 0.015357  [ 1936/ 6633]

5502 class loss: 0.032858 position_loss:0.001757

5532 loss: 0.005983  [ 2416/ 6633]

5532 class loss: 0.007025 position_loss:0.000916

5562 loss: 0.007779  [ 2896/ 6633]

5562 class loss: 0.016248 position_loss:0.000906

5592 loss: 0.019638  [ 3376/ 6633]

5592 class loss: 0.027937 position_loss:0.002810

5622 loss: 0.008360  [ 3856/ 6633]

5622 class loss: 0.014470 position_loss:0.001093

5652 loss: 0.015930  [ 4336/ 6633]

5652 class loss: 0.011858 position_loss:0.002712

5682 loss: 0.008591  [ 4816/ 6633]

5682 class loss: 0.019460 position_loss:0.000940

5712 loss: 0.005054  [ 5296/ 6633]

5712 class loss: 0.008928 position_loss:0.000654

5742 loss: 0.004608  [ 5776/ 6633]

5742 class loss: 0.007636 position_loss:0.000616

5772 loss: 0.010511  [ 6256/ 6633]

5772 class loss: 0.024922 position_loss:0.001105

Epoch 14: train loss: 0.014491

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.019216

Epoch 14: valid_class_loss:0.018091	valid_position_loss:0.003120

Fold 0 Epoch 15 train...
-------------------------------

5796 loss: 0.009102  [   16/ 6633]

5796 class loss: 0.014040 position_loss:0.001259

5826 loss: 0.018146  [  496/ 6633]

5826 class loss: 0.012987 position_loss:0.003110

5856 loss: 0.008988  [  976/ 6633]

5856 class loss: 0.017213 position_loss:0.001109

5886 loss: 0.009242  [ 1456/ 6633]

5886 class loss: 0.013374 position_loss:0.001314

5916 loss: 0.008794  [ 1936/ 6633]

5916 class loss: 0.018500 position_loss:0.001019

5946 loss: 0.012443  [ 2416/ 6633]

5946 class loss: 0.023097 position_loss:0.001565

5976 loss: 0.018599  [ 2896/ 6633]

5976 class loss: 0.025240 position_loss:0.002710

6006 loss: 0.019408  [ 3376/ 6633]

6006 class loss: 0.021990 position_loss:0.003002

6036 loss: 0.016632  [ 3856/ 6633]

6036 class loss: 0.033367 position_loss:0.001992

6066 loss: 0.015948  [ 4336/ 6633]

6066 class loss: 0.027137 position_loss:0.002104

6096 loss: 0.010489  [ 4816/ 6633]

6096 class loss: 0.020316 position_loss:0.001285

6126 loss: 0.013708  [ 5296/ 6633]

6126 class loss: 0.012861 position_loss:0.002227

6156 loss: 0.011662  [ 5776/ 6633]

6156 class loss: 0.022686 position_loss:0.001425

6186 loss: 0.003407  [ 6256/ 6633]

6186 class loss: 0.007178 position_loss:0.000394

Epoch 15: train loss: 0.013209

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.017308

Epoch 15: valid_class_loss:0.017734	valid_position_loss:0.002752

Epoch 15: valid loss 0.017308424113364418 smaller than best loss 0.01916696479694134
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0027523350683491036 smaller than best position loss 0.003035275612296803
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620/2024-06-20__14-46-16/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.5         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.764487
Nucleus_export  0.573964
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.880794  0.158019  0.119206
Nucleus_export  0.731091  0.221804  0.268909
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.387500
SIGNAL         0.872504
chloroplast    0.473684
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.992740                 0.934799           0.869225   
ER                   0.938733                 0.606111           0.762677   
Peroxisome           0.675206                 0.349979           0.552334   
Mitochondrion        0.941905                 0.923391           0.880168   
Nucleus_export       0.961892                 0.474387           0.507723   
SIGNAL               0.977090                 0.985344           0.898450   
chloroplast          0.973858                 0.890000           0.803209   
Thylakoid            0.994767                 0.546444           0.686721   

                recall_score  precision_score  f1_score  
Nucleus             0.984375         0.797468  0.881119  
ER                  0.866667         0.684211  0.764706  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.875000         0.921053  0.897436  
Nucleus_export      0.400000         0.666667  0.500000  
SIGNAL              0.964670         0.957317  0.960979  
chloroplast         0.789474         0.845070  0.816327  
Thylakoid           0.900000         0.529412  0.666667  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.5         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.629097
Nucleus_export  0.272760
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.717771  0.150659  0.282229
Nucleus_export  0.347500  0.149664  0.652500
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.276730
SIGNAL         0.884735
chloroplast    0.356164
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988380                 0.921483           0.812006   
ER                   0.998356                 0.917393           0.817126   
Peroxisome           0.859637                 0.553464           0.617811   
Mitochondrion        0.923891                 0.915304           0.878681   
Nucleus_export       0.948411                 0.270027           0.244507   
SIGNAL               0.980299                 0.986952           0.890592   
chloroplast          0.982779                 0.908713           0.889361   
Thylakoid            0.994063                 0.433689           0.624479   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.760274  0.831461  
ER                  0.793103         0.851852  0.821429  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.861635         0.931973  0.895425  
Nucleus_export      0.200000         0.333333  0.250000  
SIGNAL              0.967290         0.948092  0.957594  
chloroplast         0.945205         0.851852  0.896104  
Thylakoid           0.888889         0.444444  0.592593  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.5         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.629097
Nucleus_export  0.111777
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.717771  0.148071  0.199584
Nucleus_export  0.160000  0.079010  0.040000
===========================================

 cs acc: 

                      0
ER             0.956522
Peroxisome     0.800000
Mitochondrion  0.306569
SIGNAL         0.893720
chloroplast    0.376812
Thylakoid      0.750000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988380                 0.921483           0.812006   
ER                   0.998356                 0.917393           0.817126   
Peroxisome           0.859637                 0.553464           0.617811   
Mitochondrion        0.923891                 0.915304           0.878681   
Nucleus_export       0.948411                 0.270027           0.244507   
SIGNAL               0.980299                 0.986952           0.890592   
chloroplast          0.982779                 0.908713           0.889361   
Thylakoid            0.994063                 0.433689           0.624479   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.760274  0.831461  
ER                  0.793103         0.851852  0.821429  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.861635         0.931973  0.895425  
Nucleus_export      0.200000         0.333333  0.250000  
SIGNAL              0.967290         0.948092  0.957594  
chloroplast         0.945205         0.851852  0.896104  
Thylakoid           0.888889         0.444444  0.592593  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.5         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.925081
Nucleus_export  0.283760
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.081118  0.0
Nucleus_export  0.4  0.246025  0.6
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.5         0.4            0.2             0.9     0.2   
cutoffs_aa       0.3  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.925081
Nucleus_export  0.283760
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.081118  0.0
Nucleus_export  0.4  0.213456  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
