use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.126063  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.440864  [  496/ 3543]

30 class loss: 0.111590 position_loss:0.083709

60 loss: 0.087980  [  976/ 3543]

60 class loss: 0.019316 position_loss:0.016823

90 loss: 0.756274  [ 1456/ 3543]

90 class loss: 0.160152 position_loss:0.144849

120 loss: 0.609891  [ 1936/ 3543]

120 class loss: 0.120698 position_loss:0.117150

150 loss: 0.362098  [ 2416/ 3543]

150 class loss: 0.079388 position_loss:0.069244

180 loss: 0.441734  [ 2896/ 3543]

180 class loss: 0.094948 position_loss:0.084549

210 loss: 0.926752  [ 3376/ 3543]

210 class loss: 0.197297 position_loss:0.177458

Epoch 1: train loss: 0.477097

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.283546

Epoch 1: valid_class_loss:0.059160	valid_position_loss:0.054343

Epoch 1: valid loss 0.28354634050154737 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.054342872410164555 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.228530  [   16/ 3543]

221 class loss: 0.051098 position_loss:0.043662

251 loss: 0.069351  [  496/ 3543]

251 class loss: 0.015002 position_loss:0.013270

281 loss: 0.621708  [  976/ 3543]

281 class loss: 0.154254 position_loss:0.118171

311 loss: 0.567754  [ 1456/ 3543]

311 class loss: 0.133977 position_loss:0.108192

341 loss: 0.436861  [ 1936/ 3543]

341 class loss: 0.085441 position_loss:0.083955

371 loss: 0.361507  [ 2416/ 3543]

371 class loss: 0.082698 position_loss:0.068993

401 loss: 0.210592  [ 2896/ 3543]

401 class loss: 0.047243 position_loss:0.040229

431 loss: 0.314472  [ 3376/ 3543]

431 class loss: 0.067955 position_loss:0.060176

Epoch 2: train loss: 0.415138

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.217758

Epoch 2: valid_class_loss:0.049505	valid_position_loss:0.041571

Epoch 2: valid loss 0.21775836940429968 smaller than best loss 0.28354634050154737
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.041571483539465694 smaller than best position loss 0.054342872410164555
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.480147  [   16/ 3543]

442 class loss: 0.111127 position_loss:0.091584

472 loss: 0.249695  [  496/ 3543]

472 class loss: 0.063901 position_loss:0.047383

502 loss: 0.364941  [  976/ 3543]

502 class loss: 0.081105 position_loss:0.069744

532 loss: 0.172369  [ 1456/ 3543]

532 class loss: 0.044235 position_loss:0.032704

562 loss: 0.368452  [ 1936/ 3543]

562 class loss: 0.111596 position_loss:0.069227

592 loss: 0.114864  [ 2416/ 3543]

592 class loss: 0.027655 position_loss:0.021867

622 loss: 0.224934  [ 2896/ 3543]

622 class loss: 0.075691 position_loss:0.041959

652 loss: 0.352202  [ 3376/ 3543]

652 class loss: 0.131624 position_loss:0.065176

Epoch 3: train loss: 0.260754

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.110438

Epoch 3: valid_class_loss:0.038262	valid_position_loss:0.020557

Epoch 3: valid loss 0.11043801838285283 smaller than best loss 0.21775836940429968
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.02055712370859648 smaller than best position loss 0.041571483539465694
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.202107  [   16/ 3543]

663 class loss: 0.081156 position_loss:0.037175

693 loss: 0.190206  [  496/ 3543]

693 class loss: 0.060811 position_loss:0.035609

723 loss: 0.159950  [  976/ 3543]

723 class loss: 0.078223 position_loss:0.028861

753 loss: 0.214597  [ 1456/ 3543]

753 class loss: 0.117242 position_loss:0.038230

783 loss: 0.040907  [ 1936/ 3543]

783 class loss: 0.023118 position_loss:0.007257

813 loss: 0.077731  [ 2416/ 3543]

813 class loss: 0.051536 position_loss:0.013485

843 loss: 0.168517  [ 2896/ 3543]

843 class loss: 0.104280 position_loss:0.029532

873 loss: 0.120718  [ 3376/ 3543]

873 class loss: 0.070082 position_loss:0.021340

Epoch 4: train loss: 0.131295

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.074356

Epoch 4: valid_class_loss:0.032460	valid_position_loss:0.013573

Epoch 4: valid loss 0.07435634942835079 smaller than best loss 0.11043801838285283
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013572854355102896 smaller than best position loss 0.02055712370859648
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.136665  [   16/ 3543]

884 class loss: 0.087312 position_loss:0.023841

914 loss: 0.060621  [  496/ 3543]

914 class loss: 0.047246 position_loss:0.010234

944 loss: 0.100218  [  976/ 3543]

944 class loss: 0.063144 position_loss:0.017518

974 loss: 0.052589  [ 1456/ 3543]

974 class loss: 0.035557 position_loss:0.009095

1004 loss: 0.048513  [ 1936/ 3543]

1004 class loss: 0.042683 position_loss:0.007995

1034 loss: 0.068219  [ 2416/ 3543]

1034 class loss: 0.024636 position_loss:0.012658

1064 loss: 0.110792  [ 2896/ 3543]

1064 class loss: 0.086103 position_loss:0.018714

1094 loss: 0.044972  [ 3376/ 3543]

1094 class loss: 0.035569 position_loss:0.007572

Epoch 5: train loss: 0.090929

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.057254

Epoch 5: valid_class_loss:0.030961	valid_position_loss:0.010212

Epoch 5: valid loss 0.05725409069311379 smaller than best loss 0.07435634942835079
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010212371705605702 smaller than best position loss 0.013572854355102896
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.058164  [   16/ 3543]

1105 class loss: 0.081500 position_loss:0.008373

1135 loss: 0.084934  [  496/ 3543]

1135 class loss: 0.055455 position_loss:0.014769

1165 loss: 0.030052  [  976/ 3543]

1165 class loss: 0.009169 position_loss:0.005644

1195 loss: 0.034918  [ 1456/ 3543]

1195 class loss: 0.031348 position_loss:0.005730

1225 loss: 0.046914  [ 1936/ 3543]

1225 class loss: 0.049214 position_loss:0.007414

1255 loss: 0.078736  [ 2416/ 3543]

1255 class loss: 0.077032 position_loss:0.012666

1285 loss: 0.095079  [ 2896/ 3543]

1285 class loss: 0.105927 position_loss:0.014779

1315 loss: 0.073904  [ 3376/ 3543]

1315 class loss: 0.068941 position_loss:0.012023

Epoch 6: train loss: 0.074977

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.046224

Epoch 6: valid_class_loss:0.029683	valid_position_loss:0.008057

Epoch 6: valid loss 0.046223670891324856 smaller than best loss 0.05725409069311379
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.00805741786818636 smaller than best position loss 0.010212371705605702
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.102420  [   16/ 3543]

1326 class loss: 0.095419 position_loss:0.016667

1356 loss: 0.092139  [  496/ 3543]

1356 class loss: 0.066958 position_loss:0.015749

1386 loss: 0.034519  [  976/ 3543]

1386 class loss: 0.037609 position_loss:0.005400

1416 loss: 0.048942  [ 1456/ 3543]

1416 class loss: 0.058390 position_loss:0.007453

1446 loss: 0.035778  [ 1936/ 3543]

1446 class loss: 0.041862 position_loss:0.005481

1476 loss: 0.022003  [ 2416/ 3543]

1476 class loss: 0.025600 position_loss:0.003377

1506 loss: 0.026779  [ 2896/ 3543]

1506 class loss: 0.033809 position_loss:0.004003

1536 loss: 0.047830  [ 3376/ 3543]

1536 class loss: 0.026450 position_loss:0.008508

Epoch 7: train loss: 0.059354

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.041993

Epoch 7: valid_class_loss:0.030903	valid_position_loss:0.007163

Epoch 7: valid loss 0.041993390096513 smaller than best loss 0.046223670891324856
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.007162542145599364 smaller than best position loss 0.00805741786818636
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.049213  [   16/ 3543]

1547 class loss: 0.040419 position_loss:0.008226

1577 loss: 0.031166  [  496/ 3543]

1577 class loss: 0.019214 position_loss:0.005465

1607 loss: 0.069953  [  976/ 3543]

1607 class loss: 0.054819 position_loss:0.011798

1637 loss: 0.065214  [ 1456/ 3543]

1637 class loss: 0.066849 position_loss:0.010369

1667 loss: 0.094668  [ 1936/ 3543]

1667 class loss: 0.086901 position_loss:0.015458

1697 loss: 0.052140  [ 2416/ 3543]

1697 class loss: 0.051385 position_loss:0.008372

1727 loss: 0.042208  [ 2896/ 3543]

1727 class loss: 0.043259 position_loss:0.006711

1757 loss: 0.076913  [ 3376/ 3543]

1757 class loss: 0.064465 position_loss:0.012804

Epoch 8: train loss: 0.046107

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.037004

Epoch 8: valid_class_loss:0.030968	valid_position_loss:0.006162

Epoch 8: valid loss 0.03700363687071623 smaller than best loss 0.041993390096513
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006161991774885481 smaller than best position loss 0.007162542145599364
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.040411  [   16/ 3543]

1768 class loss: 0.059246 position_loss:0.005712

1798 loss: 0.033129  [  496/ 3543]

1798 class loss: 0.017412 position_loss:0.005929

1828 loss: 0.070291  [  976/ 3543]

1828 class loss: 0.088541 position_loss:0.010517

1858 loss: 0.036651  [ 1456/ 3543]

1858 class loss: 0.053243 position_loss:0.005201

1888 loss: 0.044555  [ 1936/ 3543]

1888 class loss: 0.041559 position_loss:0.007249

1918 loss: 0.048203  [ 2416/ 3543]

1918 class loss: 0.056742 position_loss:0.007371

1948 loss: 0.035038  [ 2896/ 3543]

1948 class loss: 0.050388 position_loss:0.004992

1978 loss: 0.035233  [ 3376/ 3543]

1978 class loss: 0.021059 position_loss:0.006204

Epoch 9: train loss: 0.038321

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.029651

Epoch 9: valid_class_loss:0.027576	valid_position_loss:0.004827

Epoch 9: valid loss 0.029651289070559302 smaller than best loss 0.03700363687071623
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004827231367445225 smaller than best position loss 0.006161991774885481
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.015298  [   16/ 3543]

1989 class loss: 0.022935 position_loss:0.002142

2019 loss: 0.033546  [  496/ 3543]

2019 class loss: 0.043904 position_loss:0.004953

2049 loss: 0.057275  [  976/ 3543]

2049 class loss: 0.044591 position_loss:0.009671

2079 loss: 0.011084  [ 1456/ 3543]

2079 class loss: 0.020671 position_loss:0.001390

2109 loss: 0.038235  [ 1936/ 3543]

2109 class loss: 0.063287 position_loss:0.005116

2139 loss: 0.030704  [ 2416/ 3543]

2139 class loss: 0.038063 position_loss:0.004618

2169 loss: 0.027866  [ 2896/ 3543]

2169 class loss: 0.034228 position_loss:0.004204

2199 loss: 0.041636  [ 3376/ 3543]

2199 class loss: 0.031956 position_loss:0.007049

Epoch 10: train loss: 0.033795

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.028067

Epoch 10: valid_class_loss:0.027636	valid_position_loss:0.004508

Epoch 10: valid loss 0.02806654084774794 smaller than best loss 0.029651289070559302
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004507873624340529 smaller than best position loss 0.004827231367445225
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.029700  [   16/ 3543]

2210 class loss: 0.022802 position_loss:0.005028

2240 loss: 0.041299  [  496/ 3543]

2240 class loss: 0.021254 position_loss:0.007410

2270 loss: 0.026031  [  976/ 3543]

2270 class loss: 0.043434 position_loss:0.003469

2300 loss: 0.012401  [ 1456/ 3543]

2300 class loss: 0.019263 position_loss:0.001710

2330 loss: 0.053534  [ 1936/ 3543]

2330 class loss: 0.062602 position_loss:0.008203

2360 loss: 0.051586  [ 2416/ 3543]

2360 class loss: 0.023449 position_loss:0.009379

2390 loss: 0.051794  [ 2896/ 3543]

2390 class loss: 0.058129 position_loss:0.008034

2420 loss: 0.022098  [ 3376/ 3543]

2420 class loss: 0.040242 position_loss:0.002810

Epoch 11: train loss: 0.030037

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.026005

Epoch 11: valid_class_loss:0.026071	valid_position_loss:0.004158

Epoch 11: valid loss 0.026004589669844407 smaller than best loss 0.02806654084774794
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.00415805913334343 smaller than best position loss 0.004507873624340529
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.014100  [   16/ 3543]

2431 class loss: 0.013259 position_loss:0.002290

2461 loss: 0.005612  [  496/ 3543]

2461 class loss: 0.010341 position_loss:0.000709

2491 loss: 0.011517  [  976/ 3543]

2491 class loss: 0.015804 position_loss:0.001671

2521 loss: 0.030839  [ 1456/ 3543]

2521 class loss: 0.054126 position_loss:0.004003

2551 loss: 0.007618  [ 1936/ 3543]

2551 class loss: 0.012191 position_loss:0.001036

2581 loss: 0.019596  [ 2416/ 3543]

2581 class loss: 0.031365 position_loss:0.002665

2611 loss: 0.020041  [ 2896/ 3543]

2611 class loss: 0.020885 position_loss:0.003173

2641 loss: 0.018226  [ 3376/ 3543]

2641 class loss: 0.036120 position_loss:0.002200

Epoch 12: train loss: 0.027537

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.023804

Epoch 12: valid_class_loss:0.025107	valid_position_loss:0.003756

Epoch 12: valid loss 0.023803673751207028 smaller than best loss 0.026004589669844407
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0037564392103943307 smaller than best position loss 0.00415805913334343
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.024664  [   16/ 3543]

2652 class loss: 0.031161 position_loss:0.003686

2682 loss: 0.051612  [  496/ 3543]

2682 class loss: 0.075334 position_loss:0.007309

2712 loss: 0.006386  [  976/ 3543]

2712 class loss: 0.009777 position_loss:0.000886

2742 loss: 0.026771  [ 1456/ 3543]

2742 class loss: 0.044104 position_loss:0.003590

2772 loss: 0.010933  [ 1936/ 3543]

2772 class loss: 0.018553 position_loss:0.001445

2802 loss: 0.034428  [ 2416/ 3543]

2802 class loss: 0.019783 position_loss:0.006094

2832 loss: 0.017842  [ 2896/ 3543]

2832 class loss: 0.034934 position_loss:0.002171

2862 loss: 0.011904  [ 3376/ 3543]

2862 class loss: 0.025718 position_loss:0.001352

Epoch 13: train loss: 0.025331

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.022741

Epoch 13: valid_class_loss:0.024088	valid_position_loss:0.003585

Epoch 13: valid loss 0.022741103485040992 smaller than best loss 0.023803673751207028
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0035847190479879536 smaller than best position loss 0.0037564392103943307
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.028128  [   16/ 3543]

2873 class loss: 0.049887 position_loss:0.003630

2903 loss: 0.028686  [  496/ 3543]

2903 class loss: 0.043391 position_loss:0.004002

2933 loss: 0.018279  [  976/ 3543]

2933 class loss: 0.033311 position_loss:0.002323

2963 loss: 0.034158  [ 1456/ 3543]

2963 class loss: 0.051529 position_loss:0.004770

2993 loss: 0.025477  [ 1936/ 3543]

2993 class loss: 0.049183 position_loss:0.003128

3023 loss: 0.013222  [ 2416/ 3543]

3023 class loss: 0.023196 position_loss:0.001717

3053 loss: 0.021388  [ 2896/ 3543]

3053 class loss: 0.028089 position_loss:0.003154

3083 loss: 0.013971  [ 3376/ 3543]

3083 class loss: 0.021199 position_loss:0.001946

Epoch 14: train loss: 0.023506

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.021960

Epoch 14: valid_class_loss:0.023191	valid_position_loss:0.003464

Epoch 14: valid loss 0.021960327930172815 smaller than best loss 0.022741103485040992
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0034644314387127857 smaller than best position loss 0.0035847190479879536
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.053378  [   16/ 3543]

3094 class loss: 0.064975 position_loss:0.008077

3124 loss: 0.031418  [  496/ 3543]

3124 class loss: 0.027972 position_loss:0.005165

3154 loss: 0.014612  [  976/ 3543]

3154 class loss: 0.020310 position_loss:0.002110

3184 loss: 0.019256  [ 1456/ 3543]

3184 class loss: 0.029761 position_loss:0.002661

3214 loss: 0.004572  [ 1936/ 3543]

3214 class loss: 0.008137 position_loss:0.000589

3244 loss: 0.030215  [ 2416/ 3543]

3244 class loss: 0.019819 position_loss:0.005250

3274 loss: 0.033873  [ 2896/ 3543]

3274 class loss: 0.018829 position_loss:0.006022

3304 loss: 0.022820  [ 3376/ 3543]

3304 class loss: 0.028530 position_loss:0.003423

Epoch 15: train loss: 0.022510

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.020737

Epoch 15: valid_class_loss:0.023693	valid_position_loss:0.003200

Epoch 15: valid loss 0.020736898857500054 smaller than best loss 0.021960327930172815
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0031996443891988066 smaller than best position loss 0.0034644314387127857
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__21-51-57/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.4            0.2             0.8     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.3     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.755837
Nucleus_export  0.621799
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.856418  0.135210  0.143582
Nucleus_export  0.774714  0.228134  0.225286
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.230769
Mitochondrion  0.368750
SIGNAL         0.869432
chloroplast    0.447368
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.988378                 0.905392           0.809734   
ER                   0.924119                 0.613802           0.752349   
Peroxisome           0.579639                 0.270956           0.412537   
Mitochondrion        0.869402                 0.791173           0.712370   
Nucleus_export       0.969073                 0.451332           0.466272   
SIGNAL               0.930493                 0.959419           0.695767   
chloroplast          0.865122                 0.651087           0.587093   
Thylakoid            0.986108                 0.477474           0.588309   

                recall_score  precision_score  f1_score  
Nucleus             0.875000         0.794326  0.832714  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.230769         0.750000  0.352941  
Mitochondrion       0.625000         0.892857  0.735294  
Nucleus_export      0.840000         0.280000  0.420000  
SIGNAL              0.883257         0.881902  0.882579  
chloroplast         0.657895         0.581395  0.617284  
Thylakoid           0.900000         0.391304  0.545455  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.4            0.2             0.8     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.3     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.574779
Nucleus_export  0.359534
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.657461  0.157441  0.342539
Nucleus_export  0.469524  0.206366  0.530476
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.251572
SIGNAL         0.883178
chloroplast    0.383562
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.979065                 0.877206           0.822254   
ER                   0.998524                 0.933297           0.878084   
Peroxisome           0.651562                 0.440747           0.617811   
Mitochondrion        0.851025                 0.751988           0.669563   
Nucleus_export       0.949574                 0.276594           0.350507   
SIGNAL               0.930890                 0.957566           0.717451   
chloroplast          0.939122                 0.702540           0.655635   
Thylakoid            0.993957                 0.428788           0.583557   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.804511  0.842520  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.572327         0.875000  0.692015  
Nucleus_export      0.680000         0.207317  0.317757  
SIGNAL              0.895639         0.884615  0.890093  
chloroplast         0.726027         0.638554  0.679487  
Thylakoid           1.000000         0.346154  0.514286  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.4            0.2             0.8     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.3     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.552138
Nucleus_export  0.334861
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.632668  0.151713  0.251630
Nucleus_export  0.442857  0.201200  0.237143
===========================================

 cs acc: 

                      0
ER             0.961538
Peroxisome     0.800000
Mitochondrion  0.263736
SIGNAL         0.902609
chloroplast    0.452830
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.979065                 0.877206           0.822254   
ER                   0.998524                 0.933297           0.878084   
Peroxisome           0.651562                 0.440747           0.617811   
Mitochondrion        0.851025                 0.751988           0.669563   
Nucleus_export       0.949574                 0.276594           0.350507   
SIGNAL               0.930890                 0.957566           0.717451   
chloroplast          0.939122                 0.702540           0.655635   
Thylakoid            0.993957                 0.428788           0.583557   

                recall_score  precision_score  f1_score  
Nucleus             0.884298         0.804511  0.842520  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.572327         0.875000  0.692015  
Nucleus_export      0.680000         0.207317  0.317757  
SIGNAL              0.895639         0.884615  0.890093  
chloroplast         0.726027         0.638554  0.679487  
Thylakoid           1.000000         0.346154  0.514286  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.4            0.2             0.8     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.3     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.891259
Nucleus_export  0.418803
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         1.000000  0.122273  0.000000
Nucleus_export  0.533333  0.290077  0.466667
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.8  0.4         0.4            0.2             0.8     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.3     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.891259
Nucleus_export  0.295439
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.122273  0.0
Nucleus_export  0.4  0.273915  0.4
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
