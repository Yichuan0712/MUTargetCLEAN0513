use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.126063  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.440864  [  496/ 3543]

30 class loss: 0.111590 position_loss:0.083709

60 loss: 0.087980  [  976/ 3543]

60 class loss: 0.019316 position_loss:0.016823

90 loss: 0.756274  [ 1456/ 3543]

90 class loss: 0.160152 position_loss:0.144849

120 loss: 0.609891  [ 1936/ 3543]

120 class loss: 0.120698 position_loss:0.117150

150 loss: 0.362098  [ 2416/ 3543]

150 class loss: 0.079388 position_loss:0.069244

180 loss: 0.441734  [ 2896/ 3543]

180 class loss: 0.094948 position_loss:0.084549

210 loss: 0.926752  [ 3376/ 3543]

210 class loss: 0.197297 position_loss:0.177458

Epoch 1: train loss: 0.477097

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.283546

Epoch 1: valid_class_loss:0.059160	valid_position_loss:0.054343

Epoch 1: valid loss 0.28354634050154737 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.054342872410164555 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.228530  [   16/ 3543]

221 class loss: 0.051098 position_loss:0.043662

251 loss: 0.069351  [  496/ 3543]

251 class loss: 0.015002 position_loss:0.013270

281 loss: 0.621708  [  976/ 3543]

281 class loss: 0.154254 position_loss:0.118171

311 loss: 0.567754  [ 1456/ 3543]

311 class loss: 0.133977 position_loss:0.108192

341 loss: 0.436861  [ 1936/ 3543]

341 class loss: 0.085441 position_loss:0.083955

371 loss: 0.361507  [ 2416/ 3543]

371 class loss: 0.082698 position_loss:0.068993

401 loss: 0.210592  [ 2896/ 3543]

401 class loss: 0.047243 position_loss:0.040229

431 loss: 0.314472  [ 3376/ 3543]

431 class loss: 0.067955 position_loss:0.060176

Epoch 2: train loss: 0.415138

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.217758

Epoch 2: valid_class_loss:0.049505	valid_position_loss:0.041571

Epoch 2: valid loss 0.21775836940429968 smaller than best loss 0.28354634050154737
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.041571483539465694 smaller than best position loss 0.054342872410164555
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.480147  [   16/ 3543]

442 class loss: 0.111127 position_loss:0.091584

472 loss: 0.249695  [  496/ 3543]

472 class loss: 0.063901 position_loss:0.047383

502 loss: 0.364941  [  976/ 3543]

502 class loss: 0.081105 position_loss:0.069744

532 loss: 0.172369  [ 1456/ 3543]

532 class loss: 0.044235 position_loss:0.032704

562 loss: 0.368452  [ 1936/ 3543]

562 class loss: 0.111596 position_loss:0.069227

592 loss: 0.114864  [ 2416/ 3543]

592 class loss: 0.027655 position_loss:0.021867

622 loss: 0.224934  [ 2896/ 3543]

622 class loss: 0.075691 position_loss:0.041959

652 loss: 0.352202  [ 3376/ 3543]

652 class loss: 0.131624 position_loss:0.065176

Epoch 3: train loss: 0.260754

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.110438

Epoch 3: valid_class_loss:0.038262	valid_position_loss:0.020557

Epoch 3: valid loss 0.11043801838285283 smaller than best loss 0.21775836940429968
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.02055712370859648 smaller than best position loss 0.041571483539465694
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.202107  [   16/ 3543]

663 class loss: 0.081156 position_loss:0.037175

693 loss: 0.190206  [  496/ 3543]

693 class loss: 0.060811 position_loss:0.035609

723 loss: 0.159950  [  976/ 3543]

723 class loss: 0.078223 position_loss:0.028861

753 loss: 0.214597  [ 1456/ 3543]

753 class loss: 0.117242 position_loss:0.038230

783 loss: 0.040907  [ 1936/ 3543]

783 class loss: 0.023118 position_loss:0.007257

813 loss: 0.077731  [ 2416/ 3543]

813 class loss: 0.051536 position_loss:0.013485

843 loss: 0.168517  [ 2896/ 3543]

843 class loss: 0.104280 position_loss:0.029532

873 loss: 0.120718  [ 3376/ 3543]

873 class loss: 0.070082 position_loss:0.021340

Epoch 4: train loss: 0.131295

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.074356

Epoch 4: valid_class_loss:0.032460	valid_position_loss:0.013573

Epoch 4: valid loss 0.07435634942835079 smaller than best loss 0.11043801838285283
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013572854355102896 smaller than best position loss 0.02055712370859648
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.136665  [   16/ 3543]

884 class loss: 0.087312 position_loss:0.023841

914 loss: 0.060621  [  496/ 3543]

914 class loss: 0.047246 position_loss:0.010234

944 loss: 0.100218  [  976/ 3543]

944 class loss: 0.063144 position_loss:0.017518

974 loss: 0.052589  [ 1456/ 3543]

974 class loss: 0.035557 position_loss:0.009095

1004 loss: 0.048513  [ 1936/ 3543]

1004 class loss: 0.042683 position_loss:0.007995

1034 loss: 0.068217  [ 2416/ 3543]

1034 class loss: 0.024636 position_loss:0.012658

1064 loss: 0.110795  [ 2896/ 3543]

1064 class loss: 0.086104 position_loss:0.018715

1094 loss: 0.044974  [ 3376/ 3543]

1094 class loss: 0.035569 position_loss:0.007572

Epoch 5: train loss: 0.090929

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.057257

Epoch 5: valid_class_loss:0.030961	valid_position_loss:0.010213

Epoch 5: valid loss 0.05725673999615474 smaller than best loss 0.07435634942835079
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010212909826393994 smaller than best position loss 0.013572854355102896
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.058172  [   16/ 3543]

1105 class loss: 0.081517 position_loss:0.008374

1135 loss: 0.084932  [  496/ 3543]

1135 class loss: 0.055456 position_loss:0.014768

1165 loss: 0.030059  [  976/ 3543]

1165 class loss: 0.009169 position_loss:0.005645

1195 loss: 0.034934  [ 1456/ 3543]

1195 class loss: 0.031357 position_loss:0.005733

1225 loss: 0.046935  [ 1936/ 3543]

1225 class loss: 0.049211 position_loss:0.007419

1255 loss: 0.078822  [ 2416/ 3543]

1255 class loss: 0.077164 position_loss:0.012678

1285 loss: 0.095285  [ 2896/ 3543]

1285 class loss: 0.106215 position_loss:0.014808

1315 loss: 0.074022  [ 3376/ 3543]

1315 class loss: 0.068977 position_loss:0.012045

Epoch 6: train loss: 0.075033

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.046347

Epoch 6: valid_class_loss:0.029722	valid_position_loss:0.008081

Epoch 6: valid loss 0.0463469743672313 smaller than best loss 0.05725673999615474
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.00808052906824926 smaller than best position loss 0.010212909826393994
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.102822  [   16/ 3543]

1326 class loss: 0.095632 position_loss:0.016739

1356 loss: 0.092602  [  496/ 3543]

1356 class loss: 0.067180 position_loss:0.015833

1386 loss: 0.034757  [  976/ 3543]

1386 class loss: 0.037759 position_loss:0.005441

1416 loss: 0.049180  [ 1456/ 3543]

1416 class loss: 0.058437 position_loss:0.007499

1446 loss: 0.036090  [ 1936/ 3543]

1446 class loss: 0.041924 position_loss:0.005541

1476 loss: 0.022228  [ 2416/ 3543]

1476 class loss: 0.025772 position_loss:0.003415

1506 loss: 0.027114  [ 2896/ 3543]

1506 class loss: 0.034028 position_loss:0.004062

1536 loss: 0.048497  [ 3376/ 3543]

1536 class loss: 0.026304 position_loss:0.008647

Epoch 7: train loss: 0.059758

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.042519

Epoch 7: valid_class_loss:0.030838	valid_position_loss:0.007270

Epoch 7: valid loss 0.042519483676216045 smaller than best loss 0.0463469743672313
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.00727038911064331 smaller than best position loss 0.00808052906824926
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.049789  [   16/ 3543]

1547 class loss: 0.040690 position_loss:0.008330

1577 loss: 0.031765  [  496/ 3543]

1577 class loss: 0.019174 position_loss:0.005586

1607 loss: 0.071156  [  976/ 3543]

1607 class loss: 0.054886 position_loss:0.012036

1637 loss: 0.066549  [ 1456/ 3543]

1637 class loss: 0.067501 position_loss:0.010610

1667 loss: 0.096177  [ 1936/ 3543]

1667 class loss: 0.088014 position_loss:0.015715

1697 loss: 0.053351  [ 2416/ 3543]

1697 class loss: 0.051687 position_loss:0.008603

1727 loss: 0.043590  [ 2896/ 3543]

1727 class loss: 0.043945 position_loss:0.006960

1757 loss: 0.078263  [ 3376/ 3543]

1757 class loss: 0.065254 position_loss:0.013042

Epoch 8: train loss: 0.047025

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.037408

Epoch 8: valid_class_loss:0.030934	valid_position_loss:0.006244

Epoch 8: valid loss 0.037408178803464885 smaller than best loss 0.042519483676216045
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.006244294102635718 smaller than best position loss 0.00727038911064331
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.041749  [   16/ 3543]

1768 class loss: 0.059971 position_loss:0.005951

1798 loss: 0.033381  [  496/ 3543]

1798 class loss: 0.017593 position_loss:0.005973

1828 loss: 0.072737  [  976/ 3543]

1828 class loss: 0.089889 position_loss:0.010952

1858 loss: 0.038027  [ 1456/ 3543]

1858 class loss: 0.054464 position_loss:0.005427

1888 loss: 0.046489  [ 1936/ 3543]

1888 class loss: 0.042672 position_loss:0.007591

1918 loss: 0.050158  [ 2416/ 3543]

1918 class loss: 0.058088 position_loss:0.007708

1948 loss: 0.037136  [ 2896/ 3543]

1948 class loss: 0.052389 position_loss:0.005332

1978 loss: 0.037112  [ 3376/ 3543]

1978 class loss: 0.021656 position_loss:0.006556

Epoch 9: train loss: 0.039886

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.031214

Epoch 9: valid_class_loss:0.028247	valid_position_loss:0.005113

Epoch 9: valid loss 0.031214029798972476 smaller than best loss 0.037408178803464885
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.005112913059322907 smaller than best position loss 0.006244294102635718
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.016146  [   16/ 3543]

1989 class loss: 0.023628 position_loss:0.002284

2019 loss: 0.035516  [  496/ 3543]

2019 class loss: 0.046275 position_loss:0.005252

2049 loss: 0.061036  [  976/ 3543]

2049 class loss: 0.043711 position_loss:0.010459

2079 loss: 0.011810  [ 1456/ 3543]

2079 class loss: 0.021243 position_loss:0.001512

2109 loss: 0.039062  [ 1936/ 3543]

2109 class loss: 0.062465 position_loss:0.005314

2139 loss: 0.033862  [ 2416/ 3543]

2139 class loss: 0.039524 position_loss:0.005191

2169 loss: 0.030549  [ 2896/ 3543]

2169 class loss: 0.037102 position_loss:0.004626

2199 loss: 0.043677  [ 3376/ 3543]

2199 class loss: 0.033588 position_loss:0.007392

Epoch 10: train loss: 0.036009

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.030554

Epoch 10: valid_class_loss:0.028693	valid_position_loss:0.004963

Epoch 10: valid loss 0.030553836010278824 smaller than best loss 0.031214029798972476
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004963039672246076 smaller than best position loss 0.005112913059322907
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.033074  [   16/ 3543]

2210 class loss: 0.023951 position_loss:0.005657

2240 loss: 0.042650  [  496/ 3543]

2240 class loss: 0.022432 position_loss:0.007633

2270 loss: 0.028501  [  976/ 3543]

2270 class loss: 0.047041 position_loss:0.003819

2300 loss: 0.013386  [ 1456/ 3543]

2300 class loss: 0.019789 position_loss:0.001886

2330 loss: 0.058122  [ 1936/ 3543]

2330 class loss: 0.067111 position_loss:0.008940

2360 loss: 0.051626  [ 2416/ 3543]

2360 class loss: 0.025052 position_loss:0.009323

2390 loss: 0.055807  [ 2896/ 3543]

2390 class loss: 0.063458 position_loss:0.008623

2420 loss: 0.024265  [ 3376/ 3543]

2420 class loss: 0.041955 position_loss:0.003175

Epoch 11: train loss: 0.033057

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.028632

Epoch 11: valid_class_loss:0.027371	valid_position_loss:0.004632

Epoch 11: valid loss 0.02863184108520606 smaller than best loss 0.030553836010278824
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.004631539180017783 smaller than best position loss 0.004963039672246076
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.014802  [   16/ 3543]

2431 class loss: 0.014001 position_loss:0.002400

2461 loss: 0.006227  [  496/ 3543]

2461 class loss: 0.010918 position_loss:0.000809

2491 loss: 0.012522  [  976/ 3543]

2491 class loss: 0.016466 position_loss:0.001846

2521 loss: 0.036571  [ 1456/ 3543]

2521 class loss: 0.062630 position_loss:0.004809

2551 loss: 0.008463  [ 1936/ 3543]

2551 class loss: 0.012789 position_loss:0.001181

2581 loss: 0.022698  [ 2416/ 3543]

2581 class loss: 0.034761 position_loss:0.003149

2611 loss: 0.023378  [ 2896/ 3543]

2611 class loss: 0.022739 position_loss:0.003766

2641 loss: 0.021712  [ 3376/ 3543]

2641 class loss: 0.040000 position_loss:0.002742

Epoch 12: train loss: 0.031380

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.027075

Epoch 12: valid_class_loss:0.026865	valid_position_loss:0.004341

Epoch 12: valid loss 0.02707548797740587 smaller than best loss 0.02863184108520606
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.004340516269292701 smaller than best position loss 0.004631539180017783
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.030114  [   16/ 3543]

2652 class loss: 0.033432 position_loss:0.004686

2682 loss: 0.057735  [  496/ 3543]

2682 class loss: 0.078415 position_loss:0.008410

2712 loss: 0.007430  [  976/ 3543]

2712 class loss: 0.010496 position_loss:0.001066

2742 loss: 0.031457  [ 1456/ 3543]

2742 class loss: 0.048143 position_loss:0.004366

2772 loss: 0.013489  [ 1936/ 3543]

2772 class loss: 0.021194 position_loss:0.001850

2802 loss: 0.034679  [ 2416/ 3543]

2802 class loss: 0.019804 position_loss:0.006144

2832 loss: 0.020618  [ 2896/ 3543]

2832 class loss: 0.037659 position_loss:0.002617

2862 loss: 0.014029  [ 3376/ 3543]

2862 class loss: 0.028216 position_loss:0.001677

Epoch 13: train loss: 0.030013

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.026991

Epoch 13: valid_class_loss:0.026686	valid_position_loss:0.004331

Epoch 13: valid loss 0.026990815499219636 smaller than best loss 0.02707548797740587
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0043307050085863155 smaller than best position loss 0.004340516269292701
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.036549  [   16/ 3543]

2873 class loss: 0.062065 position_loss:0.004827

2903 loss: 0.033401  [  496/ 3543]

2903 class loss: 0.050319 position_loss:0.004668

2933 loss: 0.021242  [  976/ 3543]

2933 class loss: 0.038081 position_loss:0.002725

2963 loss: 0.040814  [ 1456/ 3543]

2963 class loss: 0.059102 position_loss:0.005799

2993 loss: 0.032064  [ 1936/ 3543]

2993 class loss: 0.055994 position_loss:0.004173

3023 loss: 0.016569  [ 2416/ 3543]

3023 class loss: 0.026535 position_loss:0.002252

3053 loss: 0.027239  [ 2896/ 3543]

3053 class loss: 0.031453 position_loss:0.004190

3083 loss: 0.018172  [ 3376/ 3543]

3083 class loss: 0.023882 position_loss:0.002679

Epoch 14: train loss: 0.029165

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.026184

Epoch 14: valid_class_loss:0.026070	valid_position_loss:0.004194

Epoch 14: valid loss 0.026183734114878742 smaller than best loss 0.026990815499219636
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.004193931220255155 smaller than best position loss 0.0043307050085863155
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.065996  [   16/ 3543]

3094 class loss: 0.081598 position_loss:0.009935

3124 loss: 0.039908  [  496/ 3543]

3124 class loss: 0.034427 position_loss:0.006604

3154 loss: 0.019572  [  976/ 3543]

3154 class loss: 0.023540 position_loss:0.002973

3184 loss: 0.025881  [ 1456/ 3543]

3184 class loss: 0.039329 position_loss:0.003603

3214 loss: 0.005796  [ 1936/ 3543]

3214 class loss: 0.009833 position_loss:0.000766

3244 loss: 0.037642  [ 2416/ 3543]

3244 class loss: 0.022213 position_loss:0.006640

3274 loss: 0.045447  [ 2896/ 3543]

3274 class loss: 0.019141 position_loss:0.008324

3304 loss: 0.031369  [ 3376/ 3543]

3304 class loss: 0.032942 position_loss:0.004956

Epoch 15: train loss: 0.028949

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.025201

Epoch 15: valid_class_loss:0.026108	valid_position_loss:0.003996

Epoch 15: valid loss 0.025201273473361062 smaller than best loss 0.026183734114878742
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.00399593427542576 smaller than best position loss 0.004193931220255155
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0703/2024-07-03__14-35-53/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.1             0.9     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.726163
Nucleus_export  0.583524
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.845649  0.168013  0.154351
Nucleus_export  0.750000  0.257435  0.250000
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.387500
SIGNAL         0.850998
chloroplast    0.526316
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.987532                 0.897302           0.828187   
ER                   0.906402                 0.607377           0.743803   
Peroxisome           0.488109                 0.108596           0.275776   
Mitochondrion        0.646240                 0.307080           0.059863   
Nucleus_export       0.962857                 0.420259           0.468804   
SIGNAL               0.877071                 0.927693           0.594840   
chloroplast          0.803313                 0.459484           0.492945   
Thylakoid            0.953949                 0.407240           0.488558   

                recall_score  precision_score  f1_score  
Nucleus             0.929688         0.777778  0.846975  
ER                  0.800000         0.705882  0.750000  
Peroxisome          0.076923         1.000000  0.142857  
Mitochondrion       0.837500         0.162228  0.271805  
Nucleus_export      0.760000         0.311475  0.441860  
SIGNAL              0.768049         0.884956  0.822368  
chloroplast         0.486842         0.569231  0.524823  
Thylakoid           0.700000         0.350000  0.466667  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.1             0.9     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.539664
Nucleus_export  0.328907
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.634344  0.196549  0.365656
Nucleus_export  0.465238  0.284893  0.534762
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.232704
SIGNAL         0.883178
chloroplast    0.424658
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.975604                 0.863374           0.798069   
ER                   0.989937                 0.886189           0.806167   
Peroxisome           0.429708                 0.242856           0.478100   
Mitochondrion        0.605756                 0.281424           0.019340   
Nucleus_export       0.947016                 0.278174           0.331303   
SIGNAL               0.873130                 0.921495           0.622138   
chloroplast          0.873483                 0.495464           0.535994   
Thylakoid            0.993639                 0.488832           0.563497   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.751724  0.819549  
ER                  0.689655         0.952381  0.800000  
Peroxisome          0.230769         1.000000  0.375000  
Mitochondrion       0.805031         0.154031  0.258586  
Nucleus_export      0.600000         0.211268  0.312500  
SIGNAL              0.780374         0.893048  0.832918  
chloroplast         0.534247         0.600000  0.565217  
Thylakoid           0.888889         0.363636  0.516129  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.1             0.9     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.516281
Nucleus_export  0.271298
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.609551  0.192664  0.291276
Nucleus_export  0.380000  0.223596  0.220000
===========================================

 cs acc: 

                      0
ER             0.950000
Peroxisome     1.000000
Mitochondrion  0.257812
SIGNAL         0.904192
chloroplast    0.410256
Thylakoid      0.750000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.975604                 0.863374           0.798069   
ER                   0.989937                 0.886189           0.806167   
Peroxisome           0.429708                 0.242856           0.478100   
Mitochondrion        0.605756                 0.281424           0.019340   
Nucleus_export       0.947016                 0.278174           0.331303   
SIGNAL               0.873130                 0.921495           0.622138   
chloroplast          0.873483                 0.495464           0.535994   
Thylakoid            0.993639                 0.488832           0.563497   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.751724  0.819549  
ER                  0.689655         0.952381  0.800000  
Peroxisome          0.230769         1.000000  0.375000  
Mitochondrion       0.805031         0.154031  0.258586  
Nucleus_export      0.600000         0.211268  0.312500  
SIGNAL              0.780374         0.893048  0.832918  
chloroplast         0.534247         0.600000  0.565217  
Thylakoid           0.888889         0.363636  0.516129  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.1             0.9     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.814776
Nucleus_export  0.365787
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         1.000000  0.228639  0.000000
Nucleus_export  0.533333  0.467126  0.466667
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                      0.7                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.5         0.5            0.1             0.9     0.2   
cutoffs_aa       0.4  0.1         0.1            0.1             0.4     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.814776
Nucleus_export  0.279512
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.228639  0.0
Nucleus_export  0.4  0.358035  0.4
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                      0.7                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.8              1.0  0.888889  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
