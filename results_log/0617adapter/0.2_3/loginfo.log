use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

trainable params: 55929656 || all params: 667618030 || trainable%: 8.377493340016596

Done initialize model

Done initialize tokenizer

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.442984  [   16/ 3543]

0 class loss: 0.079878 position_loss:0.083272

30 loss: 0.522255  [  496/ 3543]

30 class loss: 0.098705 position_loss:0.097871

60 loss: 0.307085  [  976/ 3543]

60 class loss: 0.063755 position_loss:0.057167

90 loss: 0.656262  [ 1456/ 3543]

90 class loss: 0.132625 position_loss:0.122411

120 loss: 0.140713  [ 1936/ 3543]

120 class loss: 0.031020 position_loss:0.026075

150 loss: 0.481241  [ 2416/ 3543]

150 class loss: 0.111645 position_loss:0.088805

180 loss: 0.149072  [ 2896/ 3543]

180 class loss: 0.042374 position_loss:0.026990

210 loss: 0.282469  [ 3376/ 3543]

210 class loss: 0.067140 position_loss:0.052018

Epoch 1: train loss: 0.401886

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.183913

Epoch 1: valid_class_loss:0.050799	valid_position_loss:0.033396

Epoch 1: valid loss 0.1839131874688058 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.03339604665868324 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.187060  [   16/ 3543]

221 class loss: 0.057536 position_loss:0.033576

251 loss: 0.153925  [  496/ 3543]

251 class loss: 0.051575 position_loss:0.027347

281 loss: 0.141870  [  976/ 3543]

281 class loss: 0.046110 position_loss:0.025300

311 loss: 0.063678  [ 1456/ 3543]

311 class loss: 0.024670 position_loss:0.011091

341 loss: 0.345061  [ 1936/ 3543]

341 class loss: 0.147328 position_loss:0.059190

371 loss: 0.163458  [ 2416/ 3543]

371 class loss: 0.073545 position_loss:0.027789

401 loss: 0.134697  [ 2896/ 3543]

401 class loss: 0.069153 position_loss:0.022329

431 loss: 0.236680  [ 3376/ 3543]

431 class loss: 0.124259 position_loss:0.039052

Epoch 2: train loss: 0.203383

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.099376

Epoch 2: valid_class_loss:0.043956	valid_position_loss:0.016945

Epoch 2: valid loss 0.09937580108819917 smaller than best loss 0.1839131874688058
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.01694473805414217 smaller than best position loss 0.03339604665868324
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.148167  [   16/ 3543]

442 class loss: 0.078252 position_loss:0.024417

472 loss: 0.256049  [  496/ 3543]

472 class loss: 0.139539 position_loss:0.041907

502 loss: 0.099450  [  976/ 3543]

502 class loss: 0.059733 position_loss:0.015908

532 loss: 0.201158  [ 1456/ 3543]

532 class loss: 0.101791 position_loss:0.033446

562 loss: 0.132476  [ 1936/ 3543]

562 class loss: 0.086301 position_loss:0.020742

592 loss: 0.084498  [ 2416/ 3543]

592 class loss: 0.038870 position_loss:0.014308

622 loss: 0.097147  [ 2896/ 3543]

622 class loss: 0.063990 position_loss:0.015163

652 loss: 0.024533  [ 3376/ 3543]

652 class loss: 0.017498 position_loss:0.003740

Epoch 3: train loss: 0.122534

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.070904

Epoch 3: valid_class_loss:0.037941	valid_position_loss:0.011651

Epoch 3: valid loss 0.07090350839363545 smaller than best loss 0.09937580108819917
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.011651327658033213 smaller than best position loss 0.01694473805414217
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.121229  [   16/ 3543]

663 class loss: 0.072202 position_loss:0.019432

693 loss: 0.026638  [  496/ 3543]

693 class loss: 0.017612 position_loss:0.004153

723 loss: 0.114499  [  976/ 3543]

723 class loss: 0.051886 position_loss:0.019441

753 loss: 0.071800  [ 1456/ 3543]

753 class loss: 0.052431 position_loss:0.010865

783 loss: 0.060798  [ 1936/ 3543]

783 class loss: 0.044691 position_loss:0.009180

813 loss: 0.023255  [ 2416/ 3543]

813 class loss: 0.014343 position_loss:0.003695

843 loss: 0.025902  [ 2896/ 3543]

843 class loss: 0.016840 position_loss:0.004058

873 loss: 0.098793  [ 3376/ 3543]

873 class loss: 0.080939 position_loss:0.014363

Epoch 4: train loss: 0.094639

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.057069

Epoch 4: valid_class_loss:0.034114	valid_position_loss:0.009139

Epoch 4: valid loss 0.05706860857181282 smaller than best loss 0.07090350839363545
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.009139454718739646 smaller than best position loss 0.011651327658033213
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.151154  [   16/ 3543]

884 class loss: 0.123323 position_loss:0.022009

914 loss: 0.053273  [  496/ 3543]

914 class loss: 0.045359 position_loss:0.007631

944 loss: 0.015836  [  976/ 3543]

944 class loss: 0.013201 position_loss:0.002287

974 loss: 0.030425  [ 1456/ 3543]

974 class loss: 0.022815 position_loss:0.004564

1004 loss: 0.082853  [ 1936/ 3543]

1004 class loss: 0.052140 position_loss:0.013095

1034 loss: 0.099054  [ 2416/ 3543]

1034 class loss: 0.085168 position_loss:0.014133

1064 loss: 0.024458  [ 2896/ 3543]

1064 class loss: 0.020787 position_loss:0.003506

1094 loss: 0.028335  [ 3376/ 3543]

1094 class loss: 0.020026 position_loss:0.004332

Epoch 5: train loss: 0.080177

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.050680

Epoch 5: valid_class_loss:0.033632	valid_position_loss:0.007894

Epoch 5: valid loss 0.05068009905781363 smaller than best loss 0.05706860857181282
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.00789387823709412 smaller than best position loss 0.009139454718739646
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.027519  [   16/ 3543]

1105 class loss: 0.013581 position_loss:0.004598

1135 loss: 0.055323  [  496/ 3543]

1135 class loss: 0.056060 position_loss:0.007327

1165 loss: 0.020049  [  976/ 3543]

1165 class loss: 0.010679 position_loss:0.003298

1195 loss: 0.066495  [ 1456/ 3543]

1195 class loss: 0.031339 position_loss:0.011210

1225 loss: 0.090657  [ 1936/ 3543]

1225 class loss: 0.086748 position_loss:0.012348

1255 loss: 0.055664  [ 2416/ 3543]

1255 class loss: 0.052122 position_loss:0.007658

1285 loss: 0.067425  [ 2896/ 3543]

1285 class loss: 0.055759 position_loss:0.009768

1315 loss: 0.052005  [ 3376/ 3543]

1315 class loss: 0.048533 position_loss:0.007166

Epoch 6: train loss: 0.067829

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.041791

Epoch 6: valid_class_loss:0.031719	valid_position_loss:0.006244

Epoch 6: valid loss 0.04179135015366153 smaller than best loss 0.05068009905781363
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.006243658039722871 smaller than best position loss 0.00789387823709412
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.094061  [   16/ 3543]

1326 class loss: 0.090060 position_loss:0.012808

1356 loss: 0.011077  [  496/ 3543]

1356 class loss: 0.012582 position_loss:0.001376

1386 loss: 0.050217  [  976/ 3543]

1386 class loss: 0.037917 position_loss:0.007516

1416 loss: 0.073514  [ 1456/ 3543]

1416 class loss: 0.065319 position_loss:0.010348

1446 loss: 0.057217  [ 1936/ 3543]

1446 class loss: 0.039528 position_loss:0.008808

1476 loss: 0.081965  [ 2416/ 3543]

1476 class loss: 0.072149 position_loss:0.011583

1506 loss: 0.043347  [ 2896/ 3543]

1506 class loss: 0.035133 position_loss:0.006327

1536 loss: 0.043028  [ 3376/ 3543]

1536 class loss: 0.048167 position_loss:0.005394

Epoch 7: train loss: 0.056874

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.036522

Epoch 7: valid_class_loss:0.030944	valid_position_loss:0.005241

Epoch 7: valid loss 0.036521632283721524 smaller than best loss 0.04179135015366153
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.0052413991342190195 smaller than best position loss 0.006243658039722871
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.059519  [   16/ 3543]

1547 class loss: 0.063402 position_loss:0.007677

1577 loss: 0.042261  [  496/ 3543]

1577 class loss: 0.035812 position_loss:0.006065

1607 loss: 0.069121  [  976/ 3543]

1607 class loss: 0.060382 position_loss:0.009799

1637 loss: 0.013401  [ 1456/ 3543]

1637 class loss: 0.014316 position_loss:0.001726

1667 loss: 0.035684  [ 1936/ 3543]

1667 class loss: 0.030614 position_loss:0.005096

1697 loss: 0.082026  [ 2416/ 3543]

1697 class loss: 0.066470 position_loss:0.011974

1727 loss: 0.088270  [ 2896/ 3543]

1727 class loss: 0.060033 position_loss:0.013652

1757 loss: 0.068152  [ 3376/ 3543]

1757 class loss: 0.055529 position_loss:0.009929

Epoch 8: train loss: 0.049282

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.033106

Epoch 8: valid_class_loss:0.030352	valid_position_loss:0.004598

Epoch 8: valid loss 0.03310585800876356 smaller than best loss 0.036521632283721524
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.004597698382246755 smaller than best position loss 0.0052413991342190195
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.058476  [   16/ 3543]

1768 class loss: 0.067107 position_loss:0.007221

1798 loss: 0.052599  [  496/ 3543]

1798 class loss: 0.049814 position_loss:0.007199

1828 loss: 0.033949  [  976/ 3543]

1828 class loss: 0.037313 position_loss:0.004302

1858 loss: 0.016844  [ 1456/ 3543]

1858 class loss: 0.023669 position_loss:0.001791

1888 loss: 0.048027  [ 1936/ 3543]

1888 class loss: 0.044023 position_loss:0.006670

1918 loss: 0.029672  [ 2416/ 3543]

1918 class loss: 0.038183 position_loss:0.003389

1948 loss: 0.048618  [ 2896/ 3543]

1948 class loss: 0.055182 position_loss:0.006045

1978 loss: 0.057060  [ 3376/ 3543]

1978 class loss: 0.072515 position_loss:0.006578

Epoch 9: train loss: 0.043245

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.031242

Epoch 9: valid_class_loss:0.029854	valid_position_loss:0.004258

Epoch 9: valid loss 0.031241521626491044 smaller than best loss 0.03310585800876356
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004258050347757602 smaller than best position loss 0.004597698382246755
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.049432  [   16/ 3543]

1989 class loss: 0.062054 position_loss:0.005749

2019 loss: 0.048608  [  496/ 3543]

2019 class loss: 0.063229 position_loss:0.005506

2049 loss: 0.040102  [  976/ 3543]

2049 class loss: 0.051438 position_loss:0.004591

2079 loss: 0.039237  [ 1456/ 3543]

2079 class loss: 0.041234 position_loss:0.005099

2109 loss: 0.043030  [ 1936/ 3543]

2109 class loss: 0.052866 position_loss:0.005082

2139 loss: 0.017840  [ 2416/ 3543]

2139 class loss: 0.023486 position_loss:0.002002

2169 loss: 0.040005  [ 2896/ 3543]

2169 class loss: 0.057878 position_loss:0.004142

2199 loss: 0.040906  [ 3376/ 3543]

2199 class loss: 0.048699 position_loss:0.004935

Epoch 10: train loss: 0.039543

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.028246

Epoch 10: valid_class_loss:0.029395	valid_position_loss:0.003689

Epoch 10: valid loss 0.028245624361538345 smaller than best loss 0.031241521626491044
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.0036894833415548993 smaller than best position loss 0.004258050347757602
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.048410  [   16/ 3543]

2210 class loss: 0.057642 position_loss:0.005839

2240 loss: 0.052325  [  496/ 3543]

2240 class loss: 0.067322 position_loss:0.005977

2270 loss: 0.030343  [  976/ 3543]

2270 class loss: 0.030581 position_loss:0.004030

2300 loss: 0.064645  [ 1456/ 3543]

2300 class loss: 0.068166 position_loss:0.008385

2330 loss: 0.062173  [ 1936/ 3543]

2330 class loss: 0.073127 position_loss:0.007560

2360 loss: 0.032880  [ 2416/ 3543]

2360 class loss: 0.043075 position_loss:0.003704

2390 loss: 0.034096  [ 2896/ 3543]

2390 class loss: 0.045935 position_loss:0.003757

2420 loss: 0.011902  [ 3376/ 3543]

2420 class loss: 0.018680 position_loss:0.001135

Epoch 11: train loss: 0.036024

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.027414

Epoch 11: valid_class_loss:0.029119	valid_position_loss:0.003542

Epoch 11: valid loss 0.027414488412482653 smaller than best loss 0.028245624361538345
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0035416042662538404 smaller than best position loss 0.0036894833415548993
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.019643  [   16/ 3543]

2431 class loss: 0.027600 position_loss:0.002089

2461 loss: 0.054607  [  496/ 3543]

2461 class loss: 0.059016 position_loss:0.006987

2491 loss: 0.029935  [  976/ 3543]

2491 class loss: 0.040177 position_loss:0.003309

2521 loss: 0.028190  [ 1456/ 3543]

2521 class loss: 0.046812 position_loss:0.002517

2551 loss: 0.027563  [ 1936/ 3543]

2551 class loss: 0.028888 position_loss:0.003587

2581 loss: 0.033056  [ 2416/ 3543]

2581 class loss: 0.042647 position_loss:0.003768

2611 loss: 0.055532  [ 2896/ 3543]

2611 class loss: 0.065009 position_loss:0.006772

2641 loss: 0.028918  [ 3376/ 3543]

2641 class loss: 0.039421 position_loss:0.003155

Epoch 12: train loss: 0.032784

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.025163

Epoch 12: valid_class_loss:0.028397	valid_position_loss:0.003139

Epoch 12: valid loss 0.02516290126382395 smaller than best loss 0.027414488412482653
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0031394518953366435 smaller than best position loss 0.0035416042662538404
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.043542  [   16/ 3543]

2652 class loss: 0.045370 position_loss:0.005684

2682 loss: 0.013600  [  496/ 3543]

2682 class loss: 0.019469 position_loss:0.001422

2712 loss: 0.035098  [  976/ 3543]

2712 class loss: 0.054516 position_loss:0.003385

2742 loss: 0.017172  [ 1456/ 3543]

2742 class loss: 0.023548 position_loss:0.001865

2772 loss: 0.048991  [ 1936/ 3543]

2772 class loss: 0.068458 position_loss:0.005234

2802 loss: 0.038315  [ 2416/ 3543]

2802 class loss: 0.058789 position_loss:0.003744

2832 loss: 0.043462  [ 2896/ 3543]

2832 class loss: 0.045831 position_loss:0.005637

2862 loss: 0.024119  [ 3376/ 3543]

2862 class loss: 0.039119 position_loss:0.002216

Epoch 13: train loss: 0.030012

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.025230

Epoch 13: valid_class_loss:0.027607	valid_position_loss:0.003206

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.021387  [   16/ 3543]

2873 class loss: 0.030331 position_loss:0.002255

2903 loss: 0.051364  [  496/ 3543]

2903 class loss: 0.061199 position_loss:0.006193

2933 loss: 0.020735  [  976/ 3543]

2933 class loss: 0.031786 position_loss:0.002028

2963 loss: 0.012486  [ 1456/ 3543]

2963 class loss: 0.022713 position_loss:0.000983

2993 loss: 0.037176  [ 1936/ 3543]

2993 class loss: 0.050064 position_loss:0.004098

3023 loss: 0.043296  [ 2416/ 3543]

3023 class loss: 0.052365 position_loss:0.005168

3053 loss: 0.007868  [ 2896/ 3543]

3053 class loss: 0.015109 position_loss:0.000566

3083 loss: 0.015376  [ 3376/ 3543]

3083 class loss: 0.022398 position_loss:0.001582

Epoch 14: train loss: 0.026961

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.024045

Epoch 14: valid_class_loss:0.026447	valid_position_loss:0.003046

Epoch 14: valid loss 0.024045265275646776 smaller than best loss 0.02516290126382395
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.0030459469201248673 smaller than best position loss 0.0031394518953366435
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.021690  [   16/ 3543]

3094 class loss: 0.032583 position_loss:0.002166

3124 loss: 0.010328  [  496/ 3543]

3124 class loss: 0.018875 position_loss:0.000807

3154 loss: 0.018158  [  976/ 3543]

3154 class loss: 0.030544 position_loss:0.001595

3184 loss: 0.037927  [ 1456/ 3543]

3184 class loss: 0.056174 position_loss:0.003841

3214 loss: 0.032444  [ 1936/ 3543]

3214 class loss: 0.061414 position_loss:0.002395

3244 loss: 0.028705  [ 2416/ 3543]

3244 class loss: 0.019520 position_loss:0.004440

3274 loss: 0.040845  [ 2896/ 3543]

3274 class loss: 0.035871 position_loss:0.005778

3304 loss: 0.026630  [ 3376/ 3543]

3304 class loss: 0.047332 position_loss:0.002171

Epoch 15: train loss: 0.025197

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.024626

Epoch 15: valid_class_loss:0.026612	valid_position_loss:0.003151

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0617_1/2024-06-18__02-33-14/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.3  0.1         0.3            0.1             0.4     0.1   
cutoffs_aa       0.3  0.1         0.1            0.1             0.5     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.2        0.6  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.788213
Nucleus_export  0.664240
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.925741  0.179141  0.074259
Nucleus_export  0.780323  0.155371  0.219677
===========================================

 cs acc: 

                      0
ER             0.600000
Peroxisome     0.153846
Mitochondrion  0.500000
SIGNAL         0.847926
chloroplast    0.460526
Thylakoid      0.900000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.927519                 0.676037           0.689998   
ER                   0.681054                 0.042668           0.026499   
Peroxisome           0.808573                 0.125576           0.092955   
Mitochondrion        0.400943                 0.119362          -0.163399   
Nucleus_export       0.937220                 0.428655           0.495497   
SIGNAL               0.755228                 0.804298           0.352232   
chloroplast          0.917339                 0.532390           0.495231   
Thylakoid            0.991722                 0.409543           0.591448   

                recall_score  precision_score  f1_score  
Nucleus             0.742188         0.714286  0.727969  
ER                  1.000000         0.028958  0.056285  
Peroxisome          0.692308         0.027607  0.053097  
Mitochondrion       0.037500         0.029851  0.033241  
Nucleus_export      0.800000         0.327869  0.465116  
SIGNAL              0.715822         0.760196  0.737342  
chloroplast         0.605263         0.474227  0.531792  
Thylakoid           0.800000         0.444444  0.571429  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.3  0.1         0.3            0.1             0.4     0.1   
cutoffs_aa       0.3  0.1         0.1            0.1             0.5     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.2        0.6  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.653201
Nucleus_export  0.163886
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.780912  0.219341  0.219088
Nucleus_export  0.176376  0.081303  0.823624
===========================================

 cs acc: 

                      0
ER             0.482759
Peroxisome     0.307692
Mitochondrion  0.377358
SIGNAL         0.872274
chloroplast    0.328767
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.948797                 0.730771           0.692861   
ER                   0.614887                 0.035524           0.028210   
Peroxisome           0.890952                 0.091763           0.192428   
Mitochondrion        0.362504                 0.109600          -0.099465   
Nucleus_export       0.944186                 0.279416           0.218619   
SIGNAL               0.731524                 0.785079           0.318017   
chloroplast          0.959364                 0.734017           0.642265   
Thylakoid            0.962468                 0.154944           0.047470   

                recall_score  precision_score  f1_score  
Nucleus             0.776860         0.686131  0.728682  
ER                  1.000000         0.028210  0.054872  
Peroxisome          1.000000         0.048872  0.093190  
Mitochondrion       0.012579         0.025316  0.016807  
Nucleus_export      0.280000         0.205882  0.237288  
SIGNAL              0.671340         0.749565  0.708299  
chloroplast         0.726027         0.616279  0.666667  
Thylakoid           0.111111         0.034483  0.052632  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.3  0.1         0.3            0.1             0.4     0.1   
cutoffs_aa       0.3  0.1         0.1            0.1             0.5     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.2        0.6  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.517722
Nucleus_export  0.069109
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.624507  0.188952  0.152352
Nucleus_export  0.077429  0.033998  0.202571
===========================================

 cs acc: 

                      0
ER             0.482759
Peroxisome     0.307692
Mitochondrion  0.500000
SIGNAL         0.874710
chloroplast    0.283019
Thylakoid      1.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.948797                 0.730771           0.692861   
ER                   0.614887                 0.035524           0.028210   
Peroxisome           0.890952                 0.091763           0.192428   
Mitochondrion        0.362504                 0.109600          -0.099465   
Nucleus_export       0.944186                 0.279416           0.218619   
SIGNAL               0.731524                 0.785079           0.318017   
chloroplast          0.959364                 0.734017           0.642265   
Thylakoid            0.962468                 0.154944           0.047470   

                recall_score  precision_score  f1_score  
Nucleus             0.776860         0.686131  0.728682  
ER                  1.000000         0.028210  0.054872  
Peroxisome          1.000000         0.048872  0.093190  
Mitochondrion       0.012579         0.025316  0.016807  
Nucleus_export      0.280000         0.205882  0.237288  
SIGNAL              0.671340         0.749565  0.708299  
chloroplast         0.726027         0.616279  0.666667  
Thylakoid           0.111111         0.034483  0.052632  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.3  0.1         0.3            0.1             0.4     0.1   
cutoffs_aa       0.3  0.1         0.1            0.1             0.5     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.2        0.6  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.962794
Nucleus_export  0.000000
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.038670  0.0
Nucleus_export  0.0  0.120323  1.0
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.0                    0.325                0.0   
ER                        NaN                   -0.000                0.0   
Peroxisome                NaN                   -0.000                0.0   
Mitochondrion             NaN                   -0.000                0.0   
Nucleus_export            NaN                    1.000                0.0   
SIGNAL                    NaN                   -0.000                0.0   
chloroplast               NaN                   -0.000                0.0   
Thylakoid                 NaN                   -0.000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.4              1.0  0.571429  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.3  0.1         0.3            0.1             0.4     0.1   
cutoffs_aa       0.3  0.1         0.1            0.1             0.5     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.2        0.6  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.962794
Nucleus_export  0.000000
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.038670  0.0
Nucleus_export  0.0  0.046093  0.4
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.0                    0.325                0.0   
ER                        NaN                   -0.000                0.0   
Peroxisome                NaN                   -0.000                0.0   
Mitochondrion             NaN                   -0.000                0.0   
Nucleus_export            NaN                    1.000                0.0   
SIGNAL                    NaN                   -0.000                0.0   
chloroplast               NaN                   -0.000                0.0   
Thylakoid                 NaN                   -0.000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.4              1.0  0.571429  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
