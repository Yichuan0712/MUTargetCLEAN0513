use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.125385  [   16/ 3543]

0 class loss: 0.027221 position_loss:0.023988

30 loss: 0.439977  [  496/ 3543]

30 class loss: 0.112818 position_loss:0.083483

60 loss: 0.088212  [  976/ 3543]

60 class loss: 0.019555 position_loss:0.016860

90 loss: 0.755535  [ 1456/ 3543]

90 class loss: 0.160487 position_loss:0.144688

120 loss: 0.609988  [ 1936/ 3543]

120 class loss: 0.121650 position_loss:0.117131

150 loss: 0.362628  [ 2416/ 3543]

150 class loss: 0.080223 position_loss:0.069317

180 loss: 0.444468  [ 2896/ 3543]

180 class loss: 0.097511 position_loss:0.084993

210 loss: 0.929667  [ 3376/ 3543]

210 class loss: 0.199525 position_loss:0.177952

Epoch 1: train loss: 0.477566

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.281539

Epoch 1: valid_class_loss:0.058786	valid_position_loss:0.053956

Epoch 1: valid loss 0.2815387836505922 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05395631219728523 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.229106  [   16/ 3543]

221 class loss: 0.052280 position_loss:0.043730

251 loss: 0.069955  [  496/ 3543]

251 class loss: 0.015377 position_loss:0.013376

281 loss: 0.629449  [  976/ 3543]

281 class loss: 0.157140 position_loss:0.119604

311 loss: 0.571960  [ 1456/ 3543]

311 class loss: 0.136762 position_loss:0.108921

341 loss: 0.440961  [ 1936/ 3543]

341 class loss: 0.087572 position_loss:0.084689

371 loss: 0.363180  [ 2416/ 3543]

371 class loss: 0.084758 position_loss:0.069246

401 loss: 0.208672  [ 2896/ 3543]

401 class loss: 0.048591 position_loss:0.039791

431 loss: 0.317473  [ 3376/ 3543]

431 class loss: 0.070850 position_loss:0.060661

Epoch 2: train loss: 0.418114

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.209710

Epoch 2: valid_class_loss:0.048407	valid_position_loss:0.040006

Epoch 2: valid loss 0.2097100010364937 smaller than best loss 0.2815387836505922
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.04000570979171432 smaller than best position loss 0.05395631219728523
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.476835  [   16/ 3543]

442 class loss: 0.113079 position_loss:0.090844

472 loss: 0.254005  [  496/ 3543]

472 class loss: 0.066799 position_loss:0.048129

502 loss: 0.364966  [  976/ 3543]

502 class loss: 0.083366 position_loss:0.069659

532 loss: 0.173106  [ 1456/ 3543]

532 class loss: 0.045554 position_loss:0.032799

562 loss: 0.366603  [ 1936/ 3543]

562 class loss: 0.111901 position_loss:0.068845

592 loss: 0.114678  [ 2416/ 3543]

592 class loss: 0.028124 position_loss:0.021811

622 loss: 0.225205  [ 2896/ 3543]

622 class loss: 0.075864 position_loss:0.042007

652 loss: 0.355838  [ 3376/ 3543]

652 class loss: 0.130754 position_loss:0.065937

Epoch 3: train loss: 0.260838

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.105067

Epoch 3: valid_class_loss:0.037618	valid_position_loss:0.019509

Epoch 3: valid loss 0.1050669281527361 smaller than best loss 0.2097100010364937
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.019508677927537313 smaller than best position loss 0.04000570979171432
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.200833  [   16/ 3543]

663 class loss: 0.081274 position_loss:0.036916

693 loss: 0.190822  [  496/ 3543]

693 class loss: 0.062184 position_loss:0.035677

723 loss: 0.159328  [  976/ 3543]

723 class loss: 0.078385 position_loss:0.028730

753 loss: 0.214244  [ 1456/ 3543]

753 class loss: 0.116662 position_loss:0.038182

783 loss: 0.040963  [ 1936/ 3543]

783 class loss: 0.023126 position_loss:0.007268

813 loss: 0.076707  [ 2416/ 3543]

813 class loss: 0.051786 position_loss:0.013270

843 loss: 0.165938  [ 2896/ 3543]

843 class loss: 0.103478 position_loss:0.029049

873 loss: 0.120528  [ 3376/ 3543]

873 class loss: 0.070489 position_loss:0.021286

Epoch 4: train loss: 0.130982

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.071936

Epoch 4: valid_class_loss:0.032197	valid_position_loss:0.013099

Epoch 4: valid loss 0.07193556130267637 smaller than best loss 0.1050669281527361
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013099241083392632 smaller than best position loss 0.019508677927537313
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.134865  [   16/ 3543]

884 class loss: 0.085793 position_loss:0.023541

914 loss: 0.059912  [  496/ 3543]

914 class loss: 0.046458 position_loss:0.010124

944 loss: 0.099837  [  976/ 3543]

944 class loss: 0.064495 position_loss:0.017388

974 loss: 0.051925  [ 1456/ 3543]

974 class loss: 0.034494 position_loss:0.009005

1004 loss: 0.047897  [ 1936/ 3543]

1004 class loss: 0.041649 position_loss:0.007913

1034 loss: 0.068562  [ 2416/ 3543]

1034 class loss: 0.025159 position_loss:0.012706

1064 loss: 0.109884  [ 2896/ 3543]

1064 class loss: 0.085454 position_loss:0.018559

1094 loss: 0.045268  [ 3376/ 3543]

1094 class loss: 0.036228 position_loss:0.007605

Epoch 5: train loss: 0.090370

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.055895

Epoch 5: valid_class_loss:0.031478	valid_position_loss:0.009920

Epoch 5: valid loss 0.05589524619130002 smaller than best loss 0.07193556130267637
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.009919930315643536 smaller than best position loss 0.013099241083392632
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.058153  [   16/ 3543]

1105 class loss: 0.082584 position_loss:0.008327

1135 loss: 0.084610  [  496/ 3543]

1135 class loss: 0.056805 position_loss:0.014650

1165 loss: 0.030207  [  976/ 3543]

1165 class loss: 0.009232 position_loss:0.005672

1195 loss: 0.035118  [ 1456/ 3543]

1195 class loss: 0.031866 position_loss:0.005749

1225 loss: 0.046167  [ 1936/ 3543]

1225 class loss: 0.047270 position_loss:0.007343

1255 loss: 0.079444  [ 2416/ 3543]

1255 class loss: 0.081698 position_loss:0.012621

1285 loss: 0.097739  [ 2896/ 3543]

1285 class loss: 0.115002 position_loss:0.014948

1315 loss: 0.073410  [ 3376/ 3543]

1315 class loss: 0.069104 position_loss:0.011918

Epoch 6: train loss: 0.074615

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.044300

Epoch 6: valid_class_loss:0.030384	valid_position_loss:0.007645

Epoch 6: valid loss 0.04430020879255197 smaller than best loss 0.05589524619130002
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.0076446648227308095 smaller than best position loss 0.009919930315643536
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.099816  [   16/ 3543]

1326 class loss: 0.095951 position_loss:0.016125

1356 loss: 0.092055  [  496/ 3543]

1356 class loss: 0.066528 position_loss:0.015750

1386 loss: 0.034200  [  976/ 3543]

1386 class loss: 0.038153 position_loss:0.005314

1416 loss: 0.048702  [ 1456/ 3543]

1416 class loss: 0.058936 position_loss:0.007383

1446 loss: 0.035378  [ 1936/ 3543]

1446 class loss: 0.042209 position_loss:0.005387

1476 loss: 0.021295  [ 2416/ 3543]

1476 class loss: 0.024683 position_loss:0.003272

1506 loss: 0.026022  [ 2896/ 3543]

1506 class loss: 0.033245 position_loss:0.003875

1536 loss: 0.045772  [ 3376/ 3543]

1536 class loss: 0.025776 position_loss:0.008123

Epoch 7: train loss: 0.057830

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.035410

Epoch 7: valid_class_loss:0.028484	valid_position_loss:0.005943

Epoch 7: valid loss 0.03541040094655126 smaller than best loss 0.04430020879255197
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.005942733558916588 smaller than best position loss 0.0076446648227308095
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.050322  [   16/ 3543]

1547 class loss: 0.041284 position_loss:0.008413

1577 loss: 0.031439  [  496/ 3543]

1577 class loss: 0.019143 position_loss:0.005522

1607 loss: 0.067392  [  976/ 3543]

1607 class loss: 0.059226 position_loss:0.011109

1637 loss: 0.062344  [ 1456/ 3543]

1637 class loss: 0.060195 position_loss:0.010061

1667 loss: 0.084716  [ 1936/ 3543]

1667 class loss: 0.079233 position_loss:0.013774

1697 loss: 0.048255  [ 2416/ 3543]

1697 class loss: 0.050355 position_loss:0.007637

1727 loss: 0.042959  [ 2896/ 3543]

1727 class loss: 0.042829 position_loss:0.006879

1757 loss: 0.056736  [ 3376/ 3543]

1757 class loss: 0.068787 position_loss:0.008596

Epoch 8: train loss: 0.043904

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.029001

Epoch 8: valid_class_loss:0.027453	valid_position_loss:0.004702

Epoch 8: valid loss 0.029000978181395142 smaller than best loss 0.03541040094655126
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.0047020753304295145 smaller than best position loss 0.005942733558916588
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.038197  [   16/ 3543]

1768 class loss: 0.056285 position_loss:0.005388

1798 loss: 0.024630  [  496/ 3543]

1798 class loss: 0.016002 position_loss:0.004286

1828 loss: 0.065949  [  976/ 3543]

1828 class loss: 0.080731 position_loss:0.009961

1858 loss: 0.034008  [ 1456/ 3543]

1858 class loss: 0.047564 position_loss:0.004899

1888 loss: 0.042733  [ 1936/ 3543]

1888 class loss: 0.041404 position_loss:0.006890

1918 loss: 0.042656  [ 2416/ 3543]

1918 class loss: 0.050483 position_loss:0.006512

1948 loss: 0.033314  [ 2896/ 3543]

1948 class loss: 0.047343 position_loss:0.004769

1978 loss: 0.033087  [ 3376/ 3543]

1978 class loss: 0.020692 position_loss:0.005790

Epoch 9: train loss: 0.035371

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.026281

Epoch 9: valid_class_loss:0.025910	valid_position_loss:0.004220

Epoch 9: valid loss 0.02628077262419015 smaller than best loss 0.029000978181395142
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004219737088676562 smaller than best position loss 0.0047020753304295145
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.014320  [   16/ 3543]

1989 class loss: 0.022514 position_loss:0.001964

2019 loss: 0.031603  [  496/ 3543]

2019 class loss: 0.036920 position_loss:0.004844

2049 loss: 0.056247  [  976/ 3543]

2049 class loss: 0.050165 position_loss:0.009243

2079 loss: 0.009888  [ 1456/ 3543]

2079 class loss: 0.018267 position_loss:0.001247

2109 loss: 0.029248  [ 1936/ 3543]

2109 class loss: 0.036476 position_loss:0.004391

2139 loss: 0.025585  [ 2416/ 3543]

2139 class loss: 0.032381 position_loss:0.003822

2169 loss: 0.024374  [ 2896/ 3543]

2169 class loss: 0.030036 position_loss:0.003673

2199 loss: 0.022450  [ 3376/ 3543]

2199 class loss: 0.030350 position_loss:0.003276

Epoch 10: train loss: 0.029623

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.023806

Epoch 10: valid_class_loss:0.024516	valid_position_loss:0.003781

Epoch 10: valid loss 0.023806317796972284 smaller than best loss 0.02628077262419015
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.003780631183520662 smaller than best position loss 0.004219737088676562
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.036183  [   16/ 3543]

2210 class loss: 0.021552 position_loss:0.006374

2240 loss: 0.030084  [  496/ 3543]

2240 class loss: 0.020957 position_loss:0.005178

2270 loss: 0.020715  [  976/ 3543]

2270 class loss: 0.031968 position_loss:0.002864

2300 loss: 0.011391  [ 1456/ 3543]

2300 class loss: 0.017877 position_loss:0.001563

2330 loss: 0.043896  [ 1936/ 3543]

2330 class loss: 0.047819 position_loss:0.006866

2360 loss: 0.043424  [ 2416/ 3543]

2360 class loss: 0.022243 position_loss:0.007795

2390 loss: 0.037496  [ 2896/ 3543]

2390 class loss: 0.056694 position_loss:0.005231

2420 loss: 0.019395  [ 3376/ 3543]

2420 class loss: 0.033417 position_loss:0.002542

Epoch 11: train loss: 0.025551

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.022835

Epoch 11: valid_class_loss:0.022695	valid_position_loss:0.003659

Epoch 11: valid loss 0.022835489620987956 smaller than best loss 0.023806317796972284
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0036593004356855166 smaller than best position loss 0.003780631183520662
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.014181  [   16/ 3543]

2431 class loss: 0.012664 position_loss:0.002330

2461 loss: 0.004907  [  496/ 3543]

2461 class loss: 0.008919 position_loss:0.000625

2491 loss: 0.009592  [  976/ 3543]

2491 class loss: 0.013329 position_loss:0.001385

2521 loss: 0.029093  [ 1456/ 3543]

2521 class loss: 0.044218 position_loss:0.004050

2551 loss: 0.005962  [ 1936/ 3543]

2551 class loss: 0.011254 position_loss:0.000742

2581 loss: 0.018231  [ 2416/ 3543]

2581 class loss: 0.028982 position_loss:0.002487

2611 loss: 0.014700  [ 2896/ 3543]

2611 class loss: 0.018438 position_loss:0.002202

2641 loss: 0.015628  [ 3376/ 3543]

2641 class loss: 0.030518 position_loss:0.001905

Epoch 12: train loss: 0.022738

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.020869

Epoch 12: valid_class_loss:0.021898	valid_position_loss:0.003298

Epoch 12: valid loss 0.02086926287212667 smaller than best loss 0.022835489620987956
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0032979154842192465 smaller than best position loss 0.0036593004356855166
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.022681  [   16/ 3543]

2652 class loss: 0.033277 position_loss:0.003205

2682 loss: 0.039764  [  496/ 3543]

2682 class loss: 0.062218 position_loss:0.005464

2712 loss: 0.005358  [  976/ 3543]

2712 class loss: 0.008111 position_loss:0.000747

2742 loss: 0.035707  [ 1456/ 3543]

2742 class loss: 0.040735 position_loss:0.005512

2772 loss: 0.009143  [ 1936/ 3543]

2772 class loss: 0.015281 position_loss:0.001217

2802 loss: 0.019711  [ 2416/ 3543]

2802 class loss: 0.017224 position_loss:0.003253

2832 loss: 0.013909  [ 2896/ 3543]

2832 class loss: 0.028516 position_loss:0.001641

2862 loss: 0.009941  [ 3376/ 3543]

2862 class loss: 0.021586 position_loss:0.001125

Epoch 13: train loss: 0.019711

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.019933

Epoch 13: valid_class_loss:0.020428	valid_position_loss:0.003170

Epoch 13: valid loss 0.01993302334073359 smaller than best loss 0.02086926287212667
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.003169500504345066 smaller than best position loss 0.0032979154842192465
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.023353  [   16/ 3543]

2873 class loss: 0.042845 position_loss:0.002957

2903 loss: 0.021946  [  496/ 3543]

2903 class loss: 0.033147 position_loss:0.003063

2933 loss: 0.014011  [  976/ 3543]

2933 class loss: 0.025510 position_loss:0.001782

2963 loss: 0.028178  [ 1456/ 3543]

2963 class loss: 0.042312 position_loss:0.003943

2993 loss: 0.020647  [ 1936/ 3543]

2993 class loss: 0.038147 position_loss:0.002604

3023 loss: 0.009933  [ 2416/ 3543]

3023 class loss: 0.017440 position_loss:0.001289

3053 loss: 0.014435  [ 2896/ 3543]

3053 class loss: 0.019782 position_loss:0.002096

3083 loss: 0.011245  [ 3376/ 3543]

3083 class loss: 0.014530 position_loss:0.001668

Epoch 14: train loss: 0.017510

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.020127

Epoch 14: valid_class_loss:0.019390	valid_position_loss:0.003250

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.038336  [   16/ 3543]

3094 class loss: 0.049062 position_loss:0.005705

3124 loss: 0.024552  [  496/ 3543]

3124 class loss: 0.020270 position_loss:0.004100

3154 loss: 0.010262  [  976/ 3543]

3154 class loss: 0.015100 position_loss:0.001448

3184 loss: 0.013379  [ 1456/ 3543]

3184 class loss: 0.023720 position_loss:0.001727

3214 loss: 0.003204  [ 1936/ 3543]

3214 class loss: 0.005933 position_loss:0.000403

3244 loss: 0.017798  [ 2416/ 3543]

3244 class loss: 0.013535 position_loss:0.003018

3274 loss: 0.020550  [ 2896/ 3543]

3274 class loss: 0.019764 position_loss:0.003320

3304 loss: 0.017541  [ 3376/ 3543]

3304 class loss: 0.018342 position_loss:0.002774

Epoch 15: train loss: 0.015848

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.018584

Epoch 15: valid_class_loss:0.019268	valid_position_loss:0.002946

Epoch 15: valid loss 0.018584338617308033 smaller than best loss 0.01993302334073359
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0029461537342416987 smaller than best position loss 0.003169500504345066
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0620_mut/2024-06-20__21-30-28/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.763037
Nucleus_export  0.608035
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.888721  0.170191  0.111279
Nucleus_export  0.740000  0.182903  0.260000
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.137500
SIGNAL         0.869432
chloroplast    0.342105
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.990278                 0.923898           0.834852   
ER                   0.925962                 0.581195           0.752349   
Peroxisome           0.628376                 0.328689           0.552334   
Mitochondrion        0.906271                 0.878984           0.809643   
Nucleus_export       0.966409                 0.508400           0.527295   
SIGNAL               0.974268                 0.983718           0.887008   
chloroplast          0.917446                 0.796393           0.712314   
Thylakoid            0.992769                 0.523505           0.666981   

                recall_score  precision_score  f1_score  
Nucleus             0.914062         0.801370  0.854015  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.843750         0.833333  0.838509  
Nucleus_export      0.560000         0.518519  0.538462  
SIGNAL              0.952381         0.959752  0.956052  
chloroplast         0.697368         0.768116  0.731034  
Thylakoid           0.900000         0.500000  0.642857  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.641454
Nucleus_export  0.338225
===========================================

 TPR, FPR, FNR: 

                      0         1        2
Nucleus         0.74387  0.175360  0.25613
Nucleus_export  0.40400  0.131693  0.59600
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.062893
SIGNAL         0.883178
chloroplast    0.383562
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.987621                 0.921540           0.832527   
ER                   0.998323                 0.912750           0.878084   
Peroxisome           0.667256                 0.502488           0.617811   
Mitochondrion        0.916558                 0.909465           0.824295   
Nucleus_export       0.947442                 0.273182           0.213236   
SIGNAL               0.975352                 0.983766           0.896946   
chloroplast          0.967132                 0.793470           0.720417   
Thylakoid            0.994487                 0.450519           0.583557   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.792857  0.850575  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.880503         0.823529  0.851064  
Nucleus_export      0.200000         0.263158  0.227273  
SIGNAL              0.957944         0.960938  0.959438  
chloroplast         0.739726         0.739726  0.739726  
Thylakoid           1.000000         0.346154  0.514286  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.629773
Nucleus_export  0.135055
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.730647  0.169990  0.186709
Nucleus_export  0.160000  0.045364  0.040000
===========================================

 cs acc: 

                      0
ER             0.961538
Peroxisome     0.800000
Mitochondrion  0.064286
SIGNAL         0.895935
chloroplast    0.481481
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.987621                 0.921540           0.832527   
ER                   0.998323                 0.912750           0.878084   
Peroxisome           0.667256                 0.502488           0.617811   
Mitochondrion        0.916558                 0.909465           0.824295   
Nucleus_export       0.947442                 0.273182           0.213236   
SIGNAL               0.975352                 0.983766           0.896946   
chloroplast          0.967132                 0.793470           0.720417   
Thylakoid            0.994487                 0.450519           0.583557   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.792857  0.850575  
ER                  0.896552         0.866667  0.881356  
Peroxisome          0.384615         1.000000  0.555556  
Mitochondrion       0.880503         0.823529  0.851064  
Nucleus_export      0.200000         0.263158  0.227273  
SIGNAL              0.957944         0.960938  0.959438  
chloroplast         0.739726         0.739726  0.739726  
Thylakoid           1.000000         0.346154  0.514286  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.949861
Nucleus_export  0.258660
===========================================

 TPR, FPR, FNR: 

                   0         1     2
Nucleus         1.00  0.052788  0.00
Nucleus_export  0.32  0.219017  0.68
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                      0.7                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.2              1.0  0.333333  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.949861
Nucleus_export  0.000000
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.052788  0.0
Nucleus_export  0.0  0.075228  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   0.5                      0.7                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.2              1.0  0.333333  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
