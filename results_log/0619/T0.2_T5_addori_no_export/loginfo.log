use k-fold index: 0

Done Loading data

number of steps for training data: 414

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 414

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.143596  [   16/ 6633]

0 class loss: 0.031340 position_loss:0.027466

30 loss: 0.641238  [  496/ 6633]

30 class loss: 0.139743 position_loss:0.122658

60 loss: 0.319699  [  976/ 6633]

60 class loss: 0.070642 position_loss:0.061114

90 loss: 0.329852  [ 1456/ 6633]

90 class loss: 0.070155 position_loss:0.063164

120 loss: 0.100397  [ 1936/ 6633]

120 class loss: 0.021607 position_loss:0.019215

150 loss: 0.480954  [ 2416/ 6633]

150 class loss: 0.108459 position_loss:0.091852

180 loss: 0.473992  [ 2896/ 6633]

180 class loss: 0.114878 position_loss:0.090203

210 loss: 0.173596  [ 3376/ 6633]

210 class loss: 0.039772 position_loss:0.033128

240 loss: 0.188353  [ 3856/ 6633]

240 class loss: 0.043933 position_loss:0.035913

270 loss: 0.245299  [ 4336/ 6633]

270 class loss: 0.054061 position_loss:0.046897

300 loss: 0.546484  [ 4816/ 6633]

300 class loss: 0.111919 position_loss:0.104820

330 loss: 0.308680  [ 5296/ 6633]

330 class loss: 0.068262 position_loss:0.059005

360 loss: 0.109225  [ 5776/ 6633]

360 class loss: 0.024248 position_loss:0.020875

390 loss: 0.080108  [ 6256/ 6633]

390 class loss: 0.019109 position_loss:0.015257

Epoch 1: train loss: 0.344256

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.234806

Epoch 1: valid_class_loss:0.052225	valid_position_loss:0.044872

Epoch 1: valid loss 0.23480578077999534 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.04487216537815095 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

414 loss: 0.366391  [   16/ 6633]

414 class loss: 0.092719 position_loss:0.069569

444 loss: 0.200871  [  496/ 6633]

444 class loss: 0.041783 position_loss:0.038503

474 loss: 0.194204  [  976/ 6633]

474 class loss: 0.055886 position_loss:0.036605

504 loss: 0.099990  [ 1456/ 6633]

504 class loss: 0.025777 position_loss:0.018967

534 loss: 0.197210  [ 1936/ 6633]

534 class loss: 0.054170 position_loss:0.037275

564 loss: 0.159320  [ 2416/ 6633]

564 class loss: 0.043905 position_loss:0.030108

594 loss: 0.052095  [ 2896/ 6633]

594 class loss: 0.014246 position_loss:0.009849

624 loss: 0.143262  [ 3376/ 6633]

624 class loss: 0.048220 position_loss:0.026724

654 loss: 0.070632  [ 3856/ 6633]

654 class loss: 0.022278 position_loss:0.013235

684 loss: 0.197915  [ 4336/ 6633]

684 class loss: 0.105006 position_loss:0.035383

714 loss: 0.123736  [ 4816/ 6633]

714 class loss: 0.027870 position_loss:0.023632

744 loss: 0.047717  [ 5296/ 6633]

744 class loss: 0.020216 position_loss:0.008735

774 loss: 0.108746  [ 5776/ 6633]

774 class loss: 0.047492 position_loss:0.019850

804 loss: 0.110043  [ 6256/ 6633]

804 class loss: 0.077429 position_loss:0.018912

Epoch 2: train loss: 0.172118

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.073767

Epoch 2: valid_class_loss:0.032628	valid_position_loss:0.013448

Epoch 2: valid loss 0.07376669006992764 smaller than best loss 0.23480578077999534
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.013448207550718438 smaller than best position loss 0.04487216537815095
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

828 loss: 0.164175  [   16/ 6633]

828 class loss: 0.089027 position_loss:0.029274

858 loss: 0.119978  [  496/ 6633]

858 class loss: 0.067857 position_loss:0.021281

888 loss: 0.038719  [  976/ 6633]

888 class loss: 0.022048 position_loss:0.006862

918 loss: 0.076293  [ 1456/ 6633]

918 class loss: 0.050957 position_loss:0.013220

948 loss: 0.062685  [ 1936/ 6633]

948 class loss: 0.057233 position_loss:0.010248

978 loss: 0.087723  [ 2416/ 6633]

978 class loss: 0.075982 position_loss:0.014505

1008 loss: 0.021160  [ 2896/ 6633]

1008 class loss: 0.011995 position_loss:0.003752

1038 loss: 0.123036  [ 3376/ 6633]

1038 class loss: 0.022374 position_loss:0.023712

1068 loss: 0.052524  [ 3856/ 6633]

1068 class loss: 0.048574 position_loss:0.008562

1098 loss: 0.034826  [ 4336/ 6633]

1098 class loss: 0.030656 position_loss:0.005739

1128 loss: 0.096471  [ 4816/ 6633]

1128 class loss: 0.122522 position_loss:0.014393

1158 loss: 0.026120  [ 5296/ 6633]

1158 class loss: 0.021086 position_loss:0.004381

1188 loss: 0.060616  [ 5776/ 6633]

1188 class loss: 0.058821 position_loss:0.009770

1218 loss: 0.079643  [ 6256/ 6633]

1218 class loss: 0.087503 position_loss:0.012429

Epoch 3: train loss: 0.066180

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.054479

Epoch 3: valid_class_loss:0.031935	valid_position_loss:0.009619

Epoch 3: valid loss 0.054479404771185985 smaller than best loss 0.07376669006992764
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.009618500640862929 smaller than best position loss 0.013448207550718438
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

1242 loss: 0.095466  [   16/ 6633]

1242 class loss: 0.104551 position_loss:0.014911

1272 loss: 0.040998  [  496/ 6633]

1272 class loss: 0.022733 position_loss:0.007290

1302 loss: 0.040787  [  976/ 6633]

1302 class loss: 0.038154 position_loss:0.006631

1332 loss: 0.050589  [ 1456/ 6633]

1332 class loss: 0.025499 position_loss:0.009098

1362 loss: 0.030781  [ 1936/ 6633]

1362 class loss: 0.028402 position_loss:0.005020

1392 loss: 0.038921  [ 2416/ 6633]

1392 class loss: 0.041865 position_loss:0.006110

1422 loss: 0.043361  [ 2896/ 6633]

1422 class loss: 0.040731 position_loss:0.007043

1452 loss: 0.019836  [ 3376/ 6633]

1452 class loss: 0.022967 position_loss:0.003049

1482 loss: 0.056994  [ 3856/ 6633]

1482 class loss: 0.065341 position_loss:0.008785

1512 loss: 0.039536  [ 4336/ 6633]

1512 class loss: 0.040729 position_loss:0.006278

1542 loss: 0.033020  [ 4816/ 6633]

1542 class loss: 0.037920 position_loss:0.005087

1572 loss: 0.079940  [ 5296/ 6633]

1572 class loss: 0.085650 position_loss:0.012562

1602 loss: 0.028639  [ 5776/ 6633]

1602 class loss: 0.034437 position_loss:0.004350

1632 loss: 0.031855  [ 6256/ 6633]

1632 class loss: 0.043642 position_loss:0.004625

Epoch 4: train loss: 0.046745

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.035760

Epoch 4: valid_class_loss:0.027411	valid_position_loss:0.006056

Epoch 4: valid loss 0.03576015281190525 smaller than best loss 0.054479404771185985
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.006055573678624017 smaller than best position loss 0.009618500640862929
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

1656 loss: 0.066009  [   16/ 6633]

1656 class loss: 0.061204 position_loss:0.010754

1686 loss: 0.018856  [  496/ 6633]

1686 class loss: 0.024970 position_loss:0.002772

1716 loss: 0.061892  [  976/ 6633]

1716 class loss: 0.050963 position_loss:0.010340

1746 loss: 0.028932  [ 1456/ 6633]

1746 class loss: 0.044067 position_loss:0.004024

1776 loss: 0.079789  [ 1936/ 6633]

1776 class loss: 0.046208 position_loss:0.014109

1806 loss: 0.040427  [ 2416/ 6633]

1806 class loss: 0.054092 position_loss:0.005922

1836 loss: 0.030760  [ 2896/ 6633]

1836 class loss: 0.012795 position_loss:0.005640

1866 loss: 0.045967  [ 3376/ 6633]

1866 class loss: 0.047821 position_loss:0.007281

1896 loss: 0.012529  [ 3856/ 6633]

1896 class loss: 0.012948 position_loss:0.001988

1926 loss: 0.042131  [ 4336/ 6633]

1926 class loss: 0.039638 position_loss:0.006841

1956 loss: 0.049558  [ 4816/ 6633]

1956 class loss: 0.053155 position_loss:0.007785

1986 loss: 0.029518  [ 5296/ 6633]

1986 class loss: 0.043322 position_loss:0.004171

2016 loss: 0.027525  [ 5776/ 6633]

2016 class loss: 0.035734 position_loss:0.004076

2046 loss: 0.011892  [ 6256/ 6633]

2046 class loss: 0.016150 position_loss:0.001732

Epoch 5: train loss: 0.031774

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.025246

Epoch 5: valid_class_loss:0.023891	valid_position_loss:0.004094

Epoch 5: valid loss 0.025246108763326065 smaller than best loss 0.03576015281190525
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.004093584141236071 smaller than best position loss 0.006055573678624017
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

2070 loss: 0.007793  [   16/ 6633]

2070 class loss: 0.011245 position_loss:0.001109

2100 loss: 0.033187  [  496/ 6633]

2100 class loss: 0.051373 position_loss:0.004582

2130 loss: 0.034648  [  976/ 6633]

2130 class loss: 0.032055 position_loss:0.005647

2160 loss: 0.036707  [ 1456/ 6633]

2160 class loss: 0.029751 position_loss:0.006151

2190 loss: 0.033221  [ 1936/ 6633]

2190 class loss: 0.033865 position_loss:0.005290

2220 loss: 0.012739  [ 2416/ 6633]

2220 class loss: 0.021903 position_loss:0.001672

2250 loss: 0.017921  [ 2896/ 6633]

2250 class loss: 0.028908 position_loss:0.002428

2280 loss: 0.029500  [ 3376/ 6633]

2280 class loss: 0.028204 position_loss:0.004772

2310 loss: 0.006978  [ 3856/ 6633]

2310 class loss: 0.013405 position_loss:0.000859

2340 loss: 0.023967  [ 4336/ 6633]

2340 class loss: 0.024231 position_loss:0.003824

2370 loss: 0.004896  [ 4816/ 6633]

2370 class loss: 0.008289 position_loss:0.000648

2400 loss: 0.012872  [ 5296/ 6633]

2400 class loss: 0.010296 position_loss:0.002163

2430 loss: 0.006268  [ 5776/ 6633]

2430 class loss: 0.009397 position_loss:0.000878

2460 loss: 0.020086  [ 6256/ 6633]

2460 class loss: 0.036191 position_loss:0.002570

Epoch 6: train loss: 0.024078

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.022417

Epoch 6: valid_class_loss:0.023069	valid_position_loss:0.003561

Epoch 6: valid loss 0.0224173390504651 smaller than best loss 0.025246108763326065
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.0035607175890923818 smaller than best position loss 0.004093584141236071
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

2484 loss: 0.008635  [   16/ 6633]

2484 class loss: 0.012063 position_loss:0.001245

2514 loss: 0.023326  [  496/ 6633]

2514 class loss: 0.020279 position_loss:0.003854

2544 loss: 0.014579  [  976/ 6633]

2544 class loss: 0.014664 position_loss:0.002329

2574 loss: 0.015158  [ 1456/ 6633]

2574 class loss: 0.011303 position_loss:0.002580

2604 loss: 0.010805  [ 1936/ 6633]

2604 class loss: 0.018822 position_loss:0.001408

2634 loss: 0.027534  [ 2416/ 6633]

2634 class loss: 0.015496 position_loss:0.004887

2664 loss: 0.009096  [ 2896/ 6633]

2664 class loss: 0.015805 position_loss:0.001187

2694 loss: 0.033424  [ 3376/ 6633]

2694 class loss: 0.043766 position_loss:0.004934

2724 loss: 0.015255  [ 3856/ 6633]

2724 class loss: 0.022944 position_loss:0.002133

2754 loss: 0.034613  [ 4336/ 6633]

2754 class loss: 0.052600 position_loss:0.004819

2784 loss: 0.013058  [ 4816/ 6633]

2784 class loss: 0.018738 position_loss:0.001862

2814 loss: 0.029107  [ 5296/ 6633]

2814 class loss: 0.041029 position_loss:0.004180

2844 loss: 0.013579  [ 5776/ 6633]

2844 class loss: 0.014044 position_loss:0.002154

2874 loss: 0.018503  [ 6256/ 6633]

2874 class loss: 0.034518 position_loss:0.002320

Epoch 7: train loss: 0.018998

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.019484

Epoch 7: valid_class_loss:0.019583	valid_position_loss:0.003113

Epoch 7: valid loss 0.019484062427826115 smaller than best loss 0.0224173390504651
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.0031134822533096683 smaller than best position loss 0.0035607175890923818
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

2898 loss: 0.032253  [   16/ 6633]

2898 class loss: 0.036659 position_loss:0.004984

2928 loss: 0.008064  [  496/ 6633]

2928 class loss: 0.014050 position_loss:0.001051

2958 loss: 0.011246  [  976/ 6633]

2958 class loss: 0.014549 position_loss:0.001667

2988 loss: 0.015084  [ 1456/ 6633]

2988 class loss: 0.025232 position_loss:0.002008

3018 loss: 0.006808  [ 1936/ 6633]

3018 class loss: 0.013151 position_loss:0.000836

3048 loss: 0.007653  [ 2416/ 6633]

3048 class loss: 0.015866 position_loss:0.000896

3078 loss: 0.008176  [ 2896/ 6633]

3078 class loss: 0.008090 position_loss:0.001312

3108 loss: 0.018414  [ 3376/ 6633]

3108 class loss: 0.033972 position_loss:0.002324

3138 loss: 0.021744  [ 3856/ 6633]

3138 class loss: 0.042648 position_loss:0.002643

3168 loss: 0.022926  [ 4336/ 6633]

3168 class loss: 0.032206 position_loss:0.003297

3198 loss: 0.032936  [ 4816/ 6633]

3198 class loss: 0.044853 position_loss:0.004793

3228 loss: 0.010444  [ 5296/ 6633]

3228 class loss: 0.008281 position_loss:0.001758

3258 loss: 0.006835  [ 5776/ 6633]

3258 class loss: 0.010445 position_loss:0.000949

3288 loss: 0.004092  [ 6256/ 6633]

3288 class loss: 0.005817 position_loss:0.000586

Epoch 8: train loss: 0.015641

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.019326

Epoch 8: valid_class_loss:0.017840	valid_position_loss:0.003152

Epoch 8: valid loss 0.019325528633573664 smaller than best loss 0.019484062427826115
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

3312 loss: 0.008083  [   16/ 6633]

3312 class loss: 0.012123 position_loss:0.001132

3342 loss: 0.025902  [  496/ 6633]

3342 class loss: 0.044848 position_loss:0.003386

3372 loss: 0.027219  [  976/ 6633]

3372 class loss: 0.035233 position_loss:0.004034

3402 loss: 0.003544  [ 1456/ 6633]

3402 class loss: 0.007430 position_loss:0.000412

3432 loss: 0.011973  [ 1936/ 6633]

3432 class loss: 0.024034 position_loss:0.001433

3462 loss: 0.016857  [ 2416/ 6633]

3462 class loss: 0.031699 position_loss:0.002103

3492 loss: 0.009158  [ 2896/ 6633]

3492 class loss: 0.018084 position_loss:0.001108

3522 loss: 0.020380  [ 3376/ 6633]

3522 class loss: 0.023634 position_loss:0.003131

3552 loss: 0.008050  [ 3856/ 6633]

3552 class loss: 0.008531 position_loss:0.001269

3582 loss: 0.014982  [ 4336/ 6633]

3582 class loss: 0.016706 position_loss:0.002328

3612 loss: 0.014019  [ 4816/ 6633]

3612 class loss: 0.026343 position_loss:0.001750

3642 loss: 0.011159  [ 5296/ 6633]

3642 class loss: 0.016345 position_loss:0.001578

3672 loss: 0.007051  [ 5776/ 6633]

3672 class loss: 0.010090 position_loss:0.001006

3702 loss: 0.004927  [ 6256/ 6633]

3702 class loss: 0.007349 position_loss:0.000691

Epoch 9: train loss: 0.013106

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.020107

Epoch 9: valid_class_loss:0.016649	valid_position_loss:0.003355

Fold 0 Epoch 10 train...
-------------------------------

3726 loss: 0.012021  [   16/ 6633]

3726 class loss: 0.017247 position_loss:0.001714

3756 loss: 0.010583  [  496/ 6633]

3756 class loss: 0.023037 position_loss:0.001195

3786 loss: 0.006275  [  976/ 6633]

3786 class loss: 0.013164 position_loss:0.000729

3816 loss: 0.009126  [ 1456/ 6633]

3816 class loss: 0.014763 position_loss:0.001235

3846 loss: 0.009708  [ 1936/ 6633]

3846 class loss: 0.008936 position_loss:0.001584

3876 loss: 0.014130  [ 2416/ 6633]

3876 class loss: 0.020285 position_loss:0.002015

3906 loss: 0.014381  [ 2896/ 6633]

3906 class loss: 0.025651 position_loss:0.001850

3936 loss: 0.004066  [ 3376/ 6633]

3936 class loss: 0.007723 position_loss:0.000504

3966 loss: 0.013230  [ 3856/ 6633]

3966 class loss: 0.022414 position_loss:0.001750

3996 loss: 0.008694  [ 4336/ 6633]

3996 class loss: 0.012292 position_loss:0.001247

4026 loss: 0.013172  [ 4816/ 6633]

4026 class loss: 0.024517 position_loss:0.001654

4056 loss: 0.006208  [ 5296/ 6633]

4056 class loss: 0.014695 position_loss:0.000654

4086 loss: 0.007005  [ 5776/ 6633]

4086 class loss: 0.009977 position_loss:0.001002

4116 loss: 0.017746  [ 6256/ 6633]

4116 class loss: 0.024162 position_loss:0.002583

Epoch 10: train loss: 0.011377

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.017480

Epoch 10: valid_class_loss:0.016055	valid_position_loss:0.002854

Epoch 10: valid loss 0.01747963284194219 smaller than best loss 0.019325528633573664
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.002853735232992039 smaller than best position loss 0.0031134822533096683
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

4140 loss: 0.007026  [   16/ 6633]

4140 class loss: 0.010998 position_loss:0.000965

4170 loss: 0.006443  [  496/ 6633]

4170 class loss: 0.011704 position_loss:0.000820

4200 loss: 0.008794  [  976/ 6633]

4200 class loss: 0.011250 position_loss:0.001309

4230 loss: 0.012679  [ 1456/ 6633]

4230 class loss: 0.028700 position_loss:0.001388

4260 loss: 0.012684  [ 1936/ 6633]

4260 class loss: 0.013191 position_loss:0.002009

4290 loss: 0.005677  [ 2416/ 6633]

4290 class loss: 0.011359 position_loss:0.000681

4320 loss: 0.002999  [ 2896/ 6633]

4320 class loss: 0.006499 position_loss:0.000340

4350 loss: 0.018862  [ 3376/ 6633]

4350 class loss: 0.011773 position_loss:0.003302

4380 loss: 0.017253  [ 3856/ 6633]

4380 class loss: 0.026891 position_loss:0.002375

4410 loss: 0.006163  [ 4336/ 6633]

4410 class loss: 0.005947 position_loss:0.000995

4440 loss: 0.004624  [ 4816/ 6633]

4440 class loss: 0.009230 position_loss:0.000556

4470 loss: 0.008169  [ 5296/ 6633]

4470 class loss: 0.010155 position_loss:0.001228

4500 loss: 0.011548  [ 5776/ 6633]

4500 class loss: 0.018706 position_loss:0.001561

4530 loss: 0.006395  [ 6256/ 6633]

4530 class loss: 0.011602 position_loss:0.000815

Epoch 11: train loss: 0.010087

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.019379

Epoch 11: valid_class_loss:0.015029	valid_position_loss:0.003275

Fold 0 Epoch 12 train...
-------------------------------

4554 loss: 0.006669  [   16/ 6633]

4554 class loss: 0.004455 position_loss:0.001156

4584 loss: 0.020606  [  496/ 6633]

4584 class loss: 0.041829 position_loss:0.002448

4614 loss: 0.005289  [  976/ 6633]

4614 class loss: 0.008252 position_loss:0.000728

4644 loss: 0.004253  [ 1456/ 6633]

4644 class loss: 0.003387 position_loss:0.000715

4674 loss: 0.002573  [ 1936/ 6633]

4674 class loss: 0.003423 position_loss:0.000378

4704 loss: 0.017595  [ 2416/ 6633]

4704 class loss: 0.021242 position_loss:0.002669

4734 loss: 0.011575  [ 2896/ 6633]

4734 class loss: 0.019231 position_loss:0.001546

4764 loss: 0.014829  [ 3376/ 6633]

4764 class loss: 0.012038 position_loss:0.002484

4794 loss: 0.008824  [ 3856/ 6633]

4794 class loss: 0.014092 position_loss:0.001201

4824 loss: 0.008516  [ 4336/ 6633]

4824 class loss: 0.016568 position_loss:0.001040

4854 loss: 0.003689  [ 4816/ 6633]

4854 class loss: 0.009221 position_loss:0.000369

4884 loss: 0.007346  [ 5296/ 6633]

4884 class loss: 0.018408 position_loss:0.000733

4914 loss: 0.006922  [ 5776/ 6633]

4914 class loss: 0.008555 position_loss:0.001042

4944 loss: 0.004686  [ 6256/ 6633]

4944 class loss: 0.008192 position_loss:0.000610

Epoch 12: train loss: 0.009025

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.018762

Epoch 12: valid_class_loss:0.014779	valid_position_loss:0.003161

Fold 0 Epoch 13 train...
-------------------------------

4968 loss: 0.014422  [   16/ 6633]

4968 class loss: 0.011715 position_loss:0.002416

4998 loss: 0.014701  [  496/ 6633]

4998 class loss: 0.020451 position_loss:0.002122

5028 loss: 0.009030  [  976/ 6633]

5028 class loss: 0.007923 position_loss:0.001489

5058 loss: 0.002905  [ 1456/ 6633]

5058 class loss: 0.006104 position_loss:0.000337

5088 loss: 0.010386  [ 1936/ 6633]

5088 class loss: 0.008137 position_loss:0.001752

5118 loss: 0.010182  [ 2416/ 6633]

5118 class loss: 0.010085 position_loss:0.001633

5148 loss: 0.009055  [ 2896/ 6633]

5148 class loss: 0.019214 position_loss:0.001043

5178 loss: 0.010689  [ 3376/ 6633]

5178 class loss: 0.010551 position_loss:0.001716

5208 loss: 0.013570  [ 3856/ 6633]

5208 class loss: 0.006248 position_loss:0.002464

5238 loss: 0.013322  [ 4336/ 6633]

5238 class loss: 0.023551 position_loss:0.001722

5268 loss: 0.010888  [ 4816/ 6633]

5268 class loss: 0.016396 position_loss:0.001522

5298 loss: 0.013549  [ 5296/ 6633]

5298 class loss: 0.023923 position_loss:0.001753

5328 loss: 0.013327  [ 5776/ 6633]

5328 class loss: 0.020659 position_loss:0.001839

5358 loss: 0.002638  [ 6256/ 6633]

5358 class loss: 0.005833 position_loss:0.000294

Epoch 13: train loss: 0.008129

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.019315

Epoch 13: valid_class_loss:0.014562	valid_position_loss:0.003281

Fold 0 Epoch 14 train...
-------------------------------

5382 loss: 0.004525  [   16/ 6633]

5382 class loss: 0.004772 position_loss:0.000714

5412 loss: 0.004825  [  496/ 6633]

5412 class loss: 0.011948 position_loss:0.000487

5442 loss: 0.002595  [  976/ 6633]

5442 class loss: 0.005075 position_loss:0.000316

5472 loss: 0.006182  [ 1456/ 6633]

5472 class loss: 0.015491 position_loss:0.000617

5502 loss: 0.008519  [ 1936/ 6633]

5502 class loss: 0.022616 position_loss:0.000799

5532 loss: 0.003186  [ 2416/ 6633]

5532 class loss: 0.003568 position_loss:0.000495

5562 loss: 0.003394  [ 2896/ 6633]

5562 class loss: 0.008645 position_loss:0.000333

5592 loss: 0.007597  [ 3376/ 6633]

5592 class loss: 0.015049 position_loss:0.000917

5622 loss: 0.004675  [ 3856/ 6633]

5622 class loss: 0.008389 position_loss:0.000599

5652 loss: 0.005471  [ 4336/ 6633]

5652 class loss: 0.006513 position_loss:0.000834

5682 loss: 0.003463  [ 4816/ 6633]

5682 class loss: 0.009271 position_loss:0.000322

5712 loss: 0.002818  [ 5296/ 6633]

5712 class loss: 0.006717 position_loss:0.000295

5742 loss: 0.002620  [ 5776/ 6633]

5742 class loss: 0.003854 position_loss:0.000370

5772 loss: 0.005590  [ 6256/ 6633]

5772 class loss: 0.016020 position_loss:0.000477

Epoch 14: train loss: 0.007183

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.021632

Epoch 14: valid_class_loss:0.014308	valid_position_loss:0.003754

Fold 0 Epoch 15 train...
-------------------------------

5796 loss: 0.003959  [   16/ 6633]

5796 class loss: 0.006646 position_loss:0.000526

5826 loss: 0.004596  [  496/ 6633]

5826 class loss: 0.007292 position_loss:0.000628

5856 loss: 0.003689  [  976/ 6633]

5856 class loss: 0.006376 position_loss:0.000483

5886 loss: 0.004442  [ 1456/ 6633]

5886 class loss: 0.007279 position_loss:0.000597

5916 loss: 0.003832  [ 1936/ 6633]

5916 class loss: 0.008474 position_loss:0.000427

5946 loss: 0.004494  [ 2416/ 6633]

5946 class loss: 0.009466 position_loss:0.000520

5976 loss: 0.008025  [ 2896/ 6633]

5976 class loss: 0.013479 position_loss:0.001066

6006 loss: 0.009070  [ 3376/ 6633]

6006 class loss: 0.010480 position_loss:0.001395

6036 loss: 0.009356  [ 3856/ 6633]

6036 class loss: 0.021097 position_loss:0.001027

6066 loss: 0.010029  [ 4336/ 6633]

6066 class loss: 0.021605 position_loss:0.001142

6096 loss: 0.004071  [ 4816/ 6633]

6096 class loss: 0.008818 position_loss:0.000461

6126 loss: 0.005879  [ 5296/ 6633]

6126 class loss: 0.007202 position_loss:0.000888

6156 loss: 0.005073  [ 5776/ 6633]

6156 class loss: 0.009465 position_loss:0.000636

6186 loss: 0.001494  [ 6256/ 6633]

6186 class loss: 0.003303 position_loss:0.000167

Epoch 15: train loss: 0.006533

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.020447

Epoch 15: valid_class_loss:0.014182	valid_position_loss:0.003522

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0619/2024-06-19__23-41-34/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.4         0.3            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.762994
Nucleus_export  0.556270
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.884882  0.166571  0.115118
Nucleus_export  0.698675  0.206287  0.301325
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.384615
Mitochondrion  0.381250
SIGNAL         0.874040
chloroplast    0.460526
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.992171                 0.929891           0.857817   
ER                   0.934077                 0.594355           0.752349   
Peroxisome           0.789269                 0.392339           0.520055   
Mitochondrion        0.951165                 0.930842           0.905738   
Nucleus_export       0.960734                 0.490946           0.526753   
SIGNAL               0.983511                 0.989290           0.922484   
chloroplast          0.991143                 0.938067           0.881278   
Thylakoid            0.995528                 0.509112           0.666981   

                recall_score  precision_score  f1_score  
Nucleus             0.960938         0.798701  0.872340  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.384615         0.714286  0.500000  
Mitochondrion       0.868750         0.972028  0.917492  
Nucleus_export      0.480000         0.600000  0.533333  
SIGNAL              0.984639         0.956716  0.970477  
chloroplast         0.802632         0.983871  0.884058  
Thylakoid           0.900000         0.500000  0.642857  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.4         0.3            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.638052
Nucleus_export  0.229742
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.730554  0.154830  0.269446
Nucleus_export  0.282000  0.125275  0.718000
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.301887
SIGNAL         0.884735
chloroplast    0.328767
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.989307                 0.927907           0.829230   
ER                   0.998423                 0.923584           0.916780   
Peroxisome           0.946213                 0.567854           0.580648   
Mitochondrion        0.927246                 0.920999           0.909198   
Nucleus_export       0.944884                 0.342718           0.244507   
SIGNAL               0.988605                 0.992375           0.936566   
chloroplast          0.991104                 0.934656           0.933386   
Thylakoid            0.994169                 0.438233           0.667291   

                recall_score  precision_score  f1_score  
Nucleus             0.933884         0.773973  0.846442  
ER                  0.965517         0.875000  0.918033  
Peroxisome          0.538462         0.636364  0.583333  
Mitochondrion       0.855346         0.992701  0.918919  
Nucleus_export      0.200000         0.333333  0.250000  
SIGNAL              0.987539         0.963526  0.975385  
chloroplast         0.931507         0.944444  0.937931  
Thylakoid           1.000000         0.450000  0.620690  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.4         0.3            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.634178
Nucleus_export  0.093662
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.726421  0.152539  0.207463
Nucleus_export  0.132000  0.078589  0.068000
===========================================

 cs acc: 

                      0
ER             0.964286
Peroxisome     0.857143
Mitochondrion  0.294118
SIGNAL         0.886435
chloroplast    0.352941
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.989307                 0.927907           0.829230   
ER                   0.998423                 0.923584           0.916780   
Peroxisome           0.946213                 0.567854           0.580648   
Mitochondrion        0.927246                 0.920999           0.909198   
Nucleus_export       0.944884                 0.342718           0.244507   
SIGNAL               0.988605                 0.992375           0.936566   
chloroplast          0.991104                 0.934656           0.933386   
Thylakoid            0.994169                 0.438233           0.667291   

                recall_score  precision_score  f1_score  
Nucleus             0.933884         0.773973  0.846442  
ER                  0.965517         0.875000  0.918033  
Peroxisome          0.538462         0.636364  0.583333  
Mitochondrion       0.855346         0.992701  0.918919  
Nucleus_export      0.200000         0.333333  0.250000  
SIGNAL              0.987539         0.963526  0.975385  
chloroplast         0.931507         0.944444  0.937931  
Thylakoid           1.000000         0.450000  0.620690  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.4         0.3            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.936596
Nucleus_export  0.197484
===========================================

 TPR, FPR, FNR: 

                   0        1     2
Nucleus         1.00  0.06770  0.00
Nucleus_export  0.26  0.22251  0.74
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   1.0                      1.0                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.5  0.4         0.3            0.3             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.5        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.936596
Nucleus_export  0.197484
===========================================

 TPR, FPR, FNR: 

                   0         1     2
Nucleus         1.00  0.067700  0.00
Nucleus_export  0.26  0.202075  0.34
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   1.0                      1.0                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
