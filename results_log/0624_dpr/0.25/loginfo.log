use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.125777  [   16/ 3543]

0 class loss: 0.026950 position_loss:0.024077

30 loss: 0.440899  [  496/ 3543]

30 class loss: 0.112326 position_loss:0.083687

60 loss: 0.088342  [  976/ 3543]

60 class loss: 0.019439 position_loss:0.016891

90 loss: 0.757632  [ 1456/ 3543]

90 class loss: 0.159291 position_loss:0.145155

120 loss: 0.613066  [ 1936/ 3543]

120 class loss: 0.121651 position_loss:0.117747

150 loss: 0.364390  [ 2416/ 3543]

150 class loss: 0.080296 position_loss:0.069666

180 loss: 0.443481  [ 2896/ 3543]

180 class loss: 0.095223 position_loss:0.084887

210 loss: 0.929010  [ 3376/ 3543]

210 class loss: 0.198454 position_loss:0.177864

Epoch 1: train loss: 0.478367

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.283048

Epoch 1: valid_class_loss:0.059068	valid_position_loss:0.054247

Epoch 1: valid loss 0.28304795368325014 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.054246875730413854 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.228336  [   16/ 3543]

221 class loss: 0.051097 position_loss:0.043623

251 loss: 0.069547  [  496/ 3543]

251 class loss: 0.015101 position_loss:0.013305

281 loss: 0.626585  [  976/ 3543]

281 class loss: 0.156935 position_loss:0.119040

311 loss: 0.570555  [ 1456/ 3543]

311 class loss: 0.134069 position_loss:0.108748

341 loss: 0.439482  [ 1936/ 3543]

341 class loss: 0.086137 position_loss:0.084451

371 loss: 0.365734  [ 2416/ 3543]

371 class loss: 0.083954 position_loss:0.069789

401 loss: 0.208209  [ 2896/ 3543]

401 class loss: 0.047696 position_loss:0.039734

431 loss: 0.322694  [ 3376/ 3543]

431 class loss: 0.069915 position_loss:0.061742

Epoch 2: train loss: 0.417860

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.217573

Epoch 2: valid_class_loss:0.049292	valid_position_loss:0.041543

Epoch 2: valid loss 0.2175733399009175 smaller than best loss 0.28304795368325014
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.04154297035320181 smaller than best position loss 0.054246875730413854
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.483243  [   16/ 3543]

442 class loss: 0.110962 position_loss:0.092210

472 loss: 0.253207  [  496/ 3543]

472 class loss: 0.064037 position_loss:0.048080

502 loss: 0.371103  [  976/ 3543]

502 class loss: 0.081447 position_loss:0.070963

532 loss: 0.176759  [ 1456/ 3543]

532 class loss: 0.044516 position_loss:0.033571

562 loss: 0.386074  [ 1936/ 3543]

562 class loss: 0.109294 position_loss:0.072843

592 loss: 0.123016  [ 2416/ 3543]

592 class loss: 0.028091 position_loss:0.023480

622 loss: 0.251556  [ 2896/ 3543]

622 class loss: 0.074838 position_loss:0.047318

652 loss: 0.425650  [ 3376/ 3543]

652 class loss: 0.132246 position_loss:0.079840

Epoch 3: train loss: 0.276438

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.133394

Epoch 3: valid_class_loss:0.038725	valid_position_loss:0.025130

Epoch 3: valid loss 0.13339431321942405 smaller than best loss 0.2175733399009175
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.025129863644616335 smaller than best position loss 0.04154297035320181
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.252114  [   16/ 3543]

663 class loss: 0.082267 position_loss:0.047132

693 loss: 0.227164  [  496/ 3543]

693 class loss: 0.061027 position_loss:0.042992

723 loss: 0.203743  [  976/ 3543]

723 class loss: 0.082705 position_loss:0.037440

753 loss: 0.282694  [ 1456/ 3543]

753 class loss: 0.123170 position_loss:0.051612

783 loss: 0.053210  [ 1936/ 3543]

783 class loss: 0.024558 position_loss:0.009660

813 loss: 0.093261  [ 2416/ 3543]

813 class loss: 0.055796 position_loss:0.016420

843 loss: 0.187006  [ 2896/ 3543]

843 class loss: 0.112934 position_loss:0.032884

873 loss: 0.126840  [ 3376/ 3543]

873 class loss: 0.074194 position_loss:0.022400

Epoch 4: train loss: 0.155829

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.073672

Epoch 4: valid_class_loss:0.032565	valid_position_loss:0.013432

Epoch 4: valid loss 0.07367192360496964 smaller than best loss 0.13339431321942405
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013431783380420531 smaller than best position loss 0.025129863644616335
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.143227  [   16/ 3543]

884 class loss: 0.090536 position_loss:0.025024

914 loss: 0.064067  [  496/ 3543]

914 class loss: 0.050434 position_loss:0.010796

944 loss: 0.102123  [  976/ 3543]

944 class loss: 0.066459 position_loss:0.017766

974 loss: 0.053676  [ 1456/ 3543]

974 class loss: 0.036950 position_loss:0.009257

1004 loss: 0.048702  [ 1936/ 3543]

1004 class loss: 0.044209 position_loss:0.007972

1034 loss: 0.071521  [ 2416/ 3543]

1034 class loss: 0.025399 position_loss:0.013288

1064 loss: 0.112816  [ 2896/ 3543]

1064 class loss: 0.090010 position_loss:0.018963

1094 loss: 0.046265  [ 3376/ 3543]

1094 class loss: 0.036773 position_loss:0.007782

Epoch 5: train loss: 0.092350

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.060312

Epoch 5: valid_class_loss:0.030948	valid_position_loss:0.010824

Epoch 5: valid loss 0.06031185252949379 smaller than best loss 0.07367192360496964
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010824444411490018 smaller than best position loss 0.013431783380420531
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.059244  [   16/ 3543]

1105 class loss: 0.085566 position_loss:0.008426

1135 loss: 0.089295  [  496/ 3543]

1135 class loss: 0.062246 position_loss:0.015369

1165 loss: 0.030736  [  976/ 3543]

1165 class loss: 0.009115 position_loss:0.005783

1195 loss: 0.035168  [ 1456/ 3543]

1195 class loss: 0.032262 position_loss:0.005743

1225 loss: 0.046965  [ 1936/ 3543]

1225 class loss: 0.050207 position_loss:0.007385

1255 loss: 0.079524  [ 2416/ 3543]

1255 class loss: 0.077327 position_loss:0.012812

1285 loss: 0.096021  [ 2896/ 3543]

1285 class loss: 0.109366 position_loss:0.014830

1315 loss: 0.074550  [ 3376/ 3543]

1315 class loss: 0.070695 position_loss:0.012082

Epoch 6: train loss: 0.076678

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.050993

Epoch 6: valid_class_loss:0.029991	valid_position_loss:0.008999

Epoch 6: valid loss 0.050992880867727415 smaller than best loss 0.06031185252949379
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.008998934698438814 smaller than best position loss 0.010824444411490018
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.107393  [   16/ 3543]

1326 class loss: 0.097072 position_loss:0.017596

1356 loss: 0.099544  [  496/ 3543]

1356 class loss: 0.074448 position_loss:0.016931

1386 loss: 0.035228  [  976/ 3543]

1386 class loss: 0.037974 position_loss:0.005527

1416 loss: 0.050859  [ 1456/ 3543]

1416 class loss: 0.060827 position_loss:0.007739

1446 loss: 0.037830  [ 1936/ 3543]

1446 class loss: 0.043827 position_loss:0.005813

1476 loss: 0.023203  [ 2416/ 3543]

1476 class loss: 0.025095 position_loss:0.003637

1506 loss: 0.028225  [ 2896/ 3543]

1506 class loss: 0.036232 position_loss:0.004196

1536 loss: 0.056535  [ 3376/ 3543]

1536 class loss: 0.027978 position_loss:0.010188

Epoch 7: train loss: 0.063528

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.039032

Epoch 7: valid_class_loss:0.029556	valid_position_loss:0.006624

Epoch 7: valid loss 0.03903155729062014 smaller than best loss 0.050992880867727415
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.006624065485368253 smaller than best position loss 0.008998934698438814
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.055620  [   16/ 3543]

1547 class loss: 0.046334 position_loss:0.009271

1577 loss: 0.037353  [  496/ 3543]

1577 class loss: 0.020651 position_loss:0.006645

1607 loss: 0.074042  [  976/ 3543]

1607 class loss: 0.061048 position_loss:0.012366

1637 loss: 0.067680  [ 1456/ 3543]

1637 class loss: 0.064241 position_loss:0.010966

1667 loss: 0.095980  [ 1936/ 3543]

1667 class loss: 0.091659 position_loss:0.015530

1697 loss: 0.054542  [ 2416/ 3543]

1697 class loss: 0.051075 position_loss:0.008865

1727 loss: 0.045904  [ 2896/ 3543]

1727 class loss: 0.044009 position_loss:0.007420

1757 loss: 0.065883  [ 3376/ 3543]

1757 class loss: 0.077165 position_loss:0.010090

Epoch 8: train loss: 0.048193

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.032794

Epoch 8: valid_class_loss:0.029798	valid_position_loss:0.005367

Epoch 8: valid loss 0.03279376268963493 smaller than best loss 0.03903155729062014
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.0053668265027278115 smaller than best position loss 0.006624065485368253
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.044534  [   16/ 3543]

1768 class loss: 0.063276 position_loss:0.006376

1798 loss: 0.026530  [  496/ 3543]

1798 class loss: 0.017281 position_loss:0.004615

1828 loss: 0.069200  [  976/ 3543]

1828 class loss: 0.084323 position_loss:0.010467

1858 loss: 0.035986  [ 1456/ 3543]

1858 class loss: 0.049939 position_loss:0.005200

1888 loss: 0.044004  [ 1936/ 3543]

1888 class loss: 0.040510 position_loss:0.007180

1918 loss: 0.042213  [ 2416/ 3543]

1918 class loss: 0.049861 position_loss:0.006448

1948 loss: 0.032830  [ 2896/ 3543]

1948 class loss: 0.047646 position_loss:0.004660

1978 loss: 0.032139  [ 3376/ 3543]

1978 class loss: 0.021786 position_loss:0.005556

Epoch 9: train loss: 0.038014

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.028059

Epoch 9: valid_class_loss:0.026795	valid_position_loss:0.004540

Epoch 9: valid loss 0.028059497843456675 smaller than best loss 0.03279376268963493
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004540088012985703 smaller than best position loss 0.0053668265027278115
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.014138  [   16/ 3543]

1989 class loss: 0.023605 position_loss:0.001883

2019 loss: 0.033732  [  496/ 3543]

2019 class loss: 0.041069 position_loss:0.005104

2049 loss: 0.055950  [  976/ 3543]

2049 class loss: 0.046935 position_loss:0.009313

2079 loss: 0.009970  [ 1456/ 3543]

2079 class loss: 0.019119 position_loss:0.001229

2109 loss: 0.032213  [ 1936/ 3543]

2109 class loss: 0.041863 position_loss:0.004768

2139 loss: 0.025882  [ 2416/ 3543]

2139 class loss: 0.031444 position_loss:0.003919

2169 loss: 0.026813  [ 2896/ 3543]

2169 class loss: 0.034065 position_loss:0.004000

2199 loss: 0.023657  [ 3376/ 3543]

2199 class loss: 0.032304 position_loss:0.003439

Epoch 10: train loss: 0.032250

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.025077

Epoch 10: valid_class_loss:0.024992	valid_position_loss:0.004016

Epoch 10: valid loss 0.025077410312031752 smaller than best loss 0.028059497843456675
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.0040157937758433645 smaller than best position loss 0.004540088012985703
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.031472  [   16/ 3543]

2210 class loss: 0.025993 position_loss:0.005255

2240 loss: 0.041808  [  496/ 3543]

2240 class loss: 0.021989 position_loss:0.007482

2270 loss: 0.023359  [  976/ 3543]

2270 class loss: 0.037646 position_loss:0.003166

2300 loss: 0.015068  [ 1456/ 3543]

2300 class loss: 0.026213 position_loss:0.001965

2330 loss: 0.048413  [ 1936/ 3543]

2330 class loss: 0.055645 position_loss:0.007457

2360 loss: 0.042224  [ 2416/ 3543]

2360 class loss: 0.022340 position_loss:0.007551

2390 loss: 0.046804  [ 2896/ 3543]

2390 class loss: 0.058804 position_loss:0.007009

2420 loss: 0.021588  [ 3376/ 3543]

2420 class loss: 0.035407 position_loss:0.002901

Epoch 11: train loss: 0.027953

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.024212

Epoch 11: valid_class_loss:0.024228	valid_position_loss:0.003873

Epoch 11: valid loss 0.02421179534810544 smaller than best loss 0.025077410312031752
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0038732275510239295 smaller than best position loss 0.0040157937758433645
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.013789  [   16/ 3543]

2431 class loss: 0.012964 position_loss:0.002239

2461 loss: 0.004900  [  496/ 3543]

2461 class loss: 0.009342 position_loss:0.000606

2491 loss: 0.012191  [  976/ 3543]

2491 class loss: 0.016026 position_loss:0.001797

2521 loss: 0.030075  [ 1456/ 3543]

2521 class loss: 0.051369 position_loss:0.003960

2551 loss: 0.006704  [ 1936/ 3543]

2551 class loss: 0.011430 position_loss:0.000884

2581 loss: 0.017457  [ 2416/ 3543]

2581 class loss: 0.029832 position_loss:0.002298

2611 loss: 0.017005  [ 2896/ 3543]

2611 class loss: 0.018048 position_loss:0.002679

2641 loss: 0.015485  [ 3376/ 3543]

2641 class loss: 0.030863 position_loss:0.001863

Epoch 12: train loss: 0.024604

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.021164

Epoch 12: valid_class_loss:0.022047	valid_position_loss:0.003351

Epoch 12: valid loss 0.02116403384979287 smaller than best loss 0.02421179534810544
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.003350929394721721 smaller than best position loss 0.0038732275510239295
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.019977  [   16/ 3543]

2652 class loss: 0.025739 position_loss:0.002966

2682 loss: 0.044037  [  496/ 3543]

2682 class loss: 0.063341 position_loss:0.006274

2712 loss: 0.006784  [  976/ 3543]

2712 class loss: 0.008664 position_loss:0.001010

2742 loss: 0.023621  [ 1456/ 3543]

2742 class loss: 0.039920 position_loss:0.003127

2772 loss: 0.012373  [ 1936/ 3543]

2772 class loss: 0.019127 position_loss:0.001710

2802 loss: 0.022305  [ 2416/ 3543]

2802 class loss: 0.016753 position_loss:0.003791

2832 loss: 0.015198  [ 2896/ 3543]

2832 class loss: 0.032062 position_loss:0.001757

2862 loss: 0.010078  [ 3376/ 3543]

2862 class loss: 0.022059 position_loss:0.001133

Epoch 13: train loss: 0.021723

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.019947

Epoch 13: valid_class_loss:0.022157	valid_position_loss:0.003103

Epoch 13: valid loss 0.01994701892762918 smaller than best loss 0.02116403384979287
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.0031031213273698135 smaller than best position loss 0.003350929394721721
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.024586  [   16/ 3543]

2873 class loss: 0.047913 position_loss:0.003001

2903 loss: 0.023332  [  496/ 3543]

2903 class loss: 0.036159 position_loss:0.003220

2933 loss: 0.016947  [  976/ 3543]

2933 class loss: 0.036934 position_loss:0.001912

2963 loss: 0.031112  [ 1456/ 3543]

2963 class loss: 0.047578 position_loss:0.004319

2993 loss: 0.023266  [ 1936/ 3543]

2993 class loss: 0.042452 position_loss:0.002955

3023 loss: 0.010117  [ 2416/ 3543]

3023 class loss: 0.018368 position_loss:0.001289

3053 loss: 0.015662  [ 2896/ 3543]

3053 class loss: 0.023306 position_loss:0.002200

3083 loss: 0.012259  [ 3376/ 3543]

3083 class loss: 0.019112 position_loss:0.001687

Epoch 14: train loss: 0.020039

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.019800

Epoch 14: valid_class_loss:0.019981	valid_position_loss:0.003161

Epoch 14: valid loss 0.01979995579049127 smaller than best loss 0.01994701892762918
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.045194  [   16/ 3543]

3094 class loss: 0.051389 position_loss:0.006983

3124 loss: 0.027032  [  496/ 3543]

3124 class loss: 0.023189 position_loss:0.004479

3154 loss: 0.011727  [  976/ 3543]

3154 class loss: 0.016697 position_loss:0.001678

3184 loss: 0.013815  [ 1456/ 3543]

3184 class loss: 0.025145 position_loss:0.001757

3214 loss: 0.004041  [ 1936/ 3543]

3214 class loss: 0.007251 position_loss:0.000518

3244 loss: 0.016478  [ 2416/ 3543]

3244 class loss: 0.016177 position_loss:0.002648

3274 loss: 0.026692  [ 2896/ 3543]

3274 class loss: 0.018167 position_loss:0.004612

3304 loss: 0.014967  [ 3376/ 3543]

3304 class loss: 0.022824 position_loss:0.002080

Epoch 15: train loss: 0.017761

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.018408

Epoch 15: valid_class_loss:0.020104	valid_position_loss:0.002877

Epoch 15: valid loss 0.018408294287524298 smaller than best loss 0.01979995579049127
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0028774853263021237 smaller than best position loss 0.0031031213273698135
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-24__23-53-54/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.758614
Nucleus_export  0.650133
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.873643  0.156524  0.126357
Nucleus_export  0.812088  0.231485  0.187912
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.381250
SIGNAL         0.867896
chloroplast    0.407895
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.989876                 0.919471           0.832317   
ER                   0.961946                 0.633101           0.752349   
Peroxisome           0.618027                 0.345062           0.552334   
Mitochondrion        0.916697                 0.883818           0.821619   
Nucleus_export       0.970463                 0.512936           0.438188   
SIGNAL               0.966056                 0.979264           0.846296   
chloroplast          0.924980                 0.816668           0.699740   
Thylakoid            0.994196                 0.555736           0.635272   

                recall_score  precision_score  f1_score  
Nucleus             0.960938         0.759259  0.848276  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.837500         0.858974  0.848101  
Nucleus_export      0.560000         0.368421  0.444444  
SIGNAL              0.952381         0.930931  0.941534  
chloroplast         0.750000         0.695122  0.721519  
Thylakoid           0.700000         0.583333  0.636364  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.630581
Nucleus_export  0.370632
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.729497  0.170651  0.270503
Nucleus_export  0.467976  0.177315  0.532024
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.264151
SIGNAL         0.883178
chloroplast    0.356164
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980460                 0.896581           0.805439   
ER                   0.998423                 0.926878           0.897611   
Peroxisome           0.883142                 0.557081           0.683551   
Mitochondrion        0.904470                 0.877863           0.809141   
Nucleus_export       0.950271                 0.267473           0.266772   
SIGNAL               0.964700                 0.975829           0.848712   
chloroplast          0.972979                 0.824144           0.760138   
Thylakoid            0.993957                 0.425136           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.942149         0.730769  0.823105  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.798742         0.875862  0.835526  
Nucleus_export      0.360000         0.230769  0.281250  
SIGNAL              0.950156         0.932722  0.941358  
chloroplast         0.849315         0.712644  0.775000  
Thylakoid           0.777778         0.466667  0.583333  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.630581
Nucleus_export  0.250986
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.729497  0.168177  0.212652
Nucleus_export  0.317500  0.103263  0.042500
===========================================

 cs acc: 

                      0
ER             0.962963
Peroxisome     0.857143
Mitochondrion  0.275591
SIGNAL         0.895082
chloroplast    0.403226
Thylakoid      0.714286
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980460                 0.896581           0.805439   
ER                   0.998423                 0.926878           0.897611   
Peroxisome           0.883142                 0.557081           0.683551   
Mitochondrion        0.904470                 0.877863           0.809141   
Nucleus_export       0.950271                 0.267473           0.266772   
SIGNAL               0.964700                 0.975829           0.848712   
chloroplast          0.972979                 0.824144           0.760138   
Thylakoid            0.993957                 0.425136           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.942149         0.730769  0.823105  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.798742         0.875862  0.835526  
Nucleus_export      0.360000         0.230769  0.281250  
SIGNAL              0.950156         0.932722  0.941358  
chloroplast         0.849315         0.712644  0.775000  
Thylakoid           0.777778         0.466667  0.583333  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.926652
Nucleus_export  0.450590
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         1.000000  0.079328  0.000000
Nucleus_export  0.566667  0.266130  0.433333
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.6  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.926652
Nucleus_export  0.300590
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.079328  0.0
Nucleus_export  0.4  0.219125  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.666667                     0.75                0.0   
ER                        NaN                    -0.00                0.0   
Peroxisome                NaN                    -0.00                0.0   
Mitochondrion             NaN                    -0.00                0.0   
Nucleus_export            NaN                     1.00                0.0   
SIGNAL                    NaN                    -0.00                0.0   
chloroplast               NaN                    -0.00                0.0   
Thylakoid                 NaN                    -0.00                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
