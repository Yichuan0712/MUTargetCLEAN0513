use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.125844  [   16/ 3543]

0 class loss: 0.026990 position_loss:0.024089

30 loss: 0.441118  [  496/ 3543]

30 class loss: 0.112470 position_loss:0.083725

60 loss: 0.088397  [  976/ 3543]

60 class loss: 0.019476 position_loss:0.016900

90 loss: 0.757974  [ 1456/ 3543]

90 class loss: 0.159357 position_loss:0.145220

120 loss: 0.613356  [ 1936/ 3543]

120 class loss: 0.121692 position_loss:0.117804

150 loss: 0.364536  [ 2416/ 3543]

150 class loss: 0.080228 position_loss:0.069698

180 loss: 0.443656  [ 2896/ 3543]

180 class loss: 0.095166 position_loss:0.084925

210 loss: 0.929435  [ 3376/ 3543]

210 class loss: 0.198874 position_loss:0.177932

Epoch 1: train loss: 0.478607

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.283067

Epoch 1: valid_class_loss:0.059072	valid_position_loss:0.054250

Epoch 1: valid loss 0.28306678792733386 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05425048777943752 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.228429  [   16/ 3543]

221 class loss: 0.051100 position_loss:0.043642

251 loss: 0.069575  [  496/ 3543]

251 class loss: 0.015108 position_loss:0.013311

281 loss: 0.626830  [  976/ 3543]

281 class loss: 0.156950 position_loss:0.119088

311 loss: 0.570867  [ 1456/ 3543]

311 class loss: 0.134004 position_loss:0.108813

341 loss: 0.439759  [ 1936/ 3543]

341 class loss: 0.086230 position_loss:0.084503

371 loss: 0.366036  [ 2416/ 3543]

371 class loss: 0.083995 position_loss:0.069847

401 loss: 0.208379  [ 2896/ 3543]

401 class loss: 0.047730 position_loss:0.039767

431 loss: 0.322988  [ 3376/ 3543]

431 class loss: 0.069873 position_loss:0.061803

Epoch 2: train loss: 0.418121

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.217816

Epoch 2: valid_class_loss:0.049319	valid_position_loss:0.041590

Epoch 2: valid loss 0.2178161866320767 smaller than best loss 0.28306678792733386
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.04159048798436374 smaller than best position loss 0.05425048777943752
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.483729  [   16/ 3543]

442 class loss: 0.111066 position_loss:0.092303

472 loss: 0.253453  [  496/ 3543]

472 class loss: 0.064076 position_loss:0.048128

502 loss: 0.371671  [  976/ 3543]

502 class loss: 0.081648 position_loss:0.071068

532 loss: 0.177022  [ 1456/ 3543]

532 class loss: 0.044448 position_loss:0.033626

562 loss: 0.387163  [ 1936/ 3543]

562 class loss: 0.109309 position_loss:0.073060

592 loss: 0.123420  [ 2416/ 3543]

592 class loss: 0.028043 position_loss:0.023562

622 loss: 0.253249  [ 2896/ 3543]

622 class loss: 0.074739 position_loss:0.047660

652 loss: 0.431741  [ 3376/ 3543]

652 class loss: 0.131977 position_loss:0.081069

Epoch 3: train loss: 0.277494

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.137471

Epoch 3: valid_class_loss:0.038746	valid_position_loss:0.025944

Epoch 3: valid loss 0.13747071706729186 smaller than best loss 0.2178161866320767
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.02594429482432902 smaller than best position loss 0.04159048798436374
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.256824  [   16/ 3543]

663 class loss: 0.081719 position_loss:0.048096

693 loss: 0.233251  [  496/ 3543]

693 class loss: 0.060418 position_loss:0.044233

723 loss: 0.214038  [  976/ 3543]

723 class loss: 0.083059 position_loss:0.039485

753 loss: 0.303573  [ 1456/ 3543]

753 class loss: 0.125430 position_loss:0.055697

783 loss: 0.057440  [ 1936/ 3543]

783 class loss: 0.024698 position_loss:0.010500

813 loss: 0.101119  [ 2416/ 3543]

813 class loss: 0.057902 position_loss:0.017908

843 loss: 0.196585  [ 2896/ 3543]

843 class loss: 0.110748 position_loss:0.034887

873 loss: 0.129572  [ 3376/ 3543]

873 class loss: 0.077780 position_loss:0.022803

Epoch 4: train loss: 0.163073

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.073335

Epoch 4: valid_class_loss:0.032710	valid_position_loss:0.013359

Epoch 4: valid loss 0.07333502700660366 smaller than best loss 0.13747071706729186
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.013358600913941455 smaller than best position loss 0.02594429482432902
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.145271  [   16/ 3543]

884 class loss: 0.092281 position_loss:0.025363

914 loss: 0.065785  [  496/ 3543]

914 class loss: 0.051883 position_loss:0.011082

944 loss: 0.102215  [  976/ 3543]

944 class loss: 0.066740 position_loss:0.017773

974 loss: 0.054157  [ 1456/ 3543]

974 class loss: 0.037687 position_loss:0.009324

1004 loss: 0.048973  [ 1936/ 3543]

1004 class loss: 0.044374 position_loss:0.008020

1034 loss: 0.071812  [ 2416/ 3543]

1034 class loss: 0.025122 position_loss:0.013358

1064 loss: 0.112322  [ 2896/ 3543]

1064 class loss: 0.088773 position_loss:0.018913

1094 loss: 0.046951  [ 3376/ 3543]

1094 class loss: 0.037749 position_loss:0.007880

Epoch 5: train loss: 0.092955

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.060974

Epoch 5: valid_class_loss:0.030949	valid_position_loss:0.010957

Epoch 5: valid loss 0.060974302359050866 smaller than best loss 0.07333502700660366
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.010956906076413643 smaller than best position loss 0.013358600913941455
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.059927  [   16/ 3543]

1105 class loss: 0.088329 position_loss:0.008452

1135 loss: 0.090350  [  496/ 3543]

1135 class loss: 0.062806 position_loss:0.015558

1165 loss: 0.030839  [  976/ 3543]

1165 class loss: 0.008894 position_loss:0.005812

1195 loss: 0.035496  [ 1456/ 3543]

1195 class loss: 0.033395 position_loss:0.005763

1225 loss: 0.047255  [ 1936/ 3543]

1225 class loss: 0.051345 position_loss:0.007397

1255 loss: 0.079748  [ 2416/ 3543]

1255 class loss: 0.077750 position_loss:0.012840

1285 loss: 0.096204  [ 2896/ 3543]

1285 class loss: 0.109743 position_loss:0.014851

1315 loss: 0.074874  [ 3376/ 3543]

1315 class loss: 0.072119 position_loss:0.012090

Epoch 6: train loss: 0.077046

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.052432

Epoch 6: valid_class_loss:0.029978	valid_position_loss:0.009287

Epoch 6: valid loss 0.05243208325790646 smaller than best loss 0.060974302359050866
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.00928730384304359 smaller than best position loss 0.010956906076413643
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.108237  [   16/ 3543]

1326 class loss: 0.096636 position_loss:0.017782

1356 loss: 0.099883  [  496/ 3543]

1356 class loss: 0.075685 position_loss:0.016949

1386 loss: 0.035378  [  976/ 3543]

1386 class loss: 0.038431 position_loss:0.005538

1416 loss: 0.050909  [ 1456/ 3543]

1416 class loss: 0.060167 position_loss:0.007775

1446 loss: 0.038303  [ 1936/ 3543]

1446 class loss: 0.043938 position_loss:0.005903

1476 loss: 0.023963  [ 2416/ 3543]

1476 class loss: 0.025891 position_loss:0.003757

1506 loss: 0.028683  [ 2896/ 3543]

1506 class loss: 0.036619 position_loss:0.004272

1536 loss: 0.058995  [ 3376/ 3543]

1536 class loss: 0.031570 position_loss:0.010536

Epoch 7: train loss: 0.064677

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.038590

Epoch 7: valid_class_loss:0.028966	valid_position_loss:0.006559

Epoch 7: valid loss 0.038589924218010205 smaller than best loss 0.05243208325790646
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.006559357883254321 smaller than best position loss 0.00928730384304359
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.055530  [   16/ 3543]

1547 class loss: 0.044718 position_loss:0.009317

1577 loss: 0.041378  [  496/ 3543]

1577 class loss: 0.021802 position_loss:0.007404

1607 loss: 0.077441  [  976/ 3543]

1607 class loss: 0.060766 position_loss:0.013058

1637 loss: 0.069900  [ 1456/ 3543]

1637 class loss: 0.065312 position_loss:0.011367

1667 loss: 0.096725  [ 1936/ 3543]

1667 class loss: 0.092812 position_loss:0.015633

1697 loss: 0.056246  [ 2416/ 3543]

1697 class loss: 0.053532 position_loss:0.009108

1727 loss: 0.047675  [ 2896/ 3543]

1727 class loss: 0.044797 position_loss:0.007743

1757 loss: 0.067778  [ 3376/ 3543]

1757 class loss: 0.077038 position_loss:0.010474

Epoch 8: train loss: 0.049264

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.032942

Epoch 8: valid_class_loss:0.029847	valid_position_loss:0.005394

Epoch 8: valid loss 0.032941555422492046 smaller than best loss 0.038589924218010205
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.005394440755273593 smaller than best position loss 0.006559357883254321
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.044935  [   16/ 3543]

1768 class loss: 0.063883 position_loss:0.006432

1798 loss: 0.027038  [  496/ 3543]

1798 class loss: 0.017728 position_loss:0.004699

1828 loss: 0.069965  [  976/ 3543]

1828 class loss: 0.083746 position_loss:0.010643

1858 loss: 0.036159  [ 1456/ 3543]

1858 class loss: 0.049616 position_loss:0.005247

1888 loss: 0.044578  [ 1936/ 3543]

1888 class loss: 0.040704 position_loss:0.007288

1918 loss: 0.042383  [ 2416/ 3543]

1918 class loss: 0.049731 position_loss:0.006487

1948 loss: 0.033139  [ 2896/ 3543]

1948 class loss: 0.048425 position_loss:0.004691

1978 loss: 0.033663  [ 3376/ 3543]

1978 class loss: 0.022178 position_loss:0.005846

Epoch 9: train loss: 0.038459

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.028226

Epoch 9: valid_class_loss:0.026794	valid_position_loss:0.004574

Epoch 9: valid loss 0.028226458100372942 smaller than best loss 0.032941555422492046
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.004573549346455976 smaller than best position loss 0.005394440755273593
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.014334  [   16/ 3543]

1989 class loss: 0.023896 position_loss:0.001911

2019 loss: 0.033876  [  496/ 3543]

2019 class loss: 0.040685 position_loss:0.005148

2049 loss: 0.055843  [  976/ 3543]

2049 class loss: 0.043703 position_loss:0.009421

2079 loss: 0.010020  [ 1456/ 3543]

2079 class loss: 0.019225 position_loss:0.001235

2109 loss: 0.032799  [ 1936/ 3543]

2109 class loss: 0.042641 position_loss:0.004854

2139 loss: 0.026272  [ 2416/ 3543]

2139 class loss: 0.031575 position_loss:0.003991

2169 loss: 0.026889  [ 2896/ 3543]

2169 class loss: 0.034608 position_loss:0.003993

2199 loss: 0.023618  [ 3376/ 3543]

2199 class loss: 0.031891 position_loss:0.003448

Epoch 10: train loss: 0.032478

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.025186

Epoch 10: valid_class_loss:0.024869	valid_position_loss:0.004042

Epoch 10: valid loss 0.02518605843676068 smaller than best loss 0.028226458100372942
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.004042454991407428 smaller than best position loss 0.004573549346455976
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.031353  [   16/ 3543]

2210 class loss: 0.025683 position_loss:0.005243

2240 loss: 0.041011  [  496/ 3543]

2240 class loss: 0.021868 position_loss:0.007327

2270 loss: 0.023412  [  976/ 3543]

2270 class loss: 0.037499 position_loss:0.003183

2300 loss: 0.015401  [ 1456/ 3543]

2300 class loss: 0.026720 position_loss:0.002011

2330 loss: 0.048650  [ 1936/ 3543]

2330 class loss: 0.054798 position_loss:0.007538

2360 loss: 0.042869  [ 2416/ 3543]

2360 class loss: 0.022313 position_loss:0.007681

2390 loss: 0.046893  [ 2896/ 3543]

2390 class loss: 0.059922 position_loss:0.006982

2420 loss: 0.021644  [ 3376/ 3543]

2420 class loss: 0.036128 position_loss:0.002884

Epoch 11: train loss: 0.028097

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.024451

Epoch 11: valid_class_loss:0.024183	valid_position_loss:0.003923

Epoch 11: valid loss 0.02445078770330366 smaller than best loss 0.02518605843676068
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.0039228227539265205 smaller than best position loss 0.004042454991407428
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.013952  [   16/ 3543]

2431 class loss: 0.012859 position_loss:0.002276

2461 loss: 0.004892  [  496/ 3543]

2461 class loss: 0.009320 position_loss:0.000606

2491 loss: 0.012198  [  976/ 3543]

2491 class loss: 0.016276 position_loss:0.001789

2521 loss: 0.030040  [ 1456/ 3543]

2521 class loss: 0.050986 position_loss:0.003969

2551 loss: 0.006728  [ 1936/ 3543]

2551 class loss: 0.011493 position_loss:0.000886

2581 loss: 0.017885  [ 2416/ 3543]

2581 class loss: 0.030793 position_loss:0.002345

2611 loss: 0.017229  [ 2896/ 3543]

2611 class loss: 0.018090 position_loss:0.002722

2641 loss: 0.015354  [ 3376/ 3543]

2641 class loss: 0.030286 position_loss:0.001859

Epoch 12: train loss: 0.024694

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.021392

Epoch 12: valid_class_loss:0.021935	valid_position_loss:0.003401

Epoch 12: valid loss 0.02139190780695352 smaller than best loss 0.02445078770330366
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.0034009810602658704 smaller than best position loss 0.0039228227539265205
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.019933  [   16/ 3543]

2652 class loss: 0.025617 position_loss:0.002962

2682 loss: 0.043582  [  496/ 3543]

2682 class loss: 0.061272 position_loss:0.006265

2712 loss: 0.006899  [  976/ 3543]

2712 class loss: 0.008970 position_loss:0.001021

2742 loss: 0.023387  [ 1456/ 3543]

2742 class loss: 0.038739 position_loss:0.003128

2772 loss: 0.012319  [ 1936/ 3543]

2772 class loss: 0.019140 position_loss:0.001698

2802 loss: 0.022819  [ 2416/ 3543]

2802 class loss: 0.016786 position_loss:0.003892

2832 loss: 0.015050  [ 2896/ 3543]

2832 class loss: 0.031400 position_loss:0.001754

2862 loss: 0.009980  [ 3376/ 3543]

2862 class loss: 0.021634 position_loss:0.001131

Epoch 13: train loss: 0.021814

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.020135

Epoch 13: valid_class_loss:0.021996	valid_position_loss:0.003147

Epoch 13: valid loss 0.02013538878130127 smaller than best loss 0.02139190780695352
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.003147236936308182 smaller than best position loss 0.0034009810602658704
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.024526  [   16/ 3543]

2873 class loss: 0.047546 position_loss:0.003003

2903 loss: 0.023354  [  496/ 3543]

2903 class loss: 0.036052 position_loss:0.003229

2933 loss: 0.016947  [  976/ 3543]

2933 class loss: 0.036909 position_loss:0.001913

2963 loss: 0.031166  [ 1456/ 3543]

2963 class loss: 0.047892 position_loss:0.004318

2993 loss: 0.023064  [ 1936/ 3543]

2993 class loss: 0.041698 position_loss:0.002945

3023 loss: 0.010253  [ 2416/ 3543]

3023 class loss: 0.018415 position_loss:0.001314

3053 loss: 0.015819  [ 2896/ 3543]

3053 class loss: 0.023199 position_loss:0.002236

3083 loss: 0.012536  [ 3376/ 3543]

3083 class loss: 0.020078 position_loss:0.001704

Epoch 14: train loss: 0.020109

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.019980

Epoch 14: valid_class_loss:0.019875	valid_position_loss:0.003201

Epoch 14: valid loss 0.019979981609900298 smaller than best loss 0.02013538878130127
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.045777  [   16/ 3543]

3094 class loss: 0.051891 position_loss:0.007080

3124 loss: 0.027132  [  496/ 3543]

3124 class loss: 0.023678 position_loss:0.004479

3154 loss: 0.011835  [  976/ 3543]

3154 class loss: 0.016886 position_loss:0.001692

3184 loss: 0.013680  [ 1456/ 3543]

3184 class loss: 0.024852 position_loss:0.001742

3214 loss: 0.004021  [ 1936/ 3543]

3214 class loss: 0.007228 position_loss:0.000515

3244 loss: 0.016913  [ 2416/ 3543]

3244 class loss: 0.016680 position_loss:0.002715

3274 loss: 0.027043  [ 2896/ 3543]

3274 class loss: 0.018411 position_loss:0.004672

3304 loss: 0.015522  [ 3376/ 3543]

3304 class loss: 0.023202 position_loss:0.002176

Epoch 15: train loss: 0.017828

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.018600

Epoch 15: valid_class_loss:0.019913	valid_position_loss:0.002923

Epoch 15: valid loss 0.01859987943481756 smaller than best loss 0.019979981609900298
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.002923459278077094 smaller than best position loss 0.003147236936308182
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0624_dpr/2024-06-25__01-13-07/checkpoints/best_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.756095
Nucleus_export  0.645415
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.863607  0.146127  0.136393
Nucleus_export  0.805082  0.228802  0.194918
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.307692
Mitochondrion  0.381250
SIGNAL         0.867896
chloroplast    0.394737
Thylakoid      0.800000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.990044                 0.920938           0.838861   
ER                   0.964242                 0.630028           0.752349   
Peroxisome           0.611641                 0.341249           0.552334   
Mitochondrion        0.917481                 0.885618           0.825750   
Nucleus_export       0.970154                 0.501523           0.444651   
SIGNAL               0.966509                 0.979478           0.856417   
chloroplast          0.927211                 0.819668           0.714804   
Thylakoid            0.994291                 0.556576           0.635272   

                recall_score  precision_score  f1_score  
Nucleus             0.898438         0.821429  0.858209  
ER                  0.866667         0.666667  0.753623  
Peroxisome          0.307692         1.000000  0.470588  
Mitochondrion       0.843750         0.859873  0.851735  
Nucleus_export      0.560000         0.378378  0.451613  
SIGNAL              0.952381         0.937973  0.945122  
chloroplast         0.750000         0.721519  0.735484  
Thylakoid           0.700000         0.583333  0.636364  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.616529
Nucleus_export  0.371219
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.704293  0.157798  0.295707
Nucleus_export  0.467976  0.176177  0.532024
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.461538
Mitochondrion  0.276730
SIGNAL         0.881620
chloroplast    0.369863
Thylakoid      0.777778
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980813                 0.894375           0.832792   
ER                   0.998356                 0.921438           0.897611   
Peroxisome           0.865753                 0.554646           0.683551   
Mitochondrion        0.904449                 0.877658           0.805654   
Nucleus_export       0.950426                 0.266589           0.289189   
SIGNAL               0.965428                 0.976312           0.848712   
chloroplast          0.973786                 0.830141           0.761463   
Thylakoid            0.993851                 0.420197           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.807407  0.851562  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.798742         0.869863  0.832787  
Nucleus_export      0.360000         0.264706  0.305085  
SIGNAL              0.950156         0.932722  0.941358  
chloroplast         0.835616         0.726190  0.777070  
Thylakoid           0.777778         0.466667  0.583333  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.605730
Nucleus_export  0.251266
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.692929  0.152246  0.207897
Nucleus_export  0.317500  0.102449  0.042500
===========================================

 cs acc: 

                      0
ER             0.962963
Peroxisome     0.857143
Mitochondrion  0.283465
SIGNAL         0.893443
chloroplast    0.426230
Thylakoid      0.714286
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.980813                 0.894375           0.832792   
ER                   0.998356                 0.921438           0.897611   
Peroxisome           0.865753                 0.554646           0.683551   
Mitochondrion        0.904449                 0.877658           0.805654   
Nucleus_export       0.950426                 0.266589           0.289189   
SIGNAL               0.965428                 0.976312           0.848712   
chloroplast          0.973786                 0.830141           0.761463   
Thylakoid            0.993851                 0.420197           0.598266   

                recall_score  precision_score  f1_score  
Nucleus             0.900826         0.807407  0.851562  
ER                  0.931034         0.870968  0.900000  
Peroxisome          0.538462         0.875000  0.666667  
Mitochondrion       0.798742         0.869863  0.832787  
Nucleus_export      0.360000         0.264706  0.305085  
SIGNAL              0.950156         0.932722  0.941358  
chloroplast         0.835616         0.726190  0.777070  
Thylakoid           0.777778         0.466667  0.583333  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927684
Nucleus_export  0.453977
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         1.000000  0.078233  0.000000
Nucleus_export  0.566667  0.259293  0.433333
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.7  0.4         0.5            0.2             0.9     0.2   
cutoffs_aa       0.2  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.4        0.8  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.927684
Nucleus_export  0.302601
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.078233  0.0
Nucleus_export  0.4  0.213656  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.833333                 0.833333                0.0   
ER                        NaN                -0.000000                0.0   
Peroxisome                NaN                -0.000000                0.0   
Mitochondrion             NaN                -0.000000                0.0   
Nucleus_export            NaN                 1.000000                0.0   
SIGNAL                    NaN                -0.000000                0.0   
chloroplast               NaN                -0.000000                0.0   
Thylakoid                 NaN                -0.000000                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
