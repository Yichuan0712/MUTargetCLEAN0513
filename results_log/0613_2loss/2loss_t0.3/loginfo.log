use k-fold index: 0

Done Loading data

number of steps for training data: 221

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 221

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.107314  [   16/ 3543]

0 class loss: 0.026852 position_loss:0.024139

30 loss: 0.390867  [  496/ 3543]

30 class loss: 0.111590 position_loss:0.083783

60 loss: 0.075500  [  976/ 3543]

60 class loss: 0.019310 position_loss:0.016857

90 loss: 0.644313  [ 1456/ 3543]

90 class loss: 0.159999 position_loss:0.145294

120 loss: 0.512389  [ 1936/ 3543]

120 class loss: 0.120451 position_loss:0.117581

150 loss: 0.311586  [ 2416/ 3543]

150 class loss: 0.079246 position_loss:0.069702

180 loss: 0.378544  [ 2896/ 3543]

180 class loss: 0.094848 position_loss:0.085109

210 loss: 0.793605  [ 3376/ 3543]

210 class loss: 0.196970 position_loss:0.178990

Epoch 1: train loss: 0.408512

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.241530

Epoch 1: valid_class_loss:0.059009	valid_position_loss:0.054756

Epoch 1: valid loss 0.2415301415979599 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 1: valid position loss 0.05475645815268226 smaller than best position loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

221 loss: 0.197837  [   16/ 3543]

221 class loss: 0.050995 position_loss:0.044053

251 loss: 0.059784  [  496/ 3543]

251 class loss: 0.015027 position_loss:0.013427

281 loss: 0.556107  [  976/ 3543]

281 class loss: 0.154077 position_loss:0.120609

311 loss: 0.506384  [ 1456/ 3543]

311 class loss: 0.134626 position_loss:0.111527

341 loss: 0.376000  [ 1936/ 3543]

341 class loss: 0.086884 position_loss:0.086735

371 loss: 0.328197  [ 2416/ 3543]

371 class loss: 0.085107 position_loss:0.072927

401 loss: 0.191575  [ 2896/ 3543]

401 class loss: 0.048493 position_loss:0.042925

431 loss: 0.289149  [ 3376/ 3543]

431 class loss: 0.071518 position_loss:0.065289

Epoch 2: train loss: 0.369433

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.203119

Epoch 2: valid_class_loss:0.051577	valid_position_loss:0.045462

Epoch 2: valid loss 0.20311873157329122 smaller than best loss 0.2415301415979599
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 2: valid position loss 0.04546243721364127 smaller than best position loss 0.05475645815268226
-------------------------------

Epoch 2: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

442 loss: 0.448033  [   16/ 3543]

442 class loss: 0.114873 position_loss:0.099948

472 loss: 0.240704  [  496/ 3543]

472 class loss: 0.066959 position_loss:0.052124

502 loss: 0.341692  [  976/ 3543]

502 class loss: 0.083932 position_loss:0.077328

532 loss: 0.168232  [ 1456/ 3543]

532 class loss: 0.045846 position_loss:0.036716

562 loss: 0.374027  [ 1936/ 3543]

562 class loss: 0.111012 position_loss:0.078905

592 loss: 0.112652  [ 2416/ 3543]

592 class loss: 0.028647 position_loss:0.025202

622 loss: 0.244270  [ 2896/ 3543]

622 class loss: 0.074395 position_loss:0.050962

652 loss: 0.416483  [ 3376/ 3543]

652 class loss: 0.130776 position_loss:0.085712

Epoch 3: train loss: 0.263867

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.133116

Epoch 3: valid_class_loss:0.039355	valid_position_loss:0.028129

Epoch 3: valid loss 0.133116494200786 smaller than best loss 0.20311873157329122
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 3: valid position loss 0.028128505509808662 smaller than best position loss 0.04546243721364127
-------------------------------

Epoch 3: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

663 loss: 0.249823  [   16/ 3543]

663 class loss: 0.080391 position_loss:0.050830

693 loss: 0.216757  [  496/ 3543]

693 class loss: 0.060620 position_loss:0.046841

723 loss: 0.219564  [  976/ 3543]

723 class loss: 0.077289 position_loss:0.042683

753 loss: 0.325619  [ 1456/ 3543]

753 class loss: 0.118137 position_loss:0.062245

783 loss: 0.064404  [ 1936/ 3543]

783 class loss: 0.024199 position_loss:0.012062

813 loss: 0.129042  [ 2416/ 3543]

813 class loss: 0.053468 position_loss:0.022672

843 loss: 0.257502  [ 2896/ 3543]

843 class loss: 0.104147 position_loss:0.046006

873 loss: 0.167489  [ 3376/ 3543]

873 class loss: 0.071487 position_loss:0.028801

Epoch 4: train loss: 0.178377

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.083603

Epoch 4: valid_class_loss:0.033582	valid_position_loss:0.015006

Epoch 4: valid loss 0.0836034234870016 smaller than best loss 0.133116494200786
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 4: valid position loss 0.01500634400859551 smaller than best position loss 0.028128505509808662
-------------------------------

Epoch 4: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

884 loss: 0.197707  [   16/ 3543]

884 class loss: 0.087974 position_loss:0.032920

914 loss: 0.097419  [  496/ 3543]

914 class loss: 0.047128 position_loss:0.015087

944 loss: 0.130021  [  976/ 3543]

944 class loss: 0.059407 position_loss:0.021184

974 loss: 0.072469  [ 1456/ 3543]

974 class loss: 0.034943 position_loss:0.011258

1004 loss: 0.075165  [ 1936/ 3543]

1004 class loss: 0.042232 position_loss:0.009880

1034 loss: 0.069559  [ 2416/ 3543]

1034 class loss: 0.025573 position_loss:0.013196

1064 loss: 0.155325  [ 2896/ 3543]

1064 class loss: 0.083325 position_loss:0.021600

1094 loss: 0.064265  [ 3376/ 3543]

1094 class loss: 0.034992 position_loss:0.008782

Epoch 5: train loss: 0.118407

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.067510

Epoch 5: valid_class_loss:0.029749	valid_position_loss:0.011329

Epoch 5: valid loss 0.06751034592516617 smaller than best loss 0.0836034234870016
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 5: valid position loss 0.01132851481789278 smaller than best position loss 0.01500634400859551
-------------------------------

Epoch 5: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

1105 loss: 0.099387  [   16/ 3543]

1105 class loss: 0.066051 position_loss:0.010001

1135 loss: 0.106896  [  496/ 3543]

1135 class loss: 0.051896 position_loss:0.016500

1165 loss: 0.030041  [  976/ 3543]

1165 class loss: 0.009733 position_loss:0.006092

1195 loss: 0.051093  [ 1456/ 3543]

1195 class loss: 0.029443 position_loss:0.006495

1225 loss: 0.070178  [ 1936/ 3543]

1225 class loss: 0.042244 position_loss:0.008380

1255 loss: 0.113058  [ 2416/ 3543]

1255 class loss: 0.065143 position_loss:0.014375

1285 loss: 0.142039  [ 2896/ 3543]

1285 class loss: 0.085421 position_loss:0.016985

1315 loss: 0.109906  [ 3376/ 3543]

1315 class loss: 0.064815 position_loss:0.013527

Epoch 6: train loss: 0.097822

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.064026

Epoch 6: valid_class_loss:0.029186	valid_position_loss:0.010452

Epoch 6: valid loss 0.06402574225832129 smaller than best loss 0.06751034592516617
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 6: valid position loss 0.010451776546896276 smaller than best position loss 0.01132851481789278
-------------------------------

Epoch 6: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 7 train...
-------------------------------

1326 loss: 0.152113  [   16/ 3543]

1326 class loss: 0.083481 position_loss:0.020589

1356 loss: 0.124507  [  496/ 3543]

1356 class loss: 0.061710 position_loss:0.018839

1386 loss: 0.055560  [  976/ 3543]

1386 class loss: 0.034869 position_loss:0.006207

1416 loss: 0.080621  [ 1456/ 3543]

1416 class loss: 0.048776 position_loss:0.009554

1446 loss: 0.059841  [ 1936/ 3543]

1446 class loss: 0.036812 position_loss:0.006909

1476 loss: 0.039249  [ 2416/ 3543]

1476 class loss: 0.024313 position_loss:0.004481

1506 loss: 0.048283  [ 2896/ 3543]

1506 class loss: 0.030629 position_loss:0.005296

1536 loss: 0.077671  [ 3376/ 3543]

1536 class loss: 0.034624 position_loss:0.012914

Epoch 7: train loss: 0.087041

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.056550

Epoch 7: valid_class_loss:0.026325	valid_position_loss:0.009067

Epoch 7: valid loss 0.056549810871011096 smaller than best loss 0.06402574225832129
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 7: valid position loss 0.009067451947071929 smaller than best position loss 0.010451776546896276
-------------------------------

Epoch 7: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 8 train...
-------------------------------

1547 loss: 0.074121  [   16/ 3543]

1547 class loss: 0.039040 position_loss:0.010524

1577 loss: 0.064663  [  496/ 3543]

1577 class loss: 0.024654 position_loss:0.012003

1607 loss: 0.116139  [  976/ 3543]

1607 class loss: 0.052743 position_loss:0.019019

1637 loss: 0.118604  [ 1456/ 3543]

1637 class loss: 0.057812 position_loss:0.018238

1667 loss: 0.162438  [ 1936/ 3543]

1667 class loss: 0.079208 position_loss:0.024969

1697 loss: 0.098413  [ 2416/ 3543]

1697 class loss: 0.045396 position_loss:0.015905

1727 loss: 0.077353  [ 2896/ 3543]

1727 class loss: 0.037843 position_loss:0.011853

1757 loss: 0.112756  [ 3376/ 3543]

1757 class loss: 0.054340 position_loss:0.017525

Epoch 8: train loss: 0.077486

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.049407

Epoch 8: valid_class_loss:0.024447	valid_position_loss:0.007488

Epoch 8: valid loss 0.049406876776697375 smaller than best loss 0.056549810871011096
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 8: valid position loss 0.007488102626695114 smaller than best position loss 0.009067451947071929
-------------------------------

Epoch 8: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 9 train...
-------------------------------

1768 loss: 0.075846  [   16/ 3543]

1768 class loss: 0.045676 position_loss:0.009051

1798 loss: 0.047700  [  496/ 3543]

1798 class loss: 0.022290 position_loss:0.007623

1828 loss: 0.134737  [  976/ 3543]

1828 class loss: 0.068739 position_loss:0.019799

1858 loss: 0.063677  [ 1456/ 3543]

1858 class loss: 0.039192 position_loss:0.007345

1888 loss: 0.071588  [ 1936/ 3543]

1888 class loss: 0.035473 position_loss:0.010834

1918 loss: 0.087258  [ 2416/ 3543]

1918 class loss: 0.052404 position_loss:0.010456

1948 loss: 0.062452  [ 2896/ 3543]

1948 class loss: 0.038490 position_loss:0.007189

1978 loss: 0.051596  [ 3376/ 3543]

1978 class loss: 0.022249 position_loss:0.008804

Epoch 9: train loss: 0.065523

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.043574

Epoch 9: valid_class_loss:0.022298	valid_position_loss:0.006383

Epoch 9: valid loss 0.04357361309627309 smaller than best loss 0.049406876776697375
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 9: valid position loss 0.006382656975887008 smaller than best position loss 0.007488102626695114
-------------------------------

Epoch 9: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 10 train...
-------------------------------

1989 loss: 0.027013  [   16/ 3543]

1989 class loss: 0.017633 position_loss:0.002814

2019 loss: 0.052741  [  496/ 3543]

2019 class loss: 0.031563 position_loss:0.006354

2049 loss: 0.095510  [  976/ 3543]

2049 class loss: 0.037748 position_loss:0.017328

2079 loss: 0.021315  [ 1456/ 3543]

2079 class loss: 0.015457 position_loss:0.001757

2109 loss: 0.058295  [ 1936/ 3543]

2109 class loss: 0.035273 position_loss:0.006907

2139 loss: 0.054989  [ 2416/ 3543]

2139 class loss: 0.029947 position_loss:0.007513

2169 loss: 0.055665  [ 2896/ 3543]

2169 class loss: 0.028806 position_loss:0.008058

2199 loss: 0.055336  [ 3376/ 3543]

2199 class loss: 0.025852 position_loss:0.008845

Epoch 10: train loss: 0.054611

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.040315

Epoch 10: valid_class_loss:0.021097	valid_position_loss:0.005765

Epoch 10: valid loss 0.04031542331988051 smaller than best loss 0.04357361309627309
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 10: valid position loss 0.005765479375401886 smaller than best position loss 0.006382656975887008
-------------------------------

Epoch 10: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 11 train...
-------------------------------

2210 loss: 0.043780  [   16/ 3543]

2210 class loss: 0.019332 position_loss:0.007334

2240 loss: 0.050016  [  496/ 3543]

2240 class loss: 0.020073 position_loss:0.008983

2270 loss: 0.036323  [  976/ 3543]

2270 class loss: 0.022017 position_loss:0.004292

2300 loss: 0.022188  [ 1456/ 3543]

2300 class loss: 0.014415 position_loss:0.002332

2330 loss: 0.067919  [ 1936/ 3543]

2330 class loss: 0.035539 position_loss:0.009714

2360 loss: 0.057471  [ 2416/ 3543]

2360 class loss: 0.020304 position_loss:0.011150

2390 loss: 0.075501  [ 2896/ 3543]

2390 class loss: 0.042559 position_loss:0.009883

2420 loss: 0.033531  [ 3376/ 3543]

2420 class loss: 0.022758 position_loss:0.003232

Epoch 11: train loss: 0.046578

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.037135

Epoch 11: valid_class_loss:0.019626	valid_position_loss:0.005253

Epoch 11: valid loss 0.037135360326094484 smaller than best loss 0.04031542331988051
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 11: valid position loss 0.00525268014168694 smaller than best position loss 0.005765479375401886
-------------------------------

Epoch 11: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 12 train...
-------------------------------

2431 loss: 0.017917  [   16/ 3543]

2431 class loss: 0.009952 position_loss:0.002390

2461 loss: 0.009329  [  496/ 3543]

2461 class loss: 0.006767 position_loss:0.000769

2491 loss: 0.018646  [  976/ 3543]

2491 class loss: 0.011905 position_loss:0.002022

2521 loss: 0.060165  [ 1456/ 3543]

2521 class loss: 0.042147 position_loss:0.005405

2551 loss: 0.012894  [ 1936/ 3543]

2551 class loss: 0.009041 position_loss:0.001156

2581 loss: 0.031872  [ 2416/ 3543]

2581 class loss: 0.020090 position_loss:0.003535

2611 loss: 0.026278  [ 2896/ 3543]

2611 class loss: 0.013513 position_loss:0.003829

2641 loss: 0.027966  [ 3376/ 3543]

2641 class loss: 0.018673 position_loss:0.002788

Epoch 12: train loss: 0.041104

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.032650

Epoch 12: valid_class_loss:0.017814	valid_position_loss:0.004451

Epoch 12: valid loss 0.03265036225934229 smaller than best loss 0.037135360326094484
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 12: valid position loss 0.00445091302871226 smaller than best position loss 0.00525268014168694
-------------------------------

Epoch 12: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 13 train...
-------------------------------

2652 loss: 0.038342  [   16/ 3543]

2652 class loss: 0.018534 position_loss:0.005943

2682 loss: 0.072843  [  496/ 3543]

2682 class loss: 0.045165 position_loss:0.008303

2712 loss: 0.010453  [  976/ 3543]

2712 class loss: 0.006671 position_loss:0.001135

2742 loss: 0.038962  [ 1456/ 3543]

2742 class loss: 0.023389 position_loss:0.004672

2772 loss: 0.016116  [ 1936/ 3543]

2772 class loss: 0.010385 position_loss:0.001719

2802 loss: 0.041092  [ 2416/ 3543]

2802 class loss: 0.016169 position_loss:0.007477

2832 loss: 0.024489  [ 2896/ 3543]

2832 class loss: 0.016528 position_loss:0.002388

2862 loss: 0.019973  [ 3376/ 3543]

2862 class loss: 0.015518 position_loss:0.001336

Epoch 13: train loss: 0.036583

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.031228

Epoch 13: valid_class_loss:0.017076	valid_position_loss:0.004246

Epoch 13: valid loss 0.031228146525725257 smaller than best loss 0.03265036225934229
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 13: valid position loss 0.004245764026277174 smaller than best position loss 0.00445091302871226
-------------------------------

Epoch 13: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 14 train...
-------------------------------

2873 loss: 0.044557  [   16/ 3543]

2873 class loss: 0.029879 position_loss:0.004403

2903 loss: 0.039591  [  496/ 3543]

2903 class loss: 0.023440 position_loss:0.004845

2933 loss: 0.040727  [  976/ 3543]

2933 class loss: 0.032483 position_loss:0.002473

2963 loss: 0.044863  [ 1456/ 3543]

2963 class loss: 0.028126 position_loss:0.005021

2993 loss: 0.036887  [ 1936/ 3543]

2993 class loss: 0.024990 position_loss:0.003569

3023 loss: 0.020040  [ 2416/ 3543]

3023 class loss: 0.013642 position_loss:0.001919

3053 loss: 0.025527  [ 2896/ 3543]

3053 class loss: 0.012990 position_loss:0.003761

3083 loss: 0.022042  [ 3376/ 3543]

3083 class loss: 0.013252 position_loss:0.002637

Epoch 14: train loss: 0.033049

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.029885

Epoch 14: valid_class_loss:0.016159	valid_position_loss:0.004118

Epoch 14: valid loss 0.02988463798852691 smaller than best loss 0.031228146525725257
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 14: valid position loss 0.004117785794887842 smaller than best position loss 0.004245764026277174
-------------------------------

Epoch 14: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Fold 0 Epoch 15 train...
-------------------------------

3094 loss: 0.061972  [   16/ 3543]

3094 class loss: 0.029506 position_loss:0.009740

3124 loss: 0.041031  [  496/ 3543]

3124 class loss: 0.018795 position_loss:0.006671

3154 loss: 0.022757  [  976/ 3543]

3154 class loss: 0.012624 position_loss:0.003040

3184 loss: 0.024147  [ 1456/ 3543]

3184 class loss: 0.013548 position_loss:0.003180

3214 loss: 0.008183  [ 1936/ 3543]

3214 class loss: 0.006165 position_loss:0.000605

3244 loss: 0.032007  [ 2416/ 3543]

3244 class loss: 0.011444 position_loss:0.006169

3274 loss: 0.040434  [ 2896/ 3543]

3274 class loss: 0.013936 position_loss:0.007949

3304 loss: 0.031978  [ 3376/ 3543]

3304 class loss: 0.017304 position_loss:0.004402

Epoch 15: train loss: 0.030226

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.028211

Epoch 15: valid_class_loss:0.016036	valid_position_loss:0.003652

Epoch 15: valid loss 0.028211097795036576 smaller than best loss 0.02988463798852691
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_model.pth 
-------------------------------

Epoch 15: valid position loss 0.0036523930205636557 smaller than best position loss 0.004117785794887842
-------------------------------

Epoch 15: A better checkpoint is saved into /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth 
-------------------------------

Loading checkpoint from /mnt/pixstor/data/yz3qt/MUTargetCLEAN0513/result_0613_1/2024-06-13__22-48-26/checkpoints/best_position_model.pth

Fold 0 test
-------------------------------

===================Evaluate protein results========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.4  0.8         0.3            0.3             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.3        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.698336
Nucleus_export  0.553137
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.909498  0.331856  0.090502
Nucleus_export  0.829038  0.507299  0.170962
===========================================

 cs acc: 

                      0
ER             0.866667
Peroxisome     0.076923
Mitochondrion  0.018750
SIGNAL         0.864823
chloroplast    0.447368
Thylakoid      0.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.989617                 0.907273           0.877409   
ER                   0.903718                 0.632356           0.755547   
Peroxisome           0.881973                 0.075974           0.147202   
Mitochondrion        0.910696                 0.903928           0.890186   
Nucleus_export       0.965792                 0.469827           0.477846   
SIGNAL               0.986471                 0.992212           0.922329   
chloroplast          0.983596                 0.947608           0.891939   
Thylakoid            0.998287                 0.748056           0.788310   

                recall_score  precision_score  f1_score  
Nucleus             0.906250         0.878788  0.892308  
ER                  0.800000         0.727273  0.761905  
Peroxisome          0.384615         0.074627  0.125000  
Mitochondrion       0.837500         0.978102  0.902357  
Nucleus_export      0.480000         0.500000  0.489796  
SIGNAL              0.975422         0.965046  0.970206  
chloroplast         0.881579         0.917808  0.899329  
Thylakoid           1.000000         0.625000  0.769231  
===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.4  0.8         0.3            0.3             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.3        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.612162
Nucleus_export  0.426875
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.828854  0.358216  0.171146
Nucleus_export  0.699608  0.521908  0.300392
===========================================

 cs acc: 

                      0
ER             0.965517
Peroxisome     0.230769
Mitochondrion  0.018868
SIGNAL         0.881620
chloroplast    0.356164
Thylakoid      0.111111
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.981573                 0.878182           0.846908   
ER                   0.998759                 0.950612           0.806167   
Peroxisome           0.787651                 0.171847           0.081734   
Mitochondrion        0.921944                 0.920523           0.916922   
Nucleus_export       0.948450                 0.274904           0.268831   
SIGNAL               0.991033                 0.994360           0.928488   
chloroplast          0.989420                 0.953496           0.896996   
Thylakoid            0.991730                 0.364280           0.561119   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.816176  0.863813  
ER                  0.689655         0.952381  0.800000  
Peroxisome          0.230769         0.048387  0.080000  
Mitochondrion       0.867925         0.992806  0.926174  
Nucleus_export      0.280000         0.291667  0.285714  
SIGNAL              0.981308         0.963303  0.972222  
chloroplast         0.904110         0.904110  0.904110  
Thylakoid           0.777778         0.411765  0.538462  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.4  0.8         0.3            0.3             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.3        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.597689
Nucleus_export  0.129670
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         0.812325  0.353664  0.105031
Nucleus_export  0.240000  0.239172  0.040000
===========================================

 cs acc: 

                      0
ER             0.950000
Peroxisome     1.000000
Mitochondrion  0.007246
SIGNAL         0.890476
chloroplast    0.393939
Thylakoid      0.000000
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus              0.981573                 0.878182           0.846908   
ER                   0.998759                 0.950612           0.806167   
Peroxisome           0.787651                 0.171847           0.081734   
Mitochondrion        0.921944                 0.920523           0.916922   
Nucleus_export       0.948450                 0.274904           0.268831   
SIGNAL               0.991033                 0.994360           0.928488   
chloroplast          0.989420                 0.953496           0.896996   
Thylakoid            0.991730                 0.364280           0.561119   

                recall_score  precision_score  f1_score  
Nucleus             0.917355         0.816176  0.863813  
ER                  0.689655         0.952381  0.800000  
Peroxisome          0.230769         0.048387  0.080000  
Mitochondrion       0.867925         0.992806  0.926174  
Nucleus_export      0.280000         0.291667  0.285714  
SIGNAL              0.981308         0.963303  0.972222  
chloroplast         0.904110         0.904110  0.904110  
Thylakoid           0.777778         0.411765  0.538462  




Comparable Test Data
-------------------------------

===================Test protein results constrain: False========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.4  0.8         0.3            0.3             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.3        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                      0
Nucleus         0.69009
Nucleus_export  0.41653
===========================================

 TPR, FPR, FNR: 

                       0         1         2
Nucleus         1.000000  0.449455  0.000000
Nucleus_export  0.733333  0.774092  0.266667
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   1.0                      1.0                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
===================Test protein results constrain: True========================

 optimized cutoffs: 

             Nucleus   ER  Peroxisome  Mitochondrion  Nucleus_export  SIGNAL  \
cutoffs_pro      0.4  0.8         0.3            0.3             0.9     0.2   
cutoffs_aa       0.1  0.1         0.1            0.1             0.1     0.1   

             chloroplast  Thylakoid  
cutoffs_pro          0.3        0.7  
cutoffs_aa           0.1        0.1  
===========================================

 Jaccard Index (protein): 

                       0
Nucleus         0.690090
Nucleus_export  0.214728
===========================================

 TPR, FPR, FNR: 

                  0         1    2
Nucleus         1.0  0.449455  0.0
Nucleus_export  0.4  0.518415  0.2
===========================================

 cs acc: 

                0
ER            NaN
Peroxisome    NaN
Mitochondrion NaN
SIGNAL        NaN
chloroplast   NaN
Thylakoid     NaN
===========================================

 Class prediction performance: 

                roc_auc_score  average_precision_score  matthews_corrcoef  \
Nucleus                   1.0                      1.0                0.0   
ER                        NaN                     -0.0                0.0   
Peroxisome                NaN                     -0.0                0.0   
Mitochondrion             NaN                     -0.0                0.0   
Nucleus_export            NaN                      1.0                0.0   
SIGNAL                    NaN                     -0.0                0.0   
chloroplast               NaN                     -0.0                0.0   
Thylakoid                 NaN                     -0.0                0.0   

                recall_score  precision_score  f1_score  
Nucleus                  1.0              0.4  0.571429  
ER                       0.0              0.0  0.000000  
Peroxisome               0.0              0.0  0.000000  
Mitochondrion            0.0              0.0  0.000000  
Nucleus_export           0.6              1.0  0.750000  
SIGNAL                   0.0              0.0  0.000000  
chloroplast              0.0              0.0  0.000000  
Thylakoid                0.0              0.0  0.000000  
