use k-fold index: 0

Done Loading data

number of steps for training data: 197

number of steps for valid data: 67

number of steps for test data: 67

Done initialize tokenizer

trainable params: 39950470 || all params: 652949531 || trainable%: 6.118462163349038

Done initialize model

preparing optimizer is done

number of train steps per epoch: 197

Start training...

Fold 0 Epoch 1 train...
-------------------------------

0 loss: 0.803786  [   16/ 3165]

0 class loss: 0.053017 position_loss:0.750769

30 loss: 0.743841  [  496/ 3165]

30 class loss: 0.036284 position_loss:0.707557

60 loss: 0.710337  [  976/ 3165]

60 class loss: 0.064366 position_loss:0.645970

90 loss: 0.571844  [ 1456/ 3165]

90 class loss: 0.061360 position_loss:0.510485

120 loss: 0.417908  [ 1936/ 3165]

120 class loss: 0.022560 position_loss:0.395348

150 loss: 0.372002  [ 2416/ 3165]

150 class loss: 0.039195 position_loss:0.332807

180 loss: 0.286061  [ 2896/ 3165]

180 class loss: 0.019087 position_loss:0.266974

Epoch 1: train loss: 0.542678

Fold 0 Epoch 1 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 1: valid loss:0.220880

Epoch 1: valid_class_loss:0.035098	valid_position_loss:0.185782

Epoch 1: valid loss 0.22087963194032695 smaller than best loss inf
-------------------------------

Epoch 1: A better checkpoint is saved into /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 2 train...
-------------------------------

197 loss: 0.252973  [   16/ 3165]

197 class loss: 0.033449 position_loss:0.219524

227 loss: 0.167942  [  496/ 3165]

227 class loss: 0.031043 position_loss:0.136898

257 loss: 0.147280  [  976/ 3165]

257 class loss: 0.044132 position_loss:0.103148

287 loss: 0.081992  [ 1456/ 3165]

287 class loss: 0.010015 position_loss:0.071977

317 loss: 0.091195  [ 1936/ 3165]

317 class loss: 0.009279 position_loss:0.081916

347 loss: 0.111446  [ 2416/ 3165]

347 class loss: 0.051181 position_loss:0.060265

377 loss: 0.114811  [ 2896/ 3165]

377 class loss: 0.076911 position_loss:0.037901

Epoch 2: train loss: 0.124055

Fold 0 Epoch 2 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 2: valid loss:0.090943

Epoch 2: valid_class_loss:0.027569	valid_position_loss:0.063374

Epoch 2: valid loss 0.09094300344470028 smaller than best loss 0.22087963194032695
-------------------------------

Epoch 2: A better checkpoint is saved into /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 3 train...
-------------------------------

394 loss: 0.097312  [   16/ 3165]

394 class loss: 0.012138 position_loss:0.085173

424 loss: 0.078516  [  496/ 3165]

424 class loss: 0.047107 position_loss:0.031409

454 loss: 0.104997  [  976/ 3165]

454 class loss: 0.055802 position_loss:0.049195

484 loss: 0.056581  [ 1456/ 3165]

484 class loss: 0.030174 position_loss:0.026407

514 loss: 0.040600  [ 1936/ 3165]

514 class loss: 0.007600 position_loss:0.033000

544 loss: 0.048825  [ 2416/ 3165]

544 class loss: 0.006623 position_loss:0.042202

574 loss: 0.034024  [ 2896/ 3165]

574 class loss: 0.007814 position_loss:0.026209

Epoch 3: train loss: 0.062130

Fold 0 Epoch 3 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 3: valid loss:0.049519

Epoch 3: valid_class_loss:0.020040	valid_position_loss:0.029478

Epoch 3: valid loss 0.049518541638472885 smaller than best loss 0.09094300344470028
-------------------------------

Epoch 3: A better checkpoint is saved into /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 4 train...
-------------------------------

591 loss: 0.082538  [   16/ 3165]

591 class loss: 0.034596 position_loss:0.047942

621 loss: 0.045795  [  496/ 3165]

621 class loss: 0.021025 position_loss:0.024770

651 loss: 0.020762  [  976/ 3165]

651 class loss: 0.006438 position_loss:0.014324

681 loss: 0.045301  [ 1456/ 3165]

681 class loss: 0.029791 position_loss:0.015510

711 loss: 0.037316  [ 1936/ 3165]

711 class loss: 0.010824 position_loss:0.026492

741 loss: 0.024154  [ 2416/ 3165]

741 class loss: 0.008988 position_loss:0.015166

771 loss: 0.024647  [ 2896/ 3165]

771 class loss: 0.006758 position_loss:0.017889

Epoch 4: train loss: 0.037620

Fold 0 Epoch 4 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 4: valid loss:0.038247

Epoch 4: valid_class_loss:0.016221	valid_position_loss:0.022026

Epoch 4: valid loss 0.03824737272477662 smaller than best loss 0.049518541638472885
-------------------------------

Epoch 4: A better checkpoint is saved into /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 5 train...
-------------------------------

788 loss: 0.019034  [   16/ 3165]

788 class loss: 0.004548 position_loss:0.014486

818 loss: 0.037108  [  496/ 3165]

818 class loss: 0.010619 position_loss:0.026489

848 loss: 0.090275  [  976/ 3165]

848 class loss: 0.071166 position_loss:0.019109

878 loss: 0.017175  [ 1456/ 3165]

878 class loss: 0.005024 position_loss:0.012151

908 loss: 0.014938  [ 1936/ 3165]

908 class loss: 0.006772 position_loss:0.008166

938 loss: 0.021653  [ 2416/ 3165]

938 class loss: 0.013921 position_loss:0.007731

968 loss: 0.019431  [ 2896/ 3165]

968 class loss: 0.008133 position_loss:0.011298

Epoch 5: train loss: 0.025040

Fold 0 Epoch 5 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 5: valid loss:0.031559

Epoch 5: valid_class_loss:0.014575	valid_position_loss:0.016984

Epoch 5: valid loss 0.03155894824864188 smaller than best loss 0.03824737272477662
-------------------------------

Epoch 5: A better checkpoint is saved into /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth 
-------------------------------

Fold 0 Epoch 6 train...
-------------------------------

985 loss: 0.021283  [   16/ 3165]

985 class loss: 0.010064 position_loss:0.011218

1015 loss: 0.019389  [  496/ 3165]

1015 class loss: 0.003478 position_loss:0.015910

1045 loss: 0.017905  [  976/ 3165]

1045 class loss: 0.007203 position_loss:0.010702

1075 loss: 0.016949  [ 1456/ 3165]

1075 class loss: 0.003064 position_loss:0.013884

1105 loss: 0.010167  [ 1936/ 3165]

1105 class loss: 0.003292 position_loss:0.006874

1135 loss: 0.019027  [ 2416/ 3165]

1135 class loss: 0.012994 position_loss:0.006032

1165 loss: 0.014098  [ 2896/ 3165]

1165 class loss: 0.006260 position_loss:0.007838

Epoch 6: train loss: 0.016187

Fold 0 Epoch 6 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 6: valid loss:0.038169

Epoch 6: valid_class_loss:0.015634	valid_position_loss:0.022535

Fold 0 Epoch 7 train...
-------------------------------

1182 loss: 0.017808  [   16/ 3165]

1182 class loss: 0.008282 position_loss:0.009526

1212 loss: 0.015797  [  496/ 3165]

1212 class loss: 0.007487 position_loss:0.008310

1242 loss: 0.007864  [  976/ 3165]

1242 class loss: 0.003661 position_loss:0.004203

1272 loss: 0.008138  [ 1456/ 3165]

1272 class loss: 0.005584 position_loss:0.002554

1302 loss: 0.010339  [ 1936/ 3165]

1302 class loss: 0.005201 position_loss:0.005137

1332 loss: 0.004698  [ 2416/ 3165]

1332 class loss: 0.001787 position_loss:0.002911

1362 loss: 0.004061  [ 2896/ 3165]

1362 class loss: 0.001286 position_loss:0.002776

Epoch 7: train loss: 0.011066

Fold 0 Epoch 7 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 7: valid loss:0.036111

Epoch 7: valid_class_loss:0.014319	valid_position_loss:0.021792

Fold 0 Epoch 8 train...
-------------------------------

1379 loss: 0.005000  [   16/ 3165]

1379 class loss: 0.001554 position_loss:0.003446

1409 loss: 0.006148  [  496/ 3165]

1409 class loss: 0.003757 position_loss:0.002392

1439 loss: 0.011208  [  976/ 3165]

1439 class loss: 0.005737 position_loss:0.005471

1469 loss: 0.006615  [ 1456/ 3165]

1469 class loss: 0.002708 position_loss:0.003907

1499 loss: 0.009064  [ 1936/ 3165]

1499 class loss: 0.004542 position_loss:0.004523

1529 loss: 0.005422  [ 2416/ 3165]

1529 class loss: 0.002466 position_loss:0.002956

1559 loss: 0.003409  [ 2896/ 3165]

1559 class loss: 0.001097 position_loss:0.002312

Epoch 8: train loss: 0.007866

Fold 0 Epoch 8 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 8: valid loss:0.042087

Epoch 8: valid_class_loss:0.015606	valid_position_loss:0.026481

Fold 0 Epoch 9 train...
-------------------------------

1576 loss: 0.004542  [   16/ 3165]

1576 class loss: 0.001460 position_loss:0.003082

1606 loss: 0.012592  [  496/ 3165]

1606 class loss: 0.006627 position_loss:0.005965

1636 loss: 0.004730  [  976/ 3165]

1636 class loss: 0.001764 position_loss:0.002967

1666 loss: 0.002724  [ 1456/ 3165]

1666 class loss: 0.000667 position_loss:0.002056

1696 loss: 0.006676  [ 1936/ 3165]

1696 class loss: 0.002021 position_loss:0.004655

1726 loss: 0.006939  [ 2416/ 3165]

1726 class loss: 0.003680 position_loss:0.003260

1756 loss: 0.005109  [ 2896/ 3165]

1756 class loss: 0.001092 position_loss:0.004017

Epoch 9: train loss: 0.005975

Fold 0 Epoch 9 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 9: valid loss:0.050708

Epoch 9: valid_class_loss:0.017419	valid_position_loss:0.033289

Fold 0 Epoch 10 train...
-------------------------------

1773 loss: 0.003817  [   16/ 3165]

1773 class loss: 0.001085 position_loss:0.002732

1803 loss: 0.005369  [  496/ 3165]

1803 class loss: 0.001402 position_loss:0.003967

1833 loss: 0.003216  [  976/ 3165]

1833 class loss: 0.001060 position_loss:0.002156

1863 loss: 0.004307  [ 1456/ 3165]

1863 class loss: 0.001196 position_loss:0.003111

1893 loss: 0.003116  [ 1936/ 3165]

1893 class loss: 0.001062 position_loss:0.002054

1923 loss: 0.003745  [ 2416/ 3165]

1923 class loss: 0.000907 position_loss:0.002838

1953 loss: 0.007716  [ 2896/ 3165]

1953 class loss: 0.004861 position_loss:0.002855

Epoch 10: train loss: 0.005009

Fold 0 Epoch 10 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 10: valid loss:0.047383

Epoch 10: valid_class_loss:0.016703	valid_position_loss:0.030680

Fold 0 Epoch 11 train...
-------------------------------

1970 loss: 0.003060  [   16/ 3165]

1970 class loss: 0.001508 position_loss:0.001552

2000 loss: 0.004868  [  496/ 3165]

2000 class loss: 0.000634 position_loss:0.004234

2030 loss: 0.005864  [  976/ 3165]

2030 class loss: 0.002591 position_loss:0.003273

2060 loss: 0.003677  [ 1456/ 3165]

2060 class loss: 0.002200 position_loss:0.001477

2090 loss: 0.002591  [ 1936/ 3165]

2090 class loss: 0.000796 position_loss:0.001795

2120 loss: 0.001330  [ 2416/ 3165]

2120 class loss: 0.000322 position_loss:0.001009

2150 loss: 0.003014  [ 2896/ 3165]

2150 class loss: 0.001188 position_loss:0.001826

Epoch 11: train loss: 0.004166

Fold 0 Epoch 11 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 11: valid loss:0.053898

Epoch 11: valid_class_loss:0.018226	valid_position_loss:0.035673

Fold 0 Epoch 12 train...
-------------------------------

2167 loss: 0.002944  [   16/ 3165]

2167 class loss: 0.002087 position_loss:0.000857

2197 loss: 0.001315  [  496/ 3165]

2197 class loss: 0.000453 position_loss:0.000863

2227 loss: 0.003887  [  976/ 3165]

2227 class loss: 0.001125 position_loss:0.002762

2257 loss: 0.002221  [ 1456/ 3165]

2257 class loss: 0.000621 position_loss:0.001600

2287 loss: 0.003041  [ 1936/ 3165]

2287 class loss: 0.001616 position_loss:0.001424

2317 loss: 0.003151  [ 2416/ 3165]

2317 class loss: 0.001644 position_loss:0.001506

2347 loss: 0.002257  [ 2896/ 3165]

2347 class loss: 0.001131 position_loss:0.001126

Epoch 12: train loss: 0.003586

Fold 0 Epoch 12 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 12: valid loss:0.056964

Epoch 12: valid_class_loss:0.018929	valid_position_loss:0.038035

Fold 0 Epoch 13 train...
-------------------------------

2364 loss: 0.003063  [   16/ 3165]

2364 class loss: 0.001764 position_loss:0.001299

2394 loss: 0.003284  [  496/ 3165]

2394 class loss: 0.002181 position_loss:0.001103

2424 loss: 0.004064  [  976/ 3165]

2424 class loss: 0.000899 position_loss:0.003166

2454 loss: 0.001562  [ 1456/ 3165]

2454 class loss: 0.000559 position_loss:0.001002

2484 loss: 0.002737  [ 1936/ 3165]

2484 class loss: 0.001425 position_loss:0.001312

2514 loss: 0.002265  [ 2416/ 3165]

2514 class loss: 0.000760 position_loss:0.001506

2544 loss: 0.006593  [ 2896/ 3165]

2544 class loss: 0.001565 position_loss:0.005028

Epoch 13: train loss: 0.003196

Fold 0 Epoch 13 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 13: valid loss:0.060508

Epoch 13: valid_class_loss:0.019702	valid_position_loss:0.040806

Fold 0 Epoch 14 train...
-------------------------------

2561 loss: 0.001751  [   16/ 3165]

2561 class loss: 0.000671 position_loss:0.001079

2591 loss: 0.002105  [  496/ 3165]

2591 class loss: 0.000876 position_loss:0.001229

2621 loss: 0.002678  [  976/ 3165]

2621 class loss: 0.001050 position_loss:0.001628

2651 loss: 0.001937  [ 1456/ 3165]

2651 class loss: 0.000386 position_loss:0.001550

2681 loss: 0.001360  [ 1936/ 3165]

2681 class loss: 0.000431 position_loss:0.000929

2711 loss: 0.007677  [ 2416/ 3165]

2711 class loss: 0.004601 position_loss:0.003076

2741 loss: 0.005733  [ 2896/ 3165]

2741 class loss: 0.003005 position_loss:0.002728

Epoch 14: train loss: 0.003039

Fold 0 Epoch 14 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 14: valid loss:0.060902

Epoch 14: valid_class_loss:0.019306	valid_position_loss:0.041596

Fold 0 Epoch 15 train...
-------------------------------

2758 loss: 0.003520  [   16/ 3165]

2758 class loss: 0.001330 position_loss:0.002190

2788 loss: 0.001563  [  496/ 3165]

2788 class loss: 0.000238 position_loss:0.001324

2818 loss: 0.000982  [  976/ 3165]

2818 class loss: 0.000322 position_loss:0.000660

2848 loss: 0.002211  [ 1456/ 3165]

2848 class loss: 0.000423 position_loss:0.001788

2878 loss: 0.000815  [ 1936/ 3165]

2878 class loss: 0.000218 position_loss:0.000597

2908 loss: 0.003439  [ 2416/ 3165]

2908 class loss: 0.002857 position_loss:0.000582

2938 loss: 0.004097  [ 2896/ 3165]

2938 class loss: 0.001994 position_loss:0.002104

Epoch 15: train loss: 0.002450

Fold 0 Epoch 15 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 15: valid loss:0.064312

Epoch 15: valid_class_loss:0.020119	valid_position_loss:0.044193

Fold 0 Epoch 16 train...
-------------------------------

2955 loss: 0.003148  [   16/ 3165]

2955 class loss: 0.001390 position_loss:0.001758

2985 loss: 0.000926  [  496/ 3165]

2985 class loss: 0.000410 position_loss:0.000517

3015 loss: 0.002709  [  976/ 3165]

3015 class loss: 0.001510 position_loss:0.001198

3045 loss: 0.001214  [ 1456/ 3165]

3045 class loss: 0.000362 position_loss:0.000852

3075 loss: 0.002036  [ 1936/ 3165]

3075 class loss: 0.000836 position_loss:0.001199

3105 loss: 0.002190  [ 2416/ 3165]

3105 class loss: 0.001152 position_loss:0.001038

3135 loss: 0.001233  [ 2896/ 3165]

3135 class loss: 0.000368 position_loss:0.000865

Epoch 16: train loss: 0.002264

Fold 0 Epoch 16 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 16: valid loss:0.061415

Epoch 16: valid_class_loss:0.019838	valid_position_loss:0.041578

Fold 0 Epoch 17 train...
-------------------------------

3152 loss: 0.001079  [   16/ 3165]

3152 class loss: 0.000354 position_loss:0.000725

3182 loss: 0.002728  [  496/ 3165]

3182 class loss: 0.002004 position_loss:0.000724

3212 loss: 0.001403  [  976/ 3165]

3212 class loss: 0.000435 position_loss:0.000968

3242 loss: 0.005586  [ 1456/ 3165]

3242 class loss: 0.003293 position_loss:0.002292

3272 loss: 0.002321  [ 1936/ 3165]

3272 class loss: 0.001707 position_loss:0.000613

3302 loss: 0.004013  [ 2416/ 3165]

3302 class loss: 0.001371 position_loss:0.002642

3332 loss: 0.001521  [ 2896/ 3165]

3332 class loss: 0.000676 position_loss:0.000845

Epoch 17: train loss: 0.001904

Fold 0 Epoch 17 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 17: valid loss:0.067347

Epoch 17: valid_class_loss:0.021201	valid_position_loss:0.046146

Fold 0 Epoch 18 train...
-------------------------------

3349 loss: 0.002466  [   16/ 3165]

3349 class loss: 0.000553 position_loss:0.001913

3379 loss: 0.001964  [  496/ 3165]

3379 class loss: 0.001130 position_loss:0.000834

3409 loss: 0.003482  [  976/ 3165]

3409 class loss: 0.002603 position_loss:0.000879

3439 loss: 0.001737  [ 1456/ 3165]

3439 class loss: 0.000394 position_loss:0.001343

3469 loss: 0.001160  [ 1936/ 3165]

3469 class loss: 0.000402 position_loss:0.000758

3499 loss: 0.000931  [ 2416/ 3165]

3499 class loss: 0.000379 position_loss:0.000553

3529 loss: 0.002782  [ 2896/ 3165]

3529 class loss: 0.001097 position_loss:0.001685

Epoch 18: train loss: 0.001653

Fold 0 Epoch 18 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 18: valid loss:0.069304

Epoch 18: valid_class_loss:0.021701	valid_position_loss:0.047603

Fold 0 Epoch 19 train...
-------------------------------

3546 loss: 0.001142  [   16/ 3165]

3546 class loss: 0.000453 position_loss:0.000689

3576 loss: 0.002031  [  496/ 3165]

3576 class loss: 0.001045 position_loss:0.000986

3606 loss: 0.001180  [  976/ 3165]

3606 class loss: 0.000382 position_loss:0.000798

3636 loss: 0.000795  [ 1456/ 3165]

3636 class loss: 0.000258 position_loss:0.000537

3666 loss: 0.001218  [ 1936/ 3165]

3666 class loss: 0.000296 position_loss:0.000923

3696 loss: 0.001261  [ 2416/ 3165]

3696 class loss: 0.000734 position_loss:0.000527

3726 loss: 0.001209  [ 2896/ 3165]

3726 class loss: 0.000621 position_loss:0.000588

Epoch 19: train loss: 0.001512

Fold 0 Epoch 19 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 19: valid loss:0.075165

Epoch 19: valid_class_loss:0.022278	valid_position_loss:0.052887

Fold 0 Epoch 20 train...
-------------------------------

3743 loss: 0.001335  [   16/ 3165]

3743 class loss: 0.000913 position_loss:0.000422

3773 loss: 0.000881  [  496/ 3165]

3773 class loss: 0.000439 position_loss:0.000442

3803 loss: 0.000610  [  976/ 3165]

3803 class loss: 0.000156 position_loss:0.000454

3833 loss: 0.001080  [ 1456/ 3165]

3833 class loss: 0.000489 position_loss:0.000591

3863 loss: 0.000999  [ 1936/ 3165]

3863 class loss: 0.000564 position_loss:0.000435

3893 loss: 0.000662  [ 2416/ 3165]

3893 class loss: 0.000195 position_loss:0.000467

3923 loss: 0.000865  [ 2896/ 3165]

3923 class loss: 0.000410 position_loss:0.000455

Epoch 20: train loss: 0.001309

Fold 0 Epoch 20 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 20: valid loss:0.081960

Epoch 20: valid_class_loss:0.023266	valid_position_loss:0.058694

Fold 0 Epoch 21 train...
-------------------------------

3940 loss: 0.000941  [   16/ 3165]

3940 class loss: 0.000414 position_loss:0.000527

3970 loss: 0.000747  [  496/ 3165]

3970 class loss: 0.000218 position_loss:0.000529

4000 loss: 0.000625  [  976/ 3165]

4000 class loss: 0.000188 position_loss:0.000437

4030 loss: 0.001011  [ 1456/ 3165]

4030 class loss: 0.000665 position_loss:0.000346

4060 loss: 0.000650  [ 1936/ 3165]

4060 class loss: 0.000129 position_loss:0.000521

4090 loss: 0.001114  [ 2416/ 3165]

4090 class loss: 0.000700 position_loss:0.000414

4120 loss: 0.000769  [ 2896/ 3165]

4120 class loss: 0.000294 position_loss:0.000475

Epoch 21: train loss: 0.001190

Fold 0 Epoch 21 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 21: valid loss:0.083376

Epoch 21: valid_class_loss:0.024231	valid_position_loss:0.059144

Fold 0 Epoch 22 train...
-------------------------------

4137 loss: 0.002363  [   16/ 3165]

4137 class loss: 0.001650 position_loss:0.000713

4167 loss: 0.001163  [  496/ 3165]

4167 class loss: 0.000252 position_loss:0.000911

4197 loss: 0.000941  [  976/ 3165]

4197 class loss: 0.000320 position_loss:0.000621

4227 loss: 0.001630  [ 1456/ 3165]

4227 class loss: 0.001027 position_loss:0.000603

4257 loss: 0.001635  [ 1936/ 3165]

4257 class loss: 0.000919 position_loss:0.000716

4287 loss: 0.002882  [ 2416/ 3165]

4287 class loss: 0.000917 position_loss:0.001965

4317 loss: 0.001340  [ 2896/ 3165]

4317 class loss: 0.000739 position_loss:0.000601

Epoch 22: train loss: 0.001090

Fold 0 Epoch 22 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 22: valid loss:0.087074

Epoch 22: valid_class_loss:0.024614	valid_position_loss:0.062460

Fold 0 Epoch 23 train...
-------------------------------

4334 loss: 0.001053  [   16/ 3165]

4334 class loss: 0.000728 position_loss:0.000324

4364 loss: 0.000995  [  496/ 3165]

4364 class loss: 0.000455 position_loss:0.000540

4394 loss: 0.000856  [  976/ 3165]

4394 class loss: 0.000349 position_loss:0.000506

4424 loss: 0.000636  [ 1456/ 3165]

4424 class loss: 0.000321 position_loss:0.000316

4454 loss: 0.000745  [ 1936/ 3165]

4454 class loss: 0.000331 position_loss:0.000414

4484 loss: 0.000821  [ 2416/ 3165]

4484 class loss: 0.000333 position_loss:0.000488

4514 loss: 0.000846  [ 2896/ 3165]

4514 class loss: 0.000306 position_loss:0.000540

Epoch 23: train loss: 0.001017

Fold 0 Epoch 23 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 23: valid loss:0.088182

Epoch 23: valid_class_loss:0.025262	valid_position_loss:0.062921

Fold 0 Epoch 24 train...
-------------------------------

4531 loss: 0.000768  [   16/ 3165]

4531 class loss: 0.000284 position_loss:0.000484

4561 loss: 0.000872  [  496/ 3165]

4561 class loss: 0.000401 position_loss:0.000472

4591 loss: 0.000639  [  976/ 3165]

4591 class loss: 0.000235 position_loss:0.000403

4621 loss: 0.000656  [ 1456/ 3165]

4621 class loss: 0.000221 position_loss:0.000434

4651 loss: 0.001261  [ 1936/ 3165]

4651 class loss: 0.000837 position_loss:0.000424

4681 loss: 0.000656  [ 2416/ 3165]

4681 class loss: 0.000236 position_loss:0.000420

4711 loss: 0.000850  [ 2896/ 3165]

4711 class loss: 0.000380 position_loss:0.000471

Epoch 24: train loss: 0.000960

Fold 0 Epoch 24 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 24: valid loss:0.093842

Epoch 24: valid_class_loss:0.025733	valid_position_loss:0.068109

Fold 0 Epoch 25 train...
-------------------------------

4728 loss: 0.000544  [   16/ 3165]

4728 class loss: 0.000179 position_loss:0.000365

4758 loss: 0.000510  [  496/ 3165]

4758 class loss: 0.000129 position_loss:0.000381

4788 loss: 0.000640  [  976/ 3165]

4788 class loss: 0.000148 position_loss:0.000492

4818 loss: 0.000933  [ 1456/ 3165]

4818 class loss: 0.000401 position_loss:0.000532

4848 loss: 0.000721  [ 1936/ 3165]

4848 class loss: 0.000197 position_loss:0.000524

4878 loss: 0.000551  [ 2416/ 3165]

4878 class loss: 0.000191 position_loss:0.000360

4908 loss: 0.000403  [ 2896/ 3165]

4908 class loss: 0.000103 position_loss:0.000300

Epoch 25: train loss: 0.000914

Fold 0 Epoch 25 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 25: valid loss:0.093950

Epoch 25: valid_class_loss:0.026462	valid_position_loss:0.067489

Fold 0 Epoch 26 train...
-------------------------------

4925 loss: 0.000616  [   16/ 3165]

4925 class loss: 0.000158 position_loss:0.000459

4955 loss: 0.000685  [  496/ 3165]

4955 class loss: 0.000426 position_loss:0.000259

4985 loss: 0.000687  [  976/ 3165]

4985 class loss: 0.000163 position_loss:0.000524

5015 loss: 0.000623  [ 1456/ 3165]

5015 class loss: 0.000227 position_loss:0.000396

5045 loss: 0.000672  [ 1936/ 3165]

5045 class loss: 0.000273 position_loss:0.000400

5075 loss: 0.000985  [ 2416/ 3165]

5075 class loss: 0.000482 position_loss:0.000503

5105 loss: 0.000970  [ 2896/ 3165]

5105 class loss: 0.000569 position_loss:0.000402

Epoch 26: train loss: 0.000869

Fold 0 Epoch 26 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 26: valid loss:0.093327

Epoch 26: valid_class_loss:0.026217	valid_position_loss:0.067110

Fold 0 Epoch 27 train...
-------------------------------

5122 loss: 0.000599  [   16/ 3165]

5122 class loss: 0.000175 position_loss:0.000424

5152 loss: 0.001379  [  496/ 3165]

5152 class loss: 0.000741 position_loss:0.000638

5182 loss: 0.000885  [  976/ 3165]

5182 class loss: 0.000437 position_loss:0.000447

5212 loss: 0.000922  [ 1456/ 3165]

5212 class loss: 0.000364 position_loss:0.000557

5242 loss: 0.000500  [ 1936/ 3165]

5242 class loss: 0.000273 position_loss:0.000227

5272 loss: 0.000414  [ 2416/ 3165]

5272 class loss: 0.000151 position_loss:0.000263

5302 loss: 0.000584  [ 2896/ 3165]

5302 class loss: 0.000182 position_loss:0.000402

Epoch 27: train loss: 0.000839

Fold 0 Epoch 27 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 27: valid loss:0.097186

Epoch 27: valid_class_loss:0.026922	valid_position_loss:0.070265

Fold 0 Epoch 28 train...
-------------------------------

5319 loss: 0.001405  [   16/ 3165]

5319 class loss: 0.001041 position_loss:0.000363

5349 loss: 0.000474  [  496/ 3165]

5349 class loss: 0.000181 position_loss:0.000292

5379 loss: 0.000632  [  976/ 3165]

5379 class loss: 0.000290 position_loss:0.000342

5409 loss: 0.001087  [ 1456/ 3165]

5409 class loss: 0.000497 position_loss:0.000590

5439 loss: 0.000456  [ 1936/ 3165]

5439 class loss: 0.000181 position_loss:0.000275

5469 loss: 0.000714  [ 2416/ 3165]

5469 class loss: 0.000460 position_loss:0.000254

5499 loss: 0.000489  [ 2896/ 3165]

5499 class loss: 0.000126 position_loss:0.000363

Epoch 28: train loss: 0.000809

Fold 0 Epoch 28 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 28: valid loss:0.098608

Epoch 28: valid_class_loss:0.026889	valid_position_loss:0.071719

Fold 0 Epoch 29 train...
-------------------------------

5516 loss: 0.000490  [   16/ 3165]

5516 class loss: 0.000285 position_loss:0.000204

5546 loss: 0.000533  [  496/ 3165]

5546 class loss: 0.000232 position_loss:0.000301

5576 loss: 0.000539  [  976/ 3165]

5576 class loss: 0.000314 position_loss:0.000225

5606 loss: 0.000834  [ 1456/ 3165]

5606 class loss: 0.000175 position_loss:0.000659

5636 loss: 0.000886  [ 1936/ 3165]

5636 class loss: 0.000613 position_loss:0.000273

5666 loss: 0.000384  [ 2416/ 3165]

5666 class loss: 0.000106 position_loss:0.000278

5696 loss: 0.000697  [ 2896/ 3165]

5696 class loss: 0.000306 position_loss:0.000391

Epoch 29: train loss: 0.000784

Fold 0 Epoch 29 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 29: valid loss:0.106109

Epoch 29: valid_class_loss:0.028428	valid_position_loss:0.077680

Fold 0 Epoch 30 train...
-------------------------------

5713 loss: 0.000673  [   16/ 3165]

5713 class loss: 0.000350 position_loss:0.000323

5743 loss: 0.000982  [  496/ 3165]

5743 class loss: 0.000537 position_loss:0.000445

5773 loss: 0.000739  [  976/ 3165]

5773 class loss: 0.000335 position_loss:0.000404

5803 loss: 0.000494  [ 1456/ 3165]

5803 class loss: 0.000184 position_loss:0.000310

5833 loss: 0.000500  [ 1936/ 3165]

5833 class loss: 0.000116 position_loss:0.000383

5863 loss: 0.001177  [ 2416/ 3165]

5863 class loss: 0.000823 position_loss:0.000354

5893 loss: 0.000832  [ 2896/ 3165]

5893 class loss: 0.000469 position_loss:0.000364

Epoch 30: train loss: 0.000758

Fold 0 Epoch 30 validation...
-------------------------------

number of test steps per epoch: 67

Epoch 30: valid loss:0.101452

Epoch 30: valid_class_loss:0.027617	valid_position_loss:0.073835

Loading checkpoint from /data/duolin/MUTargetCLEAN/result_nosupcon/cnnlinear_decoder/cnn2linear_c32_k7_drop1_0.3/2024-05-08__12-18-47/checkpoints/best_model.pth

Fold 0 test
-------------------------------

number of evaluateion steps: 67

===========================================

 Jaccard Index (protein): 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.638310  0.634406  0.625073  0.614768  0.611286  0.601475   
ER              0.171993  0.034425  0.000000  0.000000  0.000000  0.000000   
Peroxisome      0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
Mitochondrion   0.837506  0.799943  0.796554  0.755033  0.669242  0.607822   
Nucleus_export  0.143092  0.134832  0.130508  0.126078  0.121360  0.111579   
SIGNAL          0.959523  0.946821  0.941196  0.934317  0.917055  0.894500   
chloroplast     0.809258  0.766059  0.631838  0.564955  0.443084  0.389321   
Thylakoid       0.777387  0.777387  0.777387  0.777387  0.777387  0.666332   

                     0.7       0.8       0.9  
Nucleus         0.574396  0.526830  0.420882  
ER              0.000000  0.000000  0.000000  
Peroxisome      0.000000  0.000000  0.000000  
Mitochondrion   0.514337  0.282662  0.000000  
Nucleus_export  0.101791  0.075429  0.060868  
SIGNAL          0.855914  0.726951  0.091895  
chloroplast     0.266685  0.054782  0.000000  
Thylakoid       0.555276  0.111083  0.000000  
===========================================

 cs acc: 

                     0.1       0.2       0.3       0.4       0.5       0.6  \
Nucleus         0.016529  0.016529  0.016529  0.016529  0.016529  0.016529   
ER              0.103448  0.103448  0.103448  0.103448  0.103448  0.103448   
Peroxisome      0.153846  0.153846  0.153846  0.153846  0.153846  0.153846   
Mitochondrion   0.276730  0.276730  0.276730  0.276730  0.276730  0.276730   
Nucleus_export  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
SIGNAL          0.886293  0.886293  0.886293  0.886293  0.886293  0.886293   
chloroplast     0.315068  0.315068  0.315068  0.315068  0.315068  0.315068   
Thylakoid       0.777778  0.777778  0.777778  0.777778  0.777778  0.777778   

                     0.7       0.8       0.9  
Nucleus         0.016529  0.016529  0.016529  
ER              0.103448  0.103448  0.103448  
Peroxisome      0.153846  0.153846  0.153846  
Mitochondrion   0.276730  0.276730  0.276730  
Nucleus_export  0.000000  0.000000  0.000000  
SIGNAL          0.886293  0.886293  0.886293  
chloroplast     0.315068  0.315068  0.315068  
Thylakoid       0.777778  0.777778  0.777778  
===========================================

 Class prediction performance (Nucleus): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.993387  0.993387  0.993387  0.993387  0.993387   
average_precision_score  0.940079  0.940079  0.940079  0.940079  0.940079   
matthews_corrcoef        0.802277  0.873932  0.881459  0.883742  0.891281   
recall_score             0.983471  0.983471  0.966942  0.958678  0.958678   
precision_score          0.695906  0.804054  0.829787  0.840580  0.852941   
f1_score                 0.815068  0.884758  0.893130  0.895753  0.902724   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.993387  0.993387  0.993387  0.993387  
average_precision_score  0.940079  0.940079  0.940079  0.940079  
matthews_corrcoef        0.902890  0.905829  0.897339  0.866108  
recall_score             0.958678  0.950413  0.909091  0.851240  
precision_score          0.872180  0.884615  0.909091  0.911504  
f1_score                 0.913386  0.916335  0.909091  0.880342  
 Class prediction performance (ER): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.936066  0.936066  0.936066  0.936066  0.936066   
average_precision_score  0.431871  0.431871  0.431871  0.431871  0.431871   
matthews_corrcoef        0.165279  0.273963  0.507207  0.371918  0.326055   
recall_score             1.000000  0.862069  0.793103  0.344828  0.137931   
precision_score          0.054004  0.115741  0.348485  0.434783  0.800000   
f1_score                 0.102473  0.204082  0.484211  0.384615  0.235294   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.936066  0.936066  0.936066  0.936066  
average_precision_score  0.431871  0.431871  0.431871  0.431871  
matthews_corrcoef        0.000000  0.000000  0.000000  0.000000  
recall_score             0.000000  0.000000  0.000000  0.000000  
precision_score          0.000000  0.000000  0.000000  0.000000  
f1_score                 0.000000  0.000000  0.000000  0.000000  
 Class prediction performance (Peroxisome): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.081712  0.081712  0.081712  0.081712  0.081712   
average_precision_score  0.007104  0.007104  0.007104  0.007104  0.007104   
matthews_corrcoef       -0.044495  0.000000  0.000000  0.000000  0.000000   
recall_score             0.000000  0.000000  0.000000  0.000000  0.000000   
precision_score          0.000000  0.000000  0.000000  0.000000  0.000000   
f1_score                 0.000000  0.000000  0.000000  0.000000  0.000000   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.081712  0.081712  0.081712  0.081712  
average_precision_score  0.007104  0.007104  0.007104  0.007104  
matthews_corrcoef        0.000000  0.000000  0.000000  0.000000  
recall_score             0.000000  0.000000  0.000000  0.000000  
precision_score          0.000000  0.000000  0.000000  0.000000  
f1_score                 0.000000  0.000000  0.000000  0.000000  
 Class prediction performance (Mitochondrion): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.966571  0.966571  0.966571  0.966571  0.966571   
average_precision_score  0.964991  0.964991  0.964991  0.964991  0.964991   
matthews_corrcoef        0.926377  0.958871  0.955092  0.947515  0.924615   
recall_score             0.943396  0.937107  0.930818  0.918239  0.880503   
precision_score          0.931677  0.993333  0.993289  0.993197  0.992908   
f1_score                 0.937500  0.964401  0.961039  0.954248  0.933333   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.966571  0.966571  0.966571  0.966571  
average_precision_score  0.964991  0.964991  0.964991  0.964991  
matthews_corrcoef        0.913064  0.882138  0.716175  0.000000  
recall_score             0.861635  0.805031  0.553459  0.000000  
precision_score          0.992754  1.000000  1.000000  0.000000  
f1_score                 0.922559  0.891986  0.712551  0.000000  
 Class prediction performance (Nucleus_export): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.943450  0.943450  0.943450  0.943450  0.943450   
average_precision_score  0.348999  0.348999  0.348999  0.348999  0.348999   
matthews_corrcoef        0.299540  0.341600  0.323242  0.344496  0.286640   
recall_score             0.600000  0.480000  0.360000  0.360000  0.240000   
precision_score          0.178571  0.272727  0.321429  0.360000  0.375000   
f1_score                 0.275229  0.347826  0.339623  0.360000  0.292683   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.943450  0.943450  0.943450  0.943450  
average_precision_score  0.348999  0.348999  0.348999  0.348999  
matthews_corrcoef        0.297144  0.335909  0.256610  0.294322  
recall_score             0.240000  0.240000  0.160000  0.160000  
precision_score          0.400000  0.500000  0.444444  0.571429  
f1_score                 0.300000  0.324324  0.235294  0.250000  
 Class prediction performance (SIGNAL): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.998547  0.998547  0.998547  0.998547  0.998547   
average_precision_score  0.999126  0.999126  0.999126  0.999126  0.999126   
matthews_corrcoef        0.945122  0.956751  0.956549  0.962292  0.968296   
recall_score             0.998442  0.998442  0.995327  0.990654  0.985981   
precision_score          0.959581  0.968278  0.971125  0.979969  0.989062   
f1_score                 0.978626  0.983129  0.983077  0.985283  0.987520   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.998547  0.998547  0.998547  0.998547  
average_precision_score  0.999126  0.999126  0.999126  0.999126  
matthews_corrcoef        0.951299  0.917700  0.782237  0.202411  
recall_score             0.967290  0.931464  0.800623  0.098131  
precision_score          0.993600  1.000000  1.000000  1.000000  
f1_score                 0.980268  0.964516  0.889273  0.178723  
 Class prediction performance (chloroplast): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.991550  0.991550  0.991550  0.991550  0.991550   
average_precision_score  0.971381  0.971381  0.971381  0.971381  0.971381   
matthews_corrcoef        0.825285  0.925255  0.929964  0.935239  0.932735   
recall_score             0.986301  0.986301  0.972603  0.958904  0.917808   
precision_score          0.712871  0.878049  0.898734  0.921053  0.957143   
f1_score                 0.827586  0.929032  0.934211  0.939597  0.937063   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.991550  0.991550  0.991550  0.991550  
average_precision_score  0.971381  0.971381  0.971381  0.971381  
matthews_corrcoef        0.885144  0.791730  0.340233  0.000000  
recall_score             0.835616  0.657534  0.123288  0.000000  
precision_score          0.953125  0.979592  1.000000  0.000000  
f1_score                 0.890511  0.786885  0.219512  0.000000  
 Class prediction performance (Thylakoid): 

                              0.1       0.2       0.3       0.4       0.5  \
roc_auc_score            0.994487  0.994487  0.994487  0.994487  0.994487   
average_precision_score  0.447885  0.447885  0.447885  0.447885  0.447885   
matthews_corrcoef        0.381136  0.621351  0.684956  0.704064  0.724824   
recall_score             1.000000  1.000000  1.000000  1.000000  1.000000   
precision_score          0.152542  0.391304  0.473684  0.500000  0.529412   
f1_score                 0.264706  0.562500  0.642857  0.666667  0.692308   

                              0.6       0.7       0.8       0.9  
roc_auc_score            0.994487  0.994487  0.994487  0.994487  
average_precision_score  0.447885  0.447885  0.447885  0.447885  
matthews_corrcoef        0.685321  0.619734  0.229520  0.000000  
recall_score             0.888889  0.777778  0.222222  0.000000  
precision_score          0.533333  0.500000  0.250000  0.000000  
f1_score                 0.666667  0.608696  0.235294  0.000000  
